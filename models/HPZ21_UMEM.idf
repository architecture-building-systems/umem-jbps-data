! ====================================================================================================
! ===
! ===     NON-HVAC PART (GEOMETRIES ETC.)
! ===
! ====================================================================================================

  Version,8.2;

! =========== BASIC SETTINGS ===========

  HeatBalanceAlgorithm,ConductionTransferFunction,200;

  GlobalGeometryRules,
    LowerLeftCorner,         !- Starting Vertex Position
    CounterClockWise,        !- Vertex Entry Direction
    Relative;                !- Coordinate System

  SurfaceConvectionAlgorithm:Inside,TARP;

  SurfaceConvectionAlgorithm:Outside,DOE-2;

! =========== SCHEDULES (GENERAL) ===========

  ScheduleTypeLimits,
    Fraction,                !- Name
    0,                       !- Lower Limit Value
    1,                       !- Upper Limit Value
    Continuous,              !- Numeric Type
    Dimensionless;           !- Unit Type

  ScheduleTypeLimits,
    Availability,            !- Name
    0,                       !- Lower Limit Value
    1,                       !- Upper Limit Value
    Discrete,                !- Numeric Type
    Dimensionless;           !- Unit Type

  ScheduleTypeLimits,
    AnyNumber,               !- Name
    ,                        !- Lower Limit Value
    ,                        !- Upper Limit Value
    ,                        !- Numeric Type
    Dimensionless;           !- Unit Type

  ScheduleTypeLimits,
    Temperature,             !- Name
    ,                        !- Lower Limit Value
    ,                        !- Upper Limit Value
    Continuous,              !- Numeric Type
    Temperature;             !- Unit Type

  Schedule:Constant,Schedule_Availability_AlwaysOn,Availability,1;

  Schedule:Constant,Schedule_Availability_AlwaysOff,Availability,0;

  Schedule:Constant,Schedule_Fraction_Always1,Fraction,1;

  Schedule:Constant,Schedule_Fraction_Always0,Fraction,0;

        ! Ground Temperatures from Meteonorm Zurich Weather File (LOCATION,Zuerich,SZ,-,MN6,3244,47.380,8.550,1,471)

  Site:GroundTemperature:BuildingSurface,6.0,4.3,3.6,4.3,6.0,8.5,10.9,12.6,13.3,12.6,10.9,8.5;

! =========== TIMESTEP & RUNPERIOD ===========

  Timestep,1;

  RunPeriod,
    RunPeriod_WholeYear,     !- Name
    1,                       !- Begin Month
    1,                       !- Begin Day of Month
    12,                      !- End Month
    31,                      !- End Day of Month
    UseWeatherFile,          !- Day of Week for Start Day
    Yes,                     !- Use Weather File Holidays and Special Days
    Yes,                     !- Use Weather File Daylight Saving Period
    No,                      !- Apply Weekend Holiday Rule
    Yes,                     !- Use Weather File Rain Indicators
    Yes;                     !- Use Weather File Snow Indicators

! =========== BUILDING, ZONES & GEOMETRIES ===========
! from file: C:\Users\admin\Desktop\EP_HPZ21\HPZ21_16_geo006.imf
! =========== BUILDING AND ZONES ===========

  Building,
    HPZ_21Zones_16,          !- Name
    27,                      !- North Axis {deg}
    Suburbs,                 !- Terrain
    0.1,                     !- Loads Convergence Tolerance Value
    0.40,                    !- Temperature Convergence Tolerance Value {deltaC}
    FullExterior,            !- Solar Distribution
    200,                     !- Maximum Number of Warmup Days
    6;                       !- Minimum Number of Warmup Days

!                                            H         V           A

  Zone,
    ZONE_D_CORE,             !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.02,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    111.83,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_CORE_M,           !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    152.52,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_SE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    48.97,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_SW,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    46.65,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_W,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    74.77,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_NW,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    39.45,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_E_NE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.79,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    74.39,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_CORE,             !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    104.04,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_SE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    21.22,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_SI,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    286.87,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_NI,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    287.30,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_NE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    20.11,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_F_E,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.11,                    !- Ceiling Height {m}
    autocalculate,           !- Volume {m3}
    120.18,                  !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_CORE,             !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    979.06,                  !- Volume {m3}
    309.8,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_SE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    119.49,                  !- Volume {m3}
    37.81,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_S,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    233.23,                  !- Volume {m3}
    73.81,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_SW,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    124.97,                  !- Volume {m3}
    39.55,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_W,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    296.04,                  !- Volume {m3}
    93.68,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_NW,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    122.69,                  !- Volume {m3}
    38.82,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_N,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    236.76,                  !- Volume {m3}
    74.92,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_NE,               !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    125.49,                  !- Volume {m3}
    39.71,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

  Zone,
    ZONE_G_E,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    3.16,                    !- Ceiling Height {m}
    300.70,                  !- Volume {m3}
    95.16,                   !- Floor Area {m2}
    ,                        !- Zone Inside Convection Algorithm
    ,                        !- Zone Outside Convection Algorithm
    Yes;                     !- Part of Total Floor Area

!                                            H      V       A

  ZoneList,
    ZoneList_AllZones,       !- Name
    Zone_D_CORE,             !- Zone 1 Name
    Zone_E_CORE_M,           !- Zone 2 Name
    Zone_E_NE,               !- Zone 3 Name
    Zone_E_NW,               !- Zone 4 Name
    Zone_E_SE,               !- Zone 5 Name
    Zone_E_SW,               !- Zone 6 Name
    Zone_E_W,                !- Zone 7 Name
    Zone_F_CORE,             !- Zone 8 Name
    Zone_F_E,                !- Zone 9 Name
    Zone_F_NE,               !- Zone 10 Name
    Zone_F_NI,               !- Zone 11 Name
    Zone_F_SE,               !- Zone 12 Name
    Zone_F_SI,               !- Zone 13 Name
    Zone_G_CORE,             !- Zone 14 Name
    Zone_G_E,                !- Zone 15 Name
    Zone_G_N,                !- Zone 16 Name
    Zone_G_NE,               !- Zone 17 Name
    Zone_G_NW,               !- Zone 18 Name
    Zone_G_S,                !- Zone 19 Name
    Zone_G_SE,               !- Zone 20 Name
    Zone_G_SW,               !- Zone 21 Name
    Zone_G_W;                !- Zone 22 Name

! =========== MATERIALS ===========

  Material,
    _DPVSE.Betonarmiert.1C{0.160},  !- Name
    MediumSmooth,            !- Roughness
    0.1600,                  !- Thickness {m}
    2.3000,                  !- Conductivity {W/m-K}
    2300.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.PolystyrolEPS.1I{0.040},  !- Name
    MediumSmooth,            !- Roughness
    0.0400,                  !- Thickness {m}
    0.04,                    !- Conductivity {W/m-K}
    15.0000,                 !- Density {kg/m3}
    1450.0000,               !- Specific Heat {J/kg-K}
    0.4000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Betonarmiert.1C{0.200},  !- Name
    MediumSmooth,            !- Roughness
    0.2000,                  !- Thickness {m}
    2.3000,                  !- Conductivity {W/m-K}
    2300.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    HPZ_CurtainWallFrame,    !- Name
    Smooth,                  !- Roughness
    0.0040,                  !- Thickness {m}
    0.4700,                  !- Conductivity {W/m-K}
    1600.0000,               !- Density {kg/m3}
    900.0000,                !- Specific Heat {J/kg-K}
    0.9000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    AirFilling,              !- Name
    VeryRough,               !- Roughness
    0.0200,                  !- Thickness {m}
    0.0240,                  !- Conductivity {W/m-K}
    1600.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2800,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Kalksandstein.1M{0.150},  !- Name
    MediumSmooth,            !- Roughness
    0.1500,                  !- Thickness {m}
    1.0000,                  !- Conductivity {W/m-K}
    1800.0000,               !- Density {kg/m3}
    900.0000,                !- Specific Heat {J/kg-K}
    0.2500,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Stahl.4 ME{0.002},!- Name
    MediumSmooth,            !- Roughness
    0.0020,                  !- Thickness {m}
    50.0000,                 !- Conductivity {W/m-K}
    7800.0000,               !- Density {kg/m3}
    470.0000,                !- Specific Heat {J/kg-K}
    0.1060,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Glaswolle.6I{0.040},  !- Name
    MediumSmooth,            !- Roughness
    0.0400,                  !- Thickness {m}
    0.0370,                  !- Conductivity {W/m-K}
    20.0000,                 !- Density {kg/m3}
    828.0000,                !- Specific Heat {J/kg-K}
    0.2300,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Aerogel{0.010},   !- Name
    VeryRough,               !- Roughness
    0.0100,                  !- Thickness {m}
    0.0131,                  !- Conductivity {W/m-K}
    150.0000,                !- Density {kg/m3}
    846.0000,                !- Specific Heat {J/kg-K}
    0.4000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.ZementEstrich.2C{0.100},  !- Name
    MediumSmooth,            !- Roughness
    0.1000,                  !- Thickness {m}
    1.4000,                  !- Conductivity {W/m-K}
    2000.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Betonarmiert.1C{0.380},  !- Name
    MediumSmooth,            !- Roughness
    0.3800,                  !- Thickness {m}
    2.3000,                  !- Conductivity {W/m-K}
    2300.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.PolystyrolEPS.1I{0.120},  !- Name
    MediumSmooth,            !- Roughness
    0.1200,                  !- Thickness {m}
    0.0380,                  !- Conductivity {W/m-K}
    15.0000,                 !- Density {kg/m3}
    1450.0000,               !- Specific Heat {J/kg-K}
    0.4000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Aussenputz.1SM{0.030},  !- Name
    MediumSmooth,            !- Roughness
    0.0300,                  !- Thickness {m}
    0.8700,                  !- Conductivity {W/m-K}
    1800.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Betonarmiert.1C{0.280},  !- Name
    MediumSmooth,            !- Roughness
    0.2800,                  !- Thickness {m}
    2.3000,                  !- Conductivity {W/m-K}
    2300.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Rundkies.1NS{0.080},  !- Name
    MediumSmooth,            !- Roughness
    0.0800,                  !- Thickness {m}
    2.0000,                  !- Conductivity {W/m-K}
    1630.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Bitumendichtungsbahn.1BF{0.005},  !- Name
    MediumSmooth,            !- Roughness
    0.0050,                  !- Thickness {m}
    0.2300,                  !- Conductivity {W/m-K}
    1100.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.PolystyrolXPS.2I{0.120},  !- Name
    MediumSmooth,            !- Roughness
    0.1200,                  !- Thickness {m}
    0.0370,                  !- Conductivity {W/m-K}
    30.0000,                 !- Density {kg/m3}
    1400.0000,               !- Specific Heat {J/kg-K}
    0.3890,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.Betonarmiert.1C{0.320},  !- Name
    MediumSmooth,            !- Roughness
    0.3200,                  !- Thickness {m}
    2.3000,                  !- Conductivity {W/m-K}
    2300.0000,               !- Density {kg/m3}
    1000.0000,               !- Specific Heat {J/kg-K}
    0.2780,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.PolystyrolEPS.1I{0.010},  !- Name
    MediumSmooth,            !- Roughness
    0.01,                    !- Thickness {m}
    0.04,                    !- Conductivity {W/m-K}
    15.0000,                 !- Density {kg/m3}
    1450.0000,               !- Specific Heat {J/kg-K}
    0.4000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

  Material,
    _DPVSE.PolystyrolEPS.1I{0.100},  !- Name
    MediumSmooth,            !- Roughness
    0.1200,                  !- Thickness {m}
    0.0380,                  !- Conductivity {W/m-K}
    15.0000,                 !- Density {kg/m3}
    1450.0000,               !- Specific Heat {J/kg-K}
    0.4000,                  !- Thermal Absorptance
    0.7000,                  !- Solar Absorptance
    0.7000;                  !- Visible Absorptance

! =========== WINDOWMATERIAL:SIMPLEGLAZINGSYSTEM ===========

  WindowMaterial:SimpleGlazingSystem,
    3ScheibenIso,            !- Name
    1.15,                    !- U-Factor {W/m2-K}
    0.60;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    HPZ_2Scheiben_Mglas,     !- Name
    1.00,                    !- U-Factor {W/m2-K}
    0.25;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    2ScheibenIso,            !- Name
    1.15,                    !- U-Factor {W/m2-K}
    0.60;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    WT_2Pane_U16-g08,        !- Name
    1.6,                     !- U-Factor {W/m2-K}
    0.80;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    WT_2PaneIso_U12-g08,     !- Name
    1.2,                     !- U-Factor {W/m2-K}
    0.80;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    WT_3PaneIso_U08-g08,     !- Name
    0.8,                     !- U-Factor {W/m2-K}
    0.80;                    !- Solar Heat Gain Coefficient

  WindowMaterial:SimpleGlazingSystem,
    WT_3PaneIso_U065-g015,   !- Name
    0.65,                    !- U-Factor {W/m2-K}
    0.15;                    !- Solar Heat Gain Coefficient

!- =========== ALL OBJECTS IN CLASS: WINDOWMATERIAL:SHADE ===========

  WindowMaterial:Shade,
    HPZshade_medium,         !- Name
    0.4,                     !- Solar Transmittance {dimensionless}
    0.5,                     !- Solar Reflectance {dimensionless}
    0.4,                     !- Visible Transmittance {dimensionless}
    0.5,                     !- Visible Reflectance {dimensionless}
    0.9,                     !- Infrared Hemispherical Emissivity {dimensionless}
    0.0,                     !- Infrared Transmittance {dimensionless}
    0.005,                   !- Thickness {m}
    0.1,                     !- Conductivity {W/m-K}
    0.05,                    !- Shade to Glass Distance {m}
    0.5,                     !- Top Opening Multiplier
    0.5,                     !- Bottom Opening Multiplier
    0.5,                     !- Left-Side Opening Multiplier
    0.5,                     !- Right-Side Opening Multiplier
    0.0;                     !- Airflow Permeability {dimensionless}

!- =========== ALL OBJECTS IN CLASS: WINDOWMATERIAL:BLIND ===========

  WindowMaterial:Blind,
    HPZ_Blindsmaterial,      !- Name
    Horizontal,              !- Slat Orientation
    0.25,                    !- Slat Width {m}
    0.25,                    !- Slat Separation {m}
    0.005,                   !- Slat Thickness {m}
    75,                      !- Slat Angle {deg}
    0.9,                     !- Slat Conductivity {W/m-K}
    0.0,                     !- Slat Beam Solar Transmittance
    0.5,                     !- Front Side Slat Beam Solar Reflectance
    0.5,                     !- Back Side Slat Beam Solar Reflectance
    0.0,                     !- Slat Diffuse Solar Transmittance
    0.5,                     !- Front Side Slat Diffuse Solar Reflectance
    0.5,                     !- Back Side Slat Diffuse Solar Reflectance
    0.0,                     !- Slat Beam Visible Transmittance
    0.5,                     !- Front Side Slat Beam Visible Reflectance
    0.5,                     !- Back Side Slat Beam Visible Reflectance
    0.0,                     !- Slat Diffuse Visible Transmittance
    0.5,                     !- Front Side Slat Diffuse Visible Reflectance
    0.5,                     !- Back Side Slat Diffuse Visible Reflectance
    0.0,                     !- Slat Infrared Hemispherical Transmittance
    0.9,                     !- Front Side Slat Infrared Hemispherical Emissivity
    0.9,                     !- Back Side Slat Infrared Hemispherical Emissivity
    0.5,                     !- Blind to Glass Distance {m}
    0.5,                     !- Blind Top Opening Multiplier
    0.5,                     !- Blind Bottom Opening Multiplier
    0.5,                     !- Blind Left Side Opening Multiplier
    0.5,                     !- Blind Right Side Opening Multiplier
    ,                        !- Minimum Slat Angle {deg}
    ;                        !- Maximum Slat Angle {deg}

!- =========== ALL OBJECTS IN CLASS: CONSTRUCTION ===========

  Construction,
    HPZ_WandBeton2schalig,   !- Name
    _DPVSE.Betonarmiert.1C{0.160},  !- Outside Layer
    _DPVSE.PolystyrolEPS.1I{0.040},  !- Layer 2
    _DPVSE.Betonarmiert.1C{0.200};  !- Layer 3

  Construction,
    HPZ_WandBeton2schalig_REVERSED,  !- Name
    _DPVSE.Betonarmiert.1C{0.200},  !- Outside Layer
    _DPVSE.PolystyrolEPS.1I{0.040},  !- Layer 2
    _DPVSE.Betonarmiert.1C{0.160};  !- Layer 3

  Construction,
    HPZ_Wand_innen_STB200,   !- Name
    _DPVSE.Betonarmiert.1C{0.200};  !- Outside Layer

  Construction,
    HPZ_Wand_innen_STB200_REVERSED,  !- Name
    _DPVSE.Betonarmiert.1C{0.200};  !- Outside Layer

  Construction,
    HPZ_E_CurtainWall,       !- Name
    HPZ_CurtainWallFrame,    !- Outside Layer
    AirFilling,              !- Layer 2
    HPZ_CurtainWallFrame;    !- Layer 3

  Construction,
    HPZ_E_CurtainWall_REVERSED,  !- Name
    HPZ_CurtainWallFrame,    !- Outside Layer
    AirFilling,              !- Layer 2
    HPZ_CurtainWallFrame;    !- Layer 3

  Construction,
    HPZ - Wand innen - 150mm,!- Name
    _DPVSE.Kalksandstein.1M{0.150};  !- Outside Layer

  Construction,
    HPZ - Wand innen - 150mm_REVERSED,  !- Name
    _DPVSE.Kalksandstein.1M{0.150};  !- Outside Layer

  Construction,
    HPZ_Fass_BruestungRetrofit,  !- Name
    _DPVSE.Stahl.4 ME{0.002},!- Outside Layer
    _DPVSE.Glaswolle.6I{0.040},  !- Layer 2
    _DPVSE.PolystyrolEPS.1I{0.010},  !- Layer 3
    _DPVSE.Stahl.4 ME{0.002};!- Layer 4

  Construction,
    HPZ_Fass_BruestungRetrofit_REVERSED,  !- Name
    _DPVSE.Stahl.4 ME{0.002},!- Outside Layer
    _DPVSE.PolystyrolEPS.1I{0.010},  !- Layer 2
    _DPVSE.Glaswolle.6I{0.040},  !- Layer 3
    _DPVSE.Stahl.4 ME{0.002};!- Layer 4

  Construction,
    HPZ - F - Transparent Infrared,  !- Name
    IR_Transparent_Material; !- Outside Layer

  Construction,
    HPZ - F - Transparent Infrared_REVERSED,  !- Name
    IR_Transparent_Material; !- Outside Layer

  Construction,
    HPZ_BodenZuUnbeheizt,    !- Name
    _DPVSE.ZementEstrich.2C{0.100},  !- Outside Layer
    _DPVSE.Betonarmiert.1C{0.380},  !- Layer 2
    _DPVSE.PolystyrolEPS.1I{0.100},  !- Layer 3
    _DPVSE.Aussenputz.1SM{0.030};  !- Layer 4

  Construction,
    HPZ_BodenZuUnbeheizt_REVERSED,  !- Name
    _DPVSE.Aussenputz.1SM{0.030},  !- Outside Layer
    _DPVSE.PolystyrolEPS.1I{0.100},  !- Layer 2
    _DPVSE.Betonarmiert.1C{0.380},  !- Layer 3
    _DPVSE.ZementEstrich.2C{0.100};  !- Layer 4

  Construction,
    HPZ G Floor Stairs,      !- Name
    _DPVSE.ZementEstrich.2C{0.100},  !- Outside Layer
    _DPVSE.Betonarmiert.1C{0.280};  !- Layer 2

  Construction,
    HPZ G Floor Stairs_REVERSED,  !- Name
    _DPVSE.Betonarmiert.1C{0.280},  !- Outside Layer
    _DPVSE.ZementEstrich.2C{0.100};  !- Layer 2

  Construction,
    3ScheibenIsoMetallrahmen,!- Name
    3ScheibenIso;            !- Outside Layer

  Construction,
    HPZ_Window_F_G,          !- Name
    HPZ_2Scheiben_Mglas;     !- Outside Layer

  Construction,
    2ScheibenIso,            !- Name
    2ScheibenIso;            !- Outside Layer

  Material:InfraredTransparent,
    IR_Transparent_Material; !- Name

  Material,
    Steel_White,             !- Name
    VerySmooth,              !- Roughness
    0.0015,                  !- Thickness {m}
    50.0000,                 !- Conductivity {W/m-K}
    7800.0000,               !- Density {kg/m3}
    450.0000,                !- Specific Heat {J/kg-K}
    0.9000,                  !- Thermal Absorptance
    0.4000,                  !- Solar Absorptance
    0.4000;                  !- Visible Absorptance

  Construction,
    HPZ_Roof,                !- Name
    _DPVSE.Rundkies.1NS{0.080},  !- Outside Layer
    _DPVSE.Bitumendichtungsbahn.1BF{0.005},  !- Layer 2
    _DPVSE.PolystyrolXPS.2I{0.120},  !- Layer 3
    _DPVSE.Betonarmiert.1C{0.320};  !- Layer 4

! Construction,              HPZ_Roof_Hepta,                             _DPVSE.Rundkies.1NS{0.080},     _DPVSE.Bitumendichtungsbahn.1BF{0.005}, _DPVSE.PolystyrolXPS.2I{0.120}, _DPVSE.Betonarmiert.1C{0.320}, Steel_White ;

  Construction:InternalSource,
    HPZ_Roof_HeptaIS,        !- Name
    4,                       !- Source Present After Layer Number
    4,                       !- Temperature Calculation Requested After Layer Number
    1,                       !- Dimensions for the CTF Calculation
    0.5,                     !- Tube Spacing {m}
    _DPVSE.Rundkies.1NS{0.080},  !- Outside Layer
    _DPVSE.Bitumendichtungsbahn.1BF{0.005},  !- Layer 2
    _DPVSE.PolystyrolXPS.2I{0.120},  !- Layer 3
    _DPVSE.Betonarmiert.1C{0.320},  !- Layer 4
    Steel_White;             !- Layer 5

  Construction,
    HPZ G Floor,             !- Name
    _DPVSE.Betonarmiert.1C{0.380},  !- Outside Layer
    _DPVSE.ZementEstrich.2C{0.100};  !- Layer 2

  Construction,
    HPZ G Floor_REVERSED,    !- Name
    _DPVSE.ZementEstrich.2C{0.100},  !- Outside Layer
    _DPVSE.Betonarmiert.1C{0.380};  !- Layer 2

  Construction,
    HPZ G Floor_Hepta,       !- Name
    Steel_White,             !- Outside Layer
    _DPVSE.Betonarmiert.1C{0.380},  !- Layer 2
    _DPVSE.ZementEstrich.2C{0.100};  !- Layer 3

  Construction:InternalSource,
    HPZ G Floor_HeptaIS_REVERSED,  !- Name
    2,                       !- Source Present After Layer Number
    2,                       !- Temperature Calculation Requested After Layer Number
    1,                       !- Dimensions for the CTF Calculation
    0.5,                     !- Tube Spacing {m}
    _DPVSE.ZementEstrich.2C{0.100},  !- Outside Layer
    _DPVSE.Betonarmiert.1C{0.380},  !- Layer 2
    Steel_White;             !- Layer 3

!- =========== ALL OBJECTS IN CLASS: WALL:DETAILED ===========

  Wall:Detailed,
    DpvWall:144023:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.1461,6.6779,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,6.6779,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,6.6779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    5.1461,6.6779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144168:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.1461,-3.9221,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    5.1461,6.2779,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    5.1461,6.2779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    5.1461,-3.9221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144238:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.5461,-3.9221,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    5.5461,-3.9221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,-3.9221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,-3.9221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144282:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,-3.9221,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-3.9221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,-1.5221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    15.6961,-1.5221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144621:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,4.2779,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,6.2779,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,6.2779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,4.2779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144715:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,4.2779,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,4.2779,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,4.2779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,4.2779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144789:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,-1.1221,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-1.1221,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,-1.1221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-1.1221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:148583,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,6.5779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,6.5779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,13.8779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,13.8779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152823,          !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:152823_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,6.5779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,6.5779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    5.3611,6.5779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    5.3611,6.5779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152823_REVERSED, !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:152823,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.3611,6.5779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.3611,6.5779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,6.5779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.6961,6.5779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245456.1,        !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,13.8779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,13.8779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,13.8779,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,13.8779,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152827,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,6.3779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,6.3779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,4.2779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,4.2779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152828,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,4.2779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,4.2779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,4.2779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,4.2779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152829,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,-1.1221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,-1.1221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,-1.1221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.6961,-1.1221,7.1200;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154069,          !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154069_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.5961,6.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,6.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.2461,6.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.2461,6.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154069_REVERSED, !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154069,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2461,6.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.2461,6.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,6.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5961,6.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154072.0,        !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154072.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.4961,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,-3.7221,11.0196,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,1.3779,11.0196,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154072.0_REVERSED,  !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154072.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.4961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,1.3779,11.0196,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,-3.7221,11.0196,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154071,          !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154071_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.4461,-3.8221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.4461,-3.8221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,-3.8221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5961,-3.8221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154071_REVERSED, !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154071,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.5961,-3.8221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,-3.8221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.4461,-3.8221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.4461,-3.8221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:206583.1,        !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    6.9861,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    14.0461,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    14.0461,-11.1221,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    6.9861,-11.1221,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:186812:Simplified:AboveGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,-1.1221,0.0000,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,3.8779,0.0000,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,3.8779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-1.1221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:186916,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,3.8779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,3.8779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,-1.1221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-1.1221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:189301,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,13.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,13.4779,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    14.0461,13.4779,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    14.0461,13.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:189687,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,-10.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-10.7221,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    14.0461,-10.7221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    14.0461,-10.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:203423,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,-10.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,-10.7221,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,-3.7221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,-3.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:219370.1,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,15.8919,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216471,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216471_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.5554,-7.5159,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.5554,-7.5159,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    1.5554,10.3541,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    1.5554,10.3541,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216471_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216471,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.5554,10.3541,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.5554,10.3541,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    1.5554,-7.5159,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    1.5554,-7.5159,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216473,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216473_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4054,10.3541,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4054,10.3541,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    19.4054,-7.5159,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    19.4054,-7.5159,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216473_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216473,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4054,-7.5159,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4054,-7.5159,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    19.4054,10.3541,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    19.4054,10.3541,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216540,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_N,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216540_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1854,10.5041,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1854,10.5041,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.1854,15.8649,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.1854,15.8649,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216540_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216540,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1854,15.8649,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1854,15.8649,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.1854,10.5041,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.1854,10.5041,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216723,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_N,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216723_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.4054,10.5041,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4054,10.5041,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.4054,15.8649,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.4054,15.8649,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216723_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216723,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.4054,15.8649,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4054,15.8649,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.4054,10.5041,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.4054,10.5041,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216833,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_S,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216833_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.6504,-7.6659,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.6504,-7.6659,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.6504,-13.1091,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.6504,-13.1091,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216833_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216833,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.6504,-13.1091,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.6504,-13.1091,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.6504,-7.6659,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.6504,-7.6659,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216901,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216901_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.2854,-7.6659,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.2854,-7.6659,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.2854,-13.1091,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.2854,-13.1091,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:216901_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_S,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:216901,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.2854,-13.1091,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.2854,-13.1091,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.2854,-7.6659,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.2854,-7.6659,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:224651.1,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,15.8919,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,15.8919,11.0967,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,15.8919,11.0967,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,15.8919,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:224902.1,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,1.3779,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,15.8919,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,15.8919,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225483.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,15.8919,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,15.8919,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225659.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225659.1.1,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.3604,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225786.1.1,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.4804,15.8919,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,15.8919,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,15.8919,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.0,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.0,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.1,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.1,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,-9.3221,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,-13.1361,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-13.1361,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.1,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,-13.1361,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,-9.3221,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230521,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230521_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4711,12.2029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.4711,12.2029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9331,12.2029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9331,12.2029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230521_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230521,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9331,12.2029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9331,12.2029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.4711,12.2029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4711,12.2029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230739,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230739_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4711,-9.3971,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.4711,-9.3971,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9331,-9.3971,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9331,-9.3971,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230739_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230739,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9331,-9.3971,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9331,-9.3971,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.4711,-9.3971,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4711,-9.3971,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:233189.1.1,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-13.1361,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.0,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,15.8919,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,15.8919,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,12.2779,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,12.2779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,12.2779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,12.2779,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,15.8919,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,15.8919,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:238439,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:238439_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.0911,8.4029,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.0911,8.4029,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    3.0911,-5.8671,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    3.0911,-5.8671,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:238439_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:238439,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.0911,-5.8671,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.0911,-5.8671,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    3.0911,8.4029,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    3.0911,8.4029,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:238850,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:238850_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    12.9211,-5.8671,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    12.9211,-5.8671,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    12.9211,-3.8221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    12.9211,-3.8221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:238850_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:238850,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    12.9211,-3.8221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    12.9211,-3.8221,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    12.9211,-5.8671,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    12.9211,-5.8671,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:239037,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:239037_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    6.9111,-6.0171,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9111,-6.0171,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    6.9111,-11.1221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    6.9111,-11.1221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:239037_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:239037,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    6.9111,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9111,-11.1221,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    6.9111,-6.0171,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    6.9111,-6.0171,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.0,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1661,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246582.1,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246582.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,7.0985,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,13.8779,7.0985,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,13.8779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246582.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246582.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,13.8779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,13.8779,7.0985,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,8.4779,7.0985,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245336.0.0,      !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,13.8779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,8.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,8.4779,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,13.8779,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246582.0.1,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246582.0.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,6.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,6.4779,7.0985,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,8.4779,7.0985,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246582.0.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246582.0.1,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,7.0985,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,6.4779,7.0985,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,6.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:247002,          !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-3.7221,7.1200,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,-1.5221,7.1200,  !- X,Y,Z ==> Vertex 3 {m}
    15.6961,-1.5221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274012,          !- Name
    HPZ - F - Transparent Infrared,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274012_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0194,1.4529,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0194,1.4529,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,1.4529,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,1.4529,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274012_REVERSED, !- Name
    HPZ - F - Transparent Infrared_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274012,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,1.4529,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,1.4529,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0194,1.4529,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0194,1.4529,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274134,          !- Name
    HPZ - F - Transparent Infrared,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274134_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -1.8694,1.3029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -1.8694,1.3029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.2461,1.3029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.2461,1.3029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274134_REVERSED, !- Name
    HPZ - F - Transparent Infrared_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274134,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2461,1.3029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.2461,1.3029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -1.8694,1.3029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -1.8694,1.3029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274261,          !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274261_REVERSED, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.5961,1.3029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,1.3029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.3211,1.3029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3211,1.3029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:274261_REVERSED, !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:274261,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3211,1.3029,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3211,1.3029,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,1.3029,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5961,1.3029,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:186812:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,-1.1221,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,3.8779,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,3.8779,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-1.1221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144789:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,-1.1221,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-1.1221,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,-1.1221,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-1.1221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144715:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.5431,4.2779,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,4.2779,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,4.2779,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,4.2779,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144621:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,4.2779,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.2961,6.2779,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    15.2961,6.2779,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,4.2779,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144282:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.6961,-1.5221,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,-3.9221,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,-3.9221,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    15.6961,-1.5221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144238:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.2961,-3.9221,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    5.5461,-3.9221,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    5.5461,-3.9221,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    15.2961,-3.9221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152825.1,        !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:152825.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    12.8461,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-3.7221,7.0736,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,-3.7221,7.0736,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:152825.1_REVERSED,  !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:152825.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.4961,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,-3.7221,7.0736,  !- X,Y,Z ==> Vertex 2 {m}
    12.8461,-3.7221,7.0736,  !- X,Y,Z ==> Vertex 3 {m}
    12.8461,-3.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144168:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.1461,-3.9221,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    5.1461,6.2779,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    5.1461,6.2779,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    5.1461,-3.9221,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245456.0,        !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    14.0806,13.8779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,13.8779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,13.8779,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    14.0806,13.8779,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154070.1,        !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154070.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.3461,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154070.1_REVERSED,  !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154070.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.3461,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:144023:Simplified:BelowGround,  !- Name
    HPZ_WandBeton2schalig,   !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.1461,6.6779,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.6961,6.6779,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    15.6961,6.6779,0.0000,  !- X,Y,Z ==> Vertex 3 {m}
    5.1461,6.6779,0.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154070.0,        !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154070.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,6.4779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154070.0_REVERSED,  !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154070.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.3461,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,6.4779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,6.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154072.1,        !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154072.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.4961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,1.3779,11.0196,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,6.4779,11.0196,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,6.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:154072.1_REVERSED,  !- Name
    HPZ_Wand_innen_STB200_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:154072.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    15.4961,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,6.4779,11.0196,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,1.3779,11.0196,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:206583.0,        !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    6.9861,-11.1221,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-11.1221,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.0,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:224651.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,15.8919,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,15.8919,11.0967,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,15.8919,11.0967,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,15.8919,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:224902.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-13.1361,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,1.3779,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:219370.0.0,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-13.1361,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225483.1.1,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-13.1361,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225659.1.0,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_S,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.7254,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-13.1361,14.3561,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225483.1.0,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_E,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:219370.0.1,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_W,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.1,    !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.1,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.0,    !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.0,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.1,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.1,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225786.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -4.0464,15.8919,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,15.8919,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,15.8919,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.1.0,  !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.1.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.1.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.1.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1104,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.0.1,  !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.0.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.3604,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.0.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.0.1,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    1.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.1.1,  !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_N,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.1.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1104,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226064.0.0.1.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226064.0.0.1.1,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,10.4291,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,10.4291,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.0.0,  !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.0.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:226362.1.1.0.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_G_S,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:226362.1.1.0.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.3604,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,14.3439,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:233220.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-13.1361,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:225786.1.0,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_G_N,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1104,15.8919,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,15.8919,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8919,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:233220.1,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-13.1361,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.0.1,    !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.0.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,1.3779,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,-9.3221,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.0.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.0.1,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,-9.3221,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,1.3779,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:233189.0,        !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,15.8919,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,12.2779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,12.2779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.0.0,    !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.0.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,12.2779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,12.2779,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,1.3779,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:230289.1.0.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:230289.1.0.0,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    19.3961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,1.3779,11.0833,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,12.2779,11.0833,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,12.2779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245336.1,        !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-11.1221,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-5.9421,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:233189.1.0,      !- Name
    HPZ_Fass_BruestungRetrofit,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    24.9601,12.2779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,12.2779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-9.3221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.1.0,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.1.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1661,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    6.9861,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    6.9861,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.1.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.1.0,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    6.9861,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245767.0,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:245767.0_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,7.0811,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.0811,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245767.0_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:245767.0,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1661,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,8.4779,7.0811,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,8.4779,7.0811,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245336.0.1,      !- Name
    HPZ_E_CurtainWall,       !- Construction Name
    ZONE_E_W,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-5.9421,7.0000,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,8.4779,7.0000;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.1.1,      !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.1.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    6.9861,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    12.8461,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    12.8461,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:246387.1.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:246387.1.1,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    12.8461,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 2 {m}
    6.9861,-5.9421,7.1391,  !- X,Y,Z ==> Vertex 3 {m}
    6.9861,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245767.1,        !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:245767.1_REVERSED,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    3.1661,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,8.4779,7.0811,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,8.4779,7.0811,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Wall:Detailed,
    DpvWall:245767.1_REVERSED,  !- Name
    HPZ - Wand innen - 150mm_REVERSED,  !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvWall:245767.1,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    autocalculate,           !- Number of Vertices
    -2.0194,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,8.4779,7.0811,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.0811,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,8.4779,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

!- =========== ALL OBJECTS IN CLASS: ROOFCEILING:DETAILED ===========

  RoofCeiling:Detailed,
    Roof G_SE Hepta,         !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    17.7254,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    21.034622192,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    21.034622192,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_SE,               !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.034622192,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    24.9331,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9331,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    21.034622192,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_S Hepta,          !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_S,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.3604,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    9.978842735,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    9.978842735,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_S,                !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_S,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    9.978842735,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    9.978842735,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_SW Hepta,         !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0194,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    -0.710178614,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    -0.710178614,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0194,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_SW,               !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.710178614,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-13.1209,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -0.710178614,-7.5909,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_W Hepta,          !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_W,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0194,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    -2.387879610,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    -2.387879610,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0194,10.4291,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_W,                !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_W,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.387879610,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -2.387879610,10.4291,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_NW Hepta,         !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0194,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    -0.655430079,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    -0.655430079,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0194,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_NW,               !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.655430079,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    -0.655430079,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_N Hepta,          !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_N,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.1104,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    9.838339806,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    9.838339806,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_N,                !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_N,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    9.838339806,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    9.838339806,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_NE Hepta,         !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    17.4804,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    20.844369888,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    20.844369888,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_NE,               !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    20.844369888,10.4291,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    24.9331,10.4291,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9331,15.8691,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    20.844369888,15.8691,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_E Hepta,          !- Name
    HPZ_Roof_HeptaIS,        !- Construction Name
    Zone_G_E,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    21.111921310,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    21.111921310,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,10.4291,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof G_E,                !- Name
    HPZ_Roof,                !- Construction Name
    Zone_G_E,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.111921310,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    24.9331,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    24.9331,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    21.111921310,10.4291,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

  RoofCeiling:Detailed,
    Roof_G_CORE,             !- Name
    HPZ_Roof,                !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.4804,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,-7.5909,14.3500,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,10.4291,14.3500,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,10.4291,14.3500;  !- X,Y,Z ==> Vertex 4 {m}

!- =========== ALL OBJECTS IN CLASS: FLOOR:DETAILED ===========

  Floor:Detailed,
    DpvFloor:141188,         !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.4961,6.4779,-0.0700,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,-3.7221,-0.0700,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,-3.7221,-0.0700,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,6.4779,-0.0700;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:243058.4.ZONE_E_SE,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    7,                       !- Number of Vertices
    6.9861,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    12.8461,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 4 {m}
    15.4961,-10.9221,3.3300,  !- X,Y,Z ==> Vertex 5 {m}
    14.0461,-10.9221,3.3300,  !- X,Y,Z ==> Vertex 6 {m}
    6.9861,-11.1221,3.3300;  !- X,Y,Z ==> Vertex 7 {m}

  Floor:Detailed,
    DpvFloor:243058.0.ZONE_E_SW,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    6.9861,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-11.1221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 4 {m}
    3.1661,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:243058.2.ZONE_E_W,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_W,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.0194,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,8.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-5.9421,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:243058.5.ZONE_E_NW,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,8.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,8.4779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,13.8779,3.3300,  !- X,Y,Z ==> Vertex 4 {m}
    5.2861,13.8779,3.3300;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:243058.3.ZONE_E_NE,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    6,                       !- Number of Vertices
    5.2861,6.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,13.8779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    14.0461,13.6779,3.3300,  !- X,Y,Z ==> Vertex 4 {m}
    15.4961,13.6779,3.3300,  !- X,Y,Z ==> Vertex 5 {m}
    15.4961,6.4779,3.3300;  !- X,Y,Z ==> Vertex 6 {m}

  Floor:Detailed,
    DpvFloor:243058.1.ZONE_E_CORE_L,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    8,                       !- Number of Vertices
    5.2861,8.4779,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,6.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    12.8461,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 4 {m}
    12.8461,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 5 {m}
    6.9861,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 6 {m}
    3.1661,-5.9421,3.3300,  !- X,Y,Z ==> Vertex 7 {m}
    3.1661,8.4779,3.3300;  !- X,Y,Z ==> Vertex 8 {m}

  Floor:Detailed,
    DpvFloor:284395,         !- Name
    HPZ G Floor Stairs,      !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:284395_CEILING, !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.2861,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,6.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,6.4779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:235057.4.ZONE_F_SE,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_F_SE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    24.9601,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:235057.1.ZONE_F_S,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    10,                      !- Number of Vertices
    15.4961,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 5 {m}
    -4.0464,-13.1361,7.5000,  !- X,Y,Z ==> Vertex 6 {m}
    -4.0464,1.3779,7.5000,  !- X,Y,Z ==> Vertex 7 {m}
    -1.9444,1.3779,7.5000,  !- X,Y,Z ==> Vertex 8 {m}
    -1.9444,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 9 {m}
    15.5961,-11.1831,7.5000;  !- X,Y,Z ==> Vertex 10 {m}

  Floor:Detailed,
    DpvFloor:213764.1.ZONE_F_S_INT.2.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.1.ZONE_F_S_INT.2.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    6,                       !- Number of Vertices
    12.5730,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    5.3461,1.3779,7.5000,  !- X,Y,Z ==> Vertex 5 {m}
    5.3461,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 6 {m}

  Floor:Detailed,
    DpvFloor:235057.2.ZONE_F_N,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    10,                      !- Number of Vertices
    -1.9444,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,15.8919,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,15.8919,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,12.2779,7.5000,  !- X,Y,Z ==> Vertex 5 {m}
    19.3961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 6 {m}
    15.4961,1.3779,7.5000,  !- X,Y,Z ==> Vertex 7 {m}
    15.5961,6.4779,7.5000,  !- X,Y,Z ==> Vertex 8 {m}
    15.5961,13.8279,7.5000,  !- X,Y,Z ==> Vertex 9 {m}
    -1.9444,13.8279,7.5000;  !- X,Y,Z ==> Vertex 10 {m}

  Floor:Detailed,
    DpvFloor:213764.0.ZONE_F_N_INT.1.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.0.ZONE_F_N_INT.1.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    5.3461,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,8.4779,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    5.3461,6.4779,7.5000;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:235057.0.ZONE_F_NE,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,12.2779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,15.8919,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,15.8919,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,12.2779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:235057.3.ZONE_F_E,  !- Name
    HPZ_BodenZuUnbeheizt,    !- Construction Name
    ZONE_F_E,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    19.3961,12.2779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,12.2779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,1.3779,7.5000;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:213764.2.ZONE_F_CORE.0.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.2.ZONE_F_CORE.0.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,6.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:222010.7.ZONE_G_SE.0.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.7.ZONE_G_SE.0.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    19.3961,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,-9.3221,11.0900;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:222010.6.ZONE_G_NE.1.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.6.ZONE_G_NE.1.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,15.8919,11.0900,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,12.2779,11.0900;  !- X,Y,Z ==> Vertex 5 {m}

  Floor:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.3.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.3.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.5479,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    15.5461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.3961,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.4.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.4.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.5461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.7.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.7.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,6.4779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    5.3138,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,6.4779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.2.0,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.2.0_CEILING,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,6.4779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,6.4779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-3.7221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

!- =========== ALL OBJECTS IN CLASS: BUILDINGSURFACE:DETAILED ===========

  BuildingSurface:Detailed,
    DpvFloor:284395_CEILING, !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor Stairs_REVERSED,  !- Construction Name
    ZONE_D_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:284395,         !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.4961,-3.7221,3.3300,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,6.4779,3.3300,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,6.4779,3.3300,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,-3.7221,3.3300;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SE.1 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SE.1 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    12.8461,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    13.636640549,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    13.636640549,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    12.8461,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SE.1,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SE.1,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    13.636640549,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    13.636640549,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SE.1 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SE.1 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    12.8461,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    13.636640549,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    13.636640549,-11.1221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SE.1,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SE.1,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    13.636640549,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    13.636640549,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    15.4961,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    15.4961,-11.1221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SE.2 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SE.2 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    6.9861,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    9.244787216,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    9.244787216,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    6.9861,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SE.2,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SE.2,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    9.244787216,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    12.8461,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    12.8461,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    9.244787216,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SE.2 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SE.2 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    6.9861,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    9.244787216,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    9.244787216,-11.1221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SE.2,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SE.2,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    9.244787216,-11.1221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    9.244787216,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    12.8461,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    12.8461,-11.1221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SW Hepta,      !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SW Hepta,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    1.404196978,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    1.404196978,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -1.9444,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_SW,            !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_SW,              !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.404196978,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    6.9861,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    6.9861,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    1.404196978,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SW Hepta,        !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SW Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -1.9444,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    1.404196978,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    1.404196978,-11.1831,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_SW,              !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_SW,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.404196978,-11.1831,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    1.404196978,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    6.9861,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    6.9861,-11.1831,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_W.1 Hepta,     !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_W.1 Hepta,       !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -0.346039295,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    -0.346039295,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -1.9444,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_W.1,           !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_W.1,             !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.346039295,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -0.346039295,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_W.1 Hepta,       !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_W.1 Hepta,     !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -1.9444,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    -0.346039295,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -0.346039295,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_W.1,             !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_W.1,           !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.346039295,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -0.346039295,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,-5.9421,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_W.2 Hepta,     !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_W.2 Hepta,       !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -0.296512365,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    -0.296512365,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -1.9444,8.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_W.2,           !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_W.2,             !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.296512365,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -0.296512365,8.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_W.2 Hepta,       !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_W.2 Hepta,     !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -1.9444,8.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    -0.296512365,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -0.296512365,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_W.2,             !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_W.2,           !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -0.296512365,1.3779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -0.296512365,8.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,1.3779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_NW Hepta,      !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_NW Hepta,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,8.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    0.242515087,8.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    0.242515087,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    -1.9444,13.8279,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_NW,            !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_NW,              !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    0.242515087,8.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    0.242515087,13.8279,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_NW Hepta,        !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_NW Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.9444,8.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    -1.9444,13.8279,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    0.242515087,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    0.242515087,8.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_NW,              !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_NW,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    0.242515087,8.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    0.242515087,13.8279,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    5.2861,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    5.2861,8.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_NE Hepta,      !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_NE Hepta,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    8.346099854,6.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    8.346099854,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,13.8279,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling E_NE,            !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor E_NE,              !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.346099854,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,6.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    8.346099854,13.8279,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_NE Hepta,        !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_NE Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,13.8279,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    8.346099854,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    8.346099854,6.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor E_NE,              !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling E_NE,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.346099854,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    8.346099854,13.8279,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,13.8279,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    15.5961,6.4779,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:213764.0.ZONE_F_N_INT.1.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.0.ZONE_F_N_INT.1.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.2861,8.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,8.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    5.3461,1.3779,7.5000;  !- X,Y,Z ==> Vertex 5 {m}

  BuildingSurface:Detailed,
    DpvFloor:213764.1.ZONE_F_S_INT.2.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.1.ZONE_F_S_INT.2.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    6,                       !- Number of Vertices
    5.3461,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,1.3779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    3.1661,1.3779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    3.1661,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 4 {m}
    12.8461,-5.9421,7.5000,  !- X,Y,Z ==> Vertex 5 {m}
    12.5730,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 6 {m}

  BuildingSurface:Detailed,
    DpvFloor:213764.2.ZONE_F_CORE.0.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:213764.2.ZONE_F_CORE.0.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.4961,-3.7221,7.5000,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,6.4779,7.5000,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,6.4779,7.5000,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,-3.7221,7.5000;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SE Hepta,      !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SE Hepta,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    21.087238312,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    21.087238312,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,-9.3221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SE,            !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SE,              !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.087238312,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    21.087238312,-9.3221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SE Hepta,        !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SE Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    21.087238312,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    21.087238312,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SE,              !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SE,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.087238312,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    21.087238312,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.1 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.1 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.3604,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    8.662281990,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    8.662281990,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.1,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.1,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.662281990,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.7254,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    8.662281990,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.1 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_S,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.1 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.3604,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    8.662281990,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    8.662281990,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.1,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_S,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.1,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.662281990,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    8.662281990,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.2 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.2 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -1.395459175,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -1.395459175,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.2,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.2,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.395459175,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.3604,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -1.395459175,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.2 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.2 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -1.395459175,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -1.395459175,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.2,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_SW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.2,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.395459175,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -1.395459175,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    3.3604,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    3.3604,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.3 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.3 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -2.407384872,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -2.407384872,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.3,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.3,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.407384872,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -2.407384872,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.3 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.3 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -2.407384872,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -2.407384872,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.3,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.3,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.407384872,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -2.407384872,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.7.ZONE_G_SE.0.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.7.ZONE_G_SE.0.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    19.3961,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.7254,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    17.7254,-13.1361,11.0900,  !- X,Y,Z ==> Vertex 4 {m}
    19.3961,-13.1361,11.0900;  !- X,Y,Z ==> Vertex 5 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.3.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.3.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5479,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.4,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.4,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.4,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.4,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,1.3779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_SI.5,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_SI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_SI.5,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    15.5461,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,-3.7221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_SI.5,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_SI.5,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    5.3461,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    5.3461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5461,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5461,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.1 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.1 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -2.422306061,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -2.422306061,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.1,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.1,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.422306061,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -2.422306061,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.1 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.1 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -2.422306061,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -2.422306061,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.1,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_W,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.1,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -2.422306061,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -2.422306061,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    1.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.2 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.2 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -1.355473042,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -1.355473042,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.2,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.2,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.355473042,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -1.355473042,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.2 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.2 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -4.0464,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    -1.355473042,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    -1.355473042,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.2,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_NW,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.2,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    -1.355473042,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    -1.355473042,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    3.1104,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.3 Hepta,    !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.3 Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.1104,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    8.492254257,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    8.492254257,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    3.1104,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.3,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.3,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.492254257,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    17.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    8.492254257,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.3 Hepta,      !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_N,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.3 Hepta,    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    3.1104,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    3.1104,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    8.492254257,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    8.492254257,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.3,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_N,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.3,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    8.492254257,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    8.492254257,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.4.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.4.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    15.5961,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    15.5461,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.7.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.7.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.4961,6.4779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    15.5961,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3138,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,6.4779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NI.4,          !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NI.4,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    5.3138,1.3779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3138,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    1.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NI.4,            !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NI.4,          !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    1.4804,1.3779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    1.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3138,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3138,1.3779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.6.ZONE_G_NE.1.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NI,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.6.ZONE_G_NE.1.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    5,                       !- Number of Vertices
    19.3961,12.2779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    17.4804,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    17.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 4 {m}
    19.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 5 {m}

  BuildingSurface:Detailed,
    Ceiling F_NE Hepta,      !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NE Hepta,        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,12.2779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    21.180824280,12.2779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    21.180824280,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.3961,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_NE,            !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_NE,              !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.180824280,12.2779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,12.2779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    21.180824280,15.8919,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NE Hepta,        !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NE Hepta,      !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.3961,12.2779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.3961,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    21.180824280,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    21.180824280,12.2779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_NE,              !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_NE,            !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    21.180824280,12.2779,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    21.180824280,15.8919,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,15.8919,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,12.2779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.1 Hepta,     !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.1 Hepta,       !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    22.969150543,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    22.969150543,12.2779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,12.2779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.1,           !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.1,             !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    22.969150543,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,12.2779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    22.969150543,12.2779,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.1 Hepta,       !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.1 Hepta,     !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,12.2779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    22.969150543,12.2779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    22.969150543,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.1,             !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_NE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.1,           !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    22.969150543,10.4291,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    22.969150543,12.2779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,12.2779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.2 Hepta,     !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.2 Hepta,       !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    20.912141800,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    20.912141800,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.2,           !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.2,             !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    20.912141800,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    20.912141800,10.4291,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.2 Hepta,       !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.2 Hepta,     !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    20.912141800,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    20.912141800,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.2,             !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.2,           !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    20.912141800,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    20.912141800,10.4291,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,10.4291,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.3 Hepta,     !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_HeptaIS_REVERSED,  !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.3 Hepta,       !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    23.206138611,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    23.206138611,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    19.4804,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    Ceiling F_E.3,           !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_E,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Floor F_E.3,             !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    23.206138611,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    23.206138611,-7.5909,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.3 Hepta,       !- Name
    HPZ G Floor_Hepta,       !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.3 Hepta,     !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    19.4804,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    19.4804,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    23.206138611,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    23.206138611,-9.3221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  Floor:Detailed,
    Floor F_E.3,             !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_SE,               !- Zone Name
    Surface,                 !- Outside Boundary Condition
    Ceiling F_E.3,           !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    23.206138611,-9.3221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    23.206138611,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-7.5909,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-9.3221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    DpvFloor:222010.4.ZONE_G_CORE.2.0_CEILING,  !- Name
    Ceiling,                 !- Surface Type
    HPZ G Floor_REVERSED,    !- Construction Name
    ZONE_F_CORE,             !- Zone Name
    Surface,                 !- Outside Boundary Condition
    DpvFloor:222010.4.ZONE_G_CORE.2.0,  !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    autocalculate,           !- View Factor to Ground
    4,                       !- Number of Vertices
    15.4961,-3.7221,11.0900,  !- X,Y,Z ==> Vertex 1 {m}
    15.4961,6.4779,11.0900,  !- X,Y,Z ==> Vertex 2 {m}
    5.3461,6.4779,11.0900,  !- X,Y,Z ==> Vertex 3 {m}
    5.3461,-3.7221,11.0900;  !- X,Y,Z ==> Vertex 4 {m}

!- =========== ALL OBJECTS IN CLASS: FENESTRATIONSURFACE:DETAILED ===========

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:206583.0:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:206583.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:206583.0,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -1.6575,-11.1221,3.6177,  !- X,Y,Z ==> Vertex 1 {m}
    6.6241,-11.1221,3.6177,  !- X,Y,Z ==> Vertex 2 {m}
    6.6241,-11.1221,6.7123,  !- X,Y,Z ==> Vertex 3 {m}
    -1.6575,-11.1221,6.7123;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:206583.1:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:206583.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:206583.1,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    7.3188,-11.1221,3.6103,  !- X,Y,Z ==> Vertex 1 {m}
    13.7133,-11.1221,3.6103,  !- X,Y,Z ==> Vertex 2 {m}
    13.7133,-11.1221,6.7197,  !- X,Y,Z ==> Vertex 3 {m}
    7.3188,-11.1221,6.7197;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:245336.0.0:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:245336.0.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.0.0,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -2.0194,13.6037,3.5804,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,8.7520,3.5804,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,8.7520,6.7496,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,13.6037,6.7496;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:245336.0.1:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:245336.0.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.0.1,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -2.0194,8.0115,3.6449,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,-5.4757,3.6449,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-5.4757,6.6851,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,8.0115,6.6851;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:245336.1:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:245336.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.1,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -2.0194,-6.2251,3.5895,  !- X,Y,Z ==> Vertex 1 {m}
    -2.0194,-10.8392,3.5895,  !- X,Y,Z ==> Vertex 2 {m}
    -2.0194,-10.8392,6.7405,  !- X,Y,Z ==> Vertex 3 {m}
    -2.0194,-6.2251,6.7405;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:245456.1:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:245456.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245456.1,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    4.8999,13.8779,3.6344,  !- X,Y,Z ==> Vertex 1 {m}
    -1.6333,13.8779,3.6344,  !- X,Y,Z ==> Vertex 2 {m}
    -1.6333,13.8779,6.6956,  !- X,Y,Z ==> Vertex 3 {m}
    4.8999,13.8779,6.6956;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:245456.0:3ScheibenIsoMetallrahmen,  !- Name
    Window,                  !- Surface Type
    3ScheibenIsoMetallrahmen,!- Construction Name
    DpvWall:245456.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245456.0,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    13.7713,13.8779,3.5977,  !- X,Y,Z ==> Vertex 1 {m}
    5.5953,13.8779,3.5977,  !- X,Y,Z ==> Vertex 2 {m}
    5.5953,13.8779,6.7323,  !- X,Y,Z ==> Vertex 3 {m}
    13.7713,13.8779,6.7323;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225483.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225483.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,14.6651,11.2154,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,14.6651,14.2246,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,11.6559,14.2246,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,11.6559,11.2154;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225483.1.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225483.1.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,-8.8589,11.2154,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-8.8589,14.2246,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-11.8681,14.2246,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-11.8681,11.2154;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225786.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225786.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -3.0422,15.8919,11.5474,  !- X,Y,Z ==> Vertex 1 {m}
    -3.0422,15.8919,13.8926,  !- X,Y,Z ==> Vertex 2 {m}
    2.1062,15.8919,13.8926,  !- X,Y,Z ==> Vertex 3 {m}
    2.1062,15.8919,11.5474;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225786.1.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225786.1.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    18.5886,15.8919,11.5730,  !- X,Y,Z ==> Vertex 1 {m}
    18.5886,15.8919,13.8670,  !- X,Y,Z ==> Vertex 2 {m}
    23.8518,15.8919,13.8670,  !- X,Y,Z ==> Vertex 3 {m}
    23.8518,15.8919,11.5730;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225659.1.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225659.1.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    2.2733,-13.1361,11.5694,  !- X,Y,Z ==> Vertex 1 {m}
    2.2733,-13.1361,13.8767,  !- X,Y,Z ==> Vertex 2 {m}
    -2.9594,-13.1361,13.8767,  !- X,Y,Z ==> Vertex 3 {m}
    -2.9594,-13.1361,11.5694;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:219370.0.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:219370.0.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -4.0464,-11.8681,11.2124,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-11.8681,14.2216,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-8.8589,14.2216,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-8.8589,11.2124;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:219370.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:219370.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -4.0464,11.6559,11.2124,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,11.6559,14.2216,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,14.6651,14.2216,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,14.6651,11.2124;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:233189.1.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:233189.1.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,-10.0006,8.0665,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,-10.0006,10.5235,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-12.4576,10.5235,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-12.4576,8.0665;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:224651.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:224651.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -0.3213,15.8919,8.0715,  !- X,Y,Z ==> Vertex 1 {m}
    -0.3213,15.8919,10.5252,  !- X,Y,Z ==> Vertex 2 {m}
    15.6710,15.8919,10.5252,  !- X,Y,Z ==> Vertex 3 {m}
    15.6710,15.8919,8.0715;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:233220.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:233220.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    15.6784,-13.1361,8.0693,  !- X,Y,Z ==> Vertex 1 {m}
    15.6784,-13.1361,10.5207,  !- X,Y,Z ==> Vertex 2 {m}
    -0.3288,-13.1361,10.5207,  !- X,Y,Z ==> Vertex 3 {m}
    -0.3288,-13.1361,8.0693;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:224902.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:224902.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -4.0464,-10.8240,8.0708,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-10.8240,10.5125,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,-0.9343,10.5125,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,-0.9343,8.0708;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:224902.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:224902.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -4.0464,3.6900,8.0708,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,3.6900,10.5125,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,13.5797,10.5125,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,13.5797,8.0708;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225483.1.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225483.1.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,7.8775,11.5516,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,7.8775,13.8884,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-5.0394,13.8884,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-5.0394,11.5516;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:233189.1.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:233189.1.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,8.8591,8.0682,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,8.8591,10.5218,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,-5.9034,10.5218,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,-5.9034,8.0682;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:233189.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:233189.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    24.9601,15.3134,8.0665,  !- X,Y,Z ==> Vertex 1 {m}
    24.9601,15.3134,10.5235,  !- X,Y,Z ==> Vertex 2 {m}
    24.9601,12.8564,10.5235,  !- X,Y,Z ==> Vertex 3 {m}
    24.9601,12.8564,8.0665;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:224651.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:224651.1,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    20.6735,15.8919,7.7937,  !- X,Y,Z ==> Vertex 1 {m}
    20.6735,15.8919,10.8029,  !- X,Y,Z ==> Vertex 2 {m}
    23.6826,15.8919,10.8029,  !- X,Y,Z ==> Vertex 3 {m}
    23.6826,15.8919,7.7937;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225786.1.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225786.1.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    5.1369,15.8919,11.5497,  !- X,Y,Z ==> Vertex 1 {m}
    5.1369,15.8919,13.8903,  !- X,Y,Z ==> Vertex 2 {m}
    15.4539,15.8919,13.8903,  !- X,Y,Z ==> Vertex 3 {m}
    15.4539,15.8919,11.5497;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:233220.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:233220.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    23.6826,-13.1361,7.7904,  !- X,Y,Z ==> Vertex 1 {m}
    23.6826,-13.1361,10.7996,  !- X,Y,Z ==> Vertex 2 {m}
    20.6735,-13.1361,10.7996,  !- X,Y,Z ==> Vertex 3 {m}
    20.6735,-13.1361,7.7904;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:219370.0.1:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:219370.0.1,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    -4.0464,-5.0454,11.5497,  !- X,Y,Z ==> Vertex 1 {m}
    -4.0464,-5.0454,13.8843,  !- X,Y,Z ==> Vertex 2 {m}
    -4.0464,7.8835,13.8843,  !- X,Y,Z ==> Vertex 3 {m}
    -4.0464,7.8835,11.5497;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225659.1.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225659.1.0,      !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    15.6957,-13.1361,11.5515,  !- X,Y,Z ==> Vertex 1 {m}
    15.6957,-13.1361,13.8946,  !- X,Y,Z ==> Vertex 2 {m}
    5.3901,-13.1361,13.8946,  !- X,Y,Z ==> Vertex 3 {m}
    5.3901,-13.1361,11.5515;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:225659.0:HPZ_Window_F_G,  !- Name
    Window,                  !- Surface Type
    HPZ_Window_F_G,          !- Construction Name
    DpvWall:225659.0,        !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    STAuto_TempRad,          !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    23.9285,-13.1361,11.5557,  !- X,Y,Z ==> Vertex 1 {m}
    23.9285,-13.1361,13.8904,  !- X,Y,Z ==> Vertex 2 {m}
    18.7570,-13.1361,13.8904,  !- X,Y,Z ==> Vertex 3 {m}
    18.7570,-13.1361,11.5557;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:186916:2ScheibenIso,  !- Name
    Window,                  !- Surface Type
    2ScheibenIso,            !- Construction Name
    DpvWall:186916,          !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    ,                        !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    14.5431,3.6919,3.5808,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,3.6919,6.5885,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,-0.9362,6.5885,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-0.9362,3.5808;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DpvWindow:Combined:DpvWall:186812:Simplified:AboveGround:2ScheibenIso,  !- Name
    Window,                  !- Surface Type
    2ScheibenIso,            !- Construction Name
    DpvWall:186812:Simplified:AboveGround,  !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    autocalculate,           !- View Factor to Ground
    ,                        !- Shading Control Name
    DefaultWindowFrameAndDivider,  !- Frame and Divider Name
    1,                       !- Multiplier
    autocalculate,           !- Number of Vertices
    14.5431,-0.9080,0.1426,  !- X,Y,Z ==> Vertex 1 {m}
    14.5431,3.6637,0.1426,  !- X,Y,Z ==> Vertex 2 {m}
    14.5431,3.6637,3.1874,  !- X,Y,Z ==> Vertex 3 {m}
    14.5431,-0.9080,3.1874;  !- X,Y,Z ==> Vertex 4 {m}

!- =========== ALL OBJECTS IN CLASS: WINDOWPROPERTY:SHADINGCONTROL ===========

  WindowProperty:ShadingControl,
    STAuto_TempRad,          !- Name
    ExteriorBlind,           !- Shading Type
    ,                        !- Construction with Shading Name
    OnIfHighZoneAirTempAndHighSolarOnWindow,  !- Shading Control Type
    ,                        !- Schedule Name
    24,                      !- Setpoint {W/m2, W or deg C}
    No,                      !- Shading Control Is Scheduled
    No,                      !- Glare Control Is Active
    HPZ_Blindsmaterial,      !- Shading Device Material Name
    ,                        !- Type of Slat Angle Control for Blinds
    ,                        !- Slat Angle Schedule Name
    150;                     !- Setpoint 2 {W/m2 or deg C}

!- =========== ALL OBJECTS IN CLASS: WINDOWPROPERTY:FRAMEANDDIVIDER ===========

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu,        !- Name
    0.1100,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    DefaultWindowFrameAndDivider,  !- Name
    0.0000,                  !- Frame Width {m}
    0.0000,                  !- Frame Outside Projection {m}
    0.0000,                  !- Frame Inside Projection {m}
    3.0000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    3.0000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:206583.0,  !- Name
    0.2367,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:206583.1,  !- Name
    0.2235,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.0.0,  !- Name
    0.1999,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.0.1,  !- Name
    0.2632,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245336.1,  !- Name
    0.2026,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245456.1,  !- Name
    0.2219,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

  WindowProperty:FrameAndDivider,
    HPZ_EGeschossNeu:3ScheibenIsoMetallrahmen:DpvWall:245456.0,  !- Name
    0.2380,                  !- Frame Width {m}
    0.0200,                  !- Frame Outside Projection {m}
    0.0200,                  !- Frame Inside Projection {m}
    1.6000,                  !- Frame Conductance {W/m2-K}
    1.0000,                  !- Ratio of Frame-Edge Glass Conductance to Center-Of-Glass Conductance
    0.7000,                  !- Frame Solar Absorptance
    0.7000,                  !- Frame Visible Absorptance
    0.9000,                  !- Frame Thermal Hemispherical Emissivity
    DividedLite,             !- Divider Type
    0.0000,                  !- Divider Width {m}
    0.0000,                  !- Number of Horizontal Dividers
    0.0000,                  !- Number of Vertical Dividers
    0.0000,                  !- Divider Outside Projection {m}
    0.0000,                  !- Divider Inside Projection {m}
    1.6000,                  !- Divider Conductance {W/m2-K}
    ,                        !- Ratio of Divider-Edge Glass Conductance to Center-Of-Glass Conductance
    ,                        !- Divider Solar Absorptance
    ,                        !- Divider Visible Absorptance
    ;                        !- Divider Thermal Hemispherical Emissivity

!- =========== ALL OBJECTS IN CLASS: INTERNALMASS ===========

  InternalMass,
    DpvWall:CombinedInterior: HPZ - Wand innen - 150mm,  !- Name
    HPZ - Wand innen - 150mm,!- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    38.4384;                 !- Surface Area {m2}

  InternalMass,
    DpvWall:CombinedInterior: HPZ_Wand_innen_STB200,  !- Name
    HPZ_Wand_innen_STB200,   !- Construction Name
    ZONE_E_CORE_M,           !- Zone Name
    195.2610;                !- Surface Area {m2}

  InternalMass,
    DpvFloor:222010.2.ZONE_G_N.3.1,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_N,                !- Zone Name
    0.8204;                  !- Surface Area {m2}

  InternalMass,
    DpvFloor:222010.4.ZONE_G_CORE.12.1,  !- Name
    HPZ G Floor,             !- Construction Name
    ZONE_G_CORE,             !- Zone Name
    0.3031;                  !- Surface Area {m2}

!- =========== ALL OBJECTS IN CLASS: SHADING:BUILDING:DETAILED ===========

  Shading:Building:Detailed,
    DpvShadingSurface:229702:0,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    102.0816,-40.5424,7.9059,  !- X,Y,Z ==> Vertex 1 {m}
    102.1225,-3.5275,7.9059,  !- X,Y,Z ==> Vertex 2 {m}
    102.1225,-3.5275,55.8025,  !- X,Y,Z ==> Vertex 3 {m}
    102.0816,-40.5424,55.8025;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Building:Detailed,
    DpvShadingSurface:229702:1,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    102.1225,-3.5275,7.9059,  !- X,Y,Z ==> Vertex 1 {m}
    65.6557,-3.4873,7.9059,  !- X,Y,Z ==> Vertex 2 {m}
    65.6557,-3.4873,55.8025,  !- X,Y,Z ==> Vertex 3 {m}
    102.1225,-3.5275,55.8025;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Building:Detailed,
    DpvShadingSurface:229702:2,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    65.6557,-3.4873,7.9059,  !- X,Y,Z ==> Vertex 1 {m}
    65.6149,-40.5021,7.9059,  !- X,Y,Z ==> Vertex 2 {m}
    65.6149,-40.5021,55.8025,  !- X,Y,Z ==> Vertex 3 {m}
    65.6557,-3.4873,55.8025;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Building:Detailed,
    DpvShadingSurface:229702:3,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    65.6149,-40.5021,7.9059,  !- X,Y,Z ==> Vertex 1 {m}
    102.0816,-40.5424,7.9059,  !- X,Y,Z ==> Vertex 2 {m}
    102.0816,-40.5424,55.8025,  !- X,Y,Z ==> Vertex 3 {m}
    65.6149,-40.5021,55.8025;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Building:Detailed,
    DpvShadingSurface:229702:4,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    65.6557,-3.4873,55.8025,  !- X,Y,Z ==> Vertex 1 {m}
    65.6149,-40.5021,55.8025,  !- X,Y,Z ==> Vertex 2 {m}
    102.0816,-40.5424,55.8025,  !- X,Y,Z ==> Vertex 3 {m}
    102.1225,-3.5275,55.8025;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Building:Detailed,
    DpvShadingSurface:229702:5,  !- Name
    ,                        !- Transmittance Schedule Name
    autocalculate,           !- Number of Vertices
    102.0816,-40.5424,7.9059,  !- X,Y,Z ==> Vertex 1 {m}
    65.6149,-40.5021,7.9059,  !- X,Y,Z ==> Vertex 2 {m}
    65.6557,-3.4873,7.9059,  !- X,Y,Z ==> Vertex 3 {m}
    102.1225,-3.5275,7.9059;  !- X,Y,Z ==> Vertex 4 {m}

! =========== RESIDENTIAL SCHEDULES ===========

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_Occupation_Day100,  !- Name
    Fraction,                !- Schedule Type Limits Name
    1.00,                    !- Hour 1
    1.00,                    !- Hour 2
    1.00,                    !- Hour 3
    1.00,                    !- Hour 4
    1.00,                    !- Hour 5
    1.00,                    !- Hour 6
    0.80,                    !- Hour 7
    0.60,                    !- Hour 8
    0.40,                    !- Hour 9
    0.40,                    !- Hour 10
    0.40,                    !- Hour 11
    0.60,                    !- Hour 12
    0.80,                    !- Hour 13
    0.60,                    !- Hour 14
    0.40,                    !- Hour 15
    0.40,                    !- Hour 16
    0.60,                    !- Hour 17
    0.80,                    !- Hour 18
    0.80,                    !- Hour 19
    0.80,                    !- Hour 20
    0.80,                    !- Hour 21
    1.00,                    !- Hour 22
    1.00,                    !- Hour 23
    1.00;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_Occupation_Day080,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.80,                    !- Hour 1
    0.80,                    !- Hour 2
    0.80,                    !- Hour 3
    0.80,                    !- Hour 4
    0.80,                    !- Hour 5
    0.80,                    !- Hour 6
    0.64,                    !- Hour 7
    0.48,                    !- Hour 8
    0.32,                    !- Hour 9
    0.32,                    !- Hour 10
    0.32,                    !- Hour 11
    0.48,                    !- Hour 12
    0.64,                    !- Hour 13
    0.48,                    !- Hour 14
    0.32,                    !- Hour 15
    0.32,                    !- Hour 16
    0.48,                    !- Hour 17
    0.64,                    !- Hour 18
    0.64,                    !- Hour 19
    0.64,                    !- Hour 20
    0.64,                    !- Hour 21
    0.80,                    !- Hour 22
    0.80,                    !- Hour 23
    0.80;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_Occupation_Day060,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.60,                    !- Hour 1
    0.60,                    !- Hour 2
    0.60,                    !- Hour 3
    0.60,                    !- Hour 4
    0.60,                    !- Hour 5
    0.60,                    !- Hour 6
    0.48,                    !- Hour 7
    0.36,                    !- Hour 8
    0.24,                    !- Hour 9
    0.24,                    !- Hour 10
    0.24,                    !- Hour 11
    0.36,                    !- Hour 12
    0.48,                    !- Hour 13
    0.36,                    !- Hour 14
    0.24,                    !- Hour 15
    0.24,                    !- Hour 16
    0.36,                    !- Hour 17
    0.48,                    !- Hour 18
    0.48,                    !- Hour 19
    0.48,                    !- Hour 20
    0.48,                    !- Hour 21
    0.60,                    !- Hour 22
    0.60,                    !- Hour 23
    0.60;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_LightsElEq_Day100,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.50,                    !- Hour 7
    1.00,                    !- Hour 8
    0.50,                    !- Hour 9
    0.50,                    !- Hour 10
    0.50,                    !- Hour 11
    1.00,                    !- Hour 12
    1.00,                    !- Hour 13
    0.50,                    !- Hour 14
    0.50,                    !- Hour 15
    0.50,                    !- Hour 16
    1.00,                    !- Hour 17
    1.00,                    !- Hour 18
    1.00,                    !- Hour 19
    1.00,                    !- Hour 20
    0.50,                    !- Hour 21
    0.50,                    !- Hour 22
    0.50,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_LightsElEq_Day080,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.40,                    !- Hour 7
    0.80,                    !- Hour 8
    0.40,                    !- Hour 9
    0.40,                    !- Hour 10
    0.40,                    !- Hour 11
    0.80,                    !- Hour 12
    0.80,                    !- Hour 13
    0.40,                    !- Hour 14
    0.40,                    !- Hour 15
    0.40,                    !- Hour 16
    0.80,                    !- Hour 17
    0.80,                    !- Hour 18
    0.80,                    !- Hour 19
    0.80,                    !- Hour 20
    0.40,                    !- Hour 21
    0.40,                    !- Hour 22
    0.40,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Residential_LightsElEq_Day060,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.30,                    !- Hour 7
    0.60,                    !- Hour 8
    0.30,                    !- Hour 9
    0.30,                    !- Hour 10
    0.30,                    !- Hour 11
    0.60,                    !- Hour 12
    0.60,                    !- Hour 13
    0.30,                    !- Hour 14
    0.30,                    !- Hour 15
    0.30,                    !- Hour 16
    0.60,                    !- Hour 17
    0.60,                    !- Hour 18
    0.60,                    !- Hour 19
    0.60,                    !- Hour 20
    0.30,                    !- Hour 21
    0.30,                    !- Hour 22
    0.30,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Week:Compact,
    Sched_Fraction_Residential_Occupation_Week100,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_Occupation_Day100;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Residential_Occupation_Week080,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_Occupation_Day080;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Residential_Occupation_Week060,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_Occupation_Day060;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Residential_LightsElEq_Week100,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_LightsElEq_Day100;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Residential_LightsElEq_Week080,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_LightsElEq_Day080;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Residential_LightsElEq_Day060;  !- Schedule:Day Name 1

  Schedule:Year,
    Schedule_Fraction_Residential_Occupation,  !- Name
    Fraction,                !- Schedule Type Limits Name
    Sched_Fraction_Residential_Occupation_Week080,  !- Schedule:Week Name 1
    1,                       !- Start Month 1
    1,                       !- Start Day 1
    1,                       !- End Month 1
    31,                      !- End Day 1
    Sched_Fraction_Residential_Occupation_Week060,  !- Schedule:Week Name 2
    2,                       !- Start Month 2
    1,                       !- Start Day 2
    2,                       !- End Month 2
    28,                      !- End Day 2
    Sched_Fraction_Residential_Occupation_Week100,  !- Schedule:Week Name 3
    3,                       !- Start Month 3
    1,                       !- Start Day 3
    3,                       !- End Month 3
    31,                      !- End Day 3
    Sched_Fraction_Residential_Occupation_Week080,  !- Schedule:Week Name 4
    4,                       !- Start Month 4
    1,                       !- Start Day 4
    4,                       !- End Month 4
    30,                      !- End Day 4
    Sched_Fraction_Residential_Occupation_Week060,  !- Schedule:Week Name 5
    5,                       !- Start Month 5
    1,                       !- Start Day 5
    5,                       !- End Month 5
    31,                      !- End Day 5
    Sched_Fraction_Residential_Occupation_Week100,  !- Schedule:Week Name 6
    6,                       !- Start Month 6
    1,                       !- Start Day 6
    6,                       !- End Month 6
    30,                      !- End Day 6
    Sched_Fraction_Residential_Occupation_Week060,  !- Schedule:Week Name 7
    7,                       !- Start Month 7
    1,                       !- Start Day 7
    7,                       !- End Month 7
    31,                      !- End Day 7
    Sched_Fraction_Residential_Occupation_Week060,  !- Schedule:Week Name 8
    8,                       !- Start Month 8
    1,                       !- Start Day 8
    8,                       !- End Month 8
    31,                      !- End Day 8
    Sched_Fraction_Residential_Occupation_Week100,  !- Schedule:Week Name 9
    9,                       !- Start Month 9
    1,                       !- Start Day 9
    9,                       !- End Month 9
    30,                      !- End Day 9
    Sched_Fraction_Residential_Occupation_Week080,  !- Schedule:Week Name 10
    10,                      !- Start Month 10
    1,                       !- Start Day 10
    10,                      !- End Month 10
    31,                      !- End Day 10
    Sched_Fraction_Residential_Occupation_Week100,  !- Schedule:Week Name 11
    11,                      !- Start Month 11
    1,                       !- Start Day 11
    11,                      !- End Month 11
    30,                      !- End Day 11
    Sched_Fraction_Residential_Occupation_Week060,  !- Schedule:Week Name 12
    12,                      !- Start Month 12
    1,                       !- Start Day 12
    12,                      !- End Month 12
    31;                      !- End Day 12

  Schedule:Year,
    Schedule_Fraction_Residential_LightsElEq,  !- Name
    Fraction,                !- Schedule Type Limits Name
    Sched_Fraction_Residential_LightsElEq_Week080,  !- Schedule:Week Name 1
    1,                       !- Start Month 1
    1,                       !- Start Day 1
    1,                       !- End Month 1
    31,                      !- End Day 1
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Schedule:Week Name 2
    2,                       !- Start Month 2
    1,                       !- Start Day 2
    2,                       !- End Month 2
    28,                      !- End Day 2
    Sched_Fraction_Residential_LightsElEq_Week100,  !- Schedule:Week Name 3
    3,                       !- Start Month 3
    1,                       !- Start Day 3
    3,                       !- End Month 3
    31,                      !- End Day 3
    Sched_Fraction_Residential_LightsElEq_Week080,  !- Schedule:Week Name 4
    4,                       !- Start Month 4
    1,                       !- Start Day 4
    4,                       !- End Month 4
    30,                      !- End Day 4
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Schedule:Week Name 5
    5,                       !- Start Month 5
    1,                       !- Start Day 5
    5,                       !- End Month 5
    31,                      !- End Day 5
    Sched_Fraction_Residential_LightsElEq_Week100,  !- Schedule:Week Name 6
    6,                       !- Start Month 6
    1,                       !- Start Day 6
    6,                       !- End Month 6
    30,                      !- End Day 6
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Schedule:Week Name 7
    7,                       !- Start Month 7
    1,                       !- Start Day 7
    7,                       !- End Month 7
    31,                      !- End Day 7
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Schedule:Week Name 8
    8,                       !- Start Month 8
    1,                       !- Start Day 8
    8,                       !- End Month 8
    31,                      !- End Day 8
    Sched_Fraction_Residential_LightsElEq_Week100,  !- Schedule:Week Name 9
    9,                       !- Start Month 9
    1,                       !- Start Day 9
    9,                       !- End Month 9
    30,                      !- End Day 9
    Sched_Fraction_Residential_LightsElEq_Week080,  !- Schedule:Week Name 10
    10,                      !- Start Month 10
    1,                       !- Start Day 10
    10,                      !- End Month 10
    31,                      !- End Day 10
    Sched_Fraction_Residential_LightsElEq_Week100,  !- Schedule:Week Name 11
    11,                      !- Start Month 11
    1,                       !- Start Day 11
    11,                      !- End Month 11
    30,                      !- End Day 11
    Sched_Fraction_Residential_LightsElEq_Week060,  !- Schedule:Week Name 12
    12,                      !- Start Month 12
    1,                       !- Start Day 12
    12,                      !- End Month 12
    31;                      !- End Day 12

  Schedule:Constant,Schedule_AnyNumber_Residt_PeopleActivity,AnyNumber,70;

! =========== OFFICE SCHEDULES ===========

  Schedule:Day:Hourly,
    Sched_Fraction_Office_Occupation_Day100,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.00,                    !- Hour 1
    0.00,                    !- Hour 2
    0.00,                    !- Hour 3
    0.00,                    !- Hour 4
    0.00,                    !- Hour 5
    0.00,                    !- Hour 6
    0.00,                    !- Hour 7
    0.20,                    !- Hour 8
    0.40,                    !- Hour 9
    0.60,                    !- Hour 10
    0.80,                    !- Hour 11
    0.80,                    !- Hour 12
    0.40,                    !- Hour 13
    0.60,                    !- Hour 14
    0.80,                    !- Hour 15
    0.80,                    !- Hour 16
    0.40,                    !- Hour 17
    0.20,                    !- Hour 18
    0.00,                    !- Hour 19
    0.00,                    !- Hour 20
    0.00,                    !- Hour 21
    0.00,                    !- Hour 22
    0.00,                    !- Hour 23
    0.00;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Office_Occupation_Day080,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.00,                    !- Hour 1
    0.00,                    !- Hour 2
    0.00,                    !- Hour 3
    0.00,                    !- Hour 4
    0.00,                    !- Hour 5
    0.00,                    !- Hour 6
    0.00,                    !- Hour 7
    0.16,                    !- Hour 8
    0.32,                    !- Hour 9
    0.48,                    !- Hour 10
    0.64,                    !- Hour 11
    0.64,                    !- Hour 12
    0.32,                    !- Hour 13
    0.48,                    !- Hour 14
    0.64,                    !- Hour 15
    0.64,                    !- Hour 16
    0.32,                    !- Hour 17
    0.16,                    !- Hour 18
    0.00,                    !- Hour 19
    0.00,                    !- Hour 20
    0.00,                    !- Hour 21
    0.00,                    !- Hour 22
    0.00,                    !- Hour 23
    0.00;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Office_Occupation_Day060,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.00,                    !- Hour 1
    0.00,                    !- Hour 2
    0.00,                    !- Hour 3
    0.00,                    !- Hour 4
    0.00,                    !- Hour 5
    0.00,                    !- Hour 6
    0.00,                    !- Hour 7
    0.12,                    !- Hour 8
    0.24,                    !- Hour 9
    0.36,                    !- Hour 10
    0.48,                    !- Hour 11
    0.48,                    !- Hour 12
    0.24,                    !- Hour 13
    0.36,                    !- Hour 14
    0.48,                    !- Hour 15
    0.48,                    !- Hour 16
    0.24,                    !- Hour 17
    0.12,                    !- Hour 18
    0.00,                    !- Hour 19
    0.00,                    !- Hour 20
    0.00,                    !- Hour 21
    0.00,                    !- Hour 22
    0.00,                    !- Hour 23
    0.00;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Office_LightsElEq_Day100,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.10,                    !- Hour 7
    0.20,                    !- Hour 8
    0.40,                    !- Hour 9
    0.60,                    !- Hour 10
    0.80,                    !- Hour 11
    0.80,                    !- Hour 12
    0.40,                    !- Hour 13
    0.60,                    !- Hour 14
    0.80,                    !- Hour 15
    0.80,                    !- Hour 16
    0.40,                    !- Hour 17
    0.20,                    !- Hour 18
    0.10,                    !- Hour 19
    0.10,                    !- Hour 20
    0.10,                    !- Hour 21
    0.10,                    !- Hour 22
    0.10,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Office_LightsElEq_Day080,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.10,                    !- Hour 7
    0.16,                    !- Hour 8
    0.32,                    !- Hour 9
    0.48,                    !- Hour 10
    0.64,                    !- Hour 11
    0.64,                    !- Hour 12
    0.32,                    !- Hour 13
    0.48,                    !- Hour 14
    0.64,                    !- Hour 15
    0.64,                    !- Hour 16
    0.32,                    !- Hour 17
    0.16,                    !- Hour 18
    0.10,                    !- Hour 19
    0.10,                    !- Hour 20
    0.10,                    !- Hour 21
    0.10,                    !- Hour 22
    0.10,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Day:Hourly,
    Sched_Fraction_Office_LightsElEq_Day060,  !- Name
    Fraction,                !- Schedule Type Limits Name
    0.10,                    !- Hour 1
    0.10,                    !- Hour 2
    0.10,                    !- Hour 3
    0.10,                    !- Hour 4
    0.10,                    !- Hour 5
    0.10,                    !- Hour 6
    0.10,                    !- Hour 7
    0.12,                    !- Hour 8
    0.24,                    !- Hour 9
    0.36,                    !- Hour 10
    0.48,                    !- Hour 11
    0.48,                    !- Hour 12
    0.24,                    !- Hour 13
    0.36,                    !- Hour 14
    0.48,                    !- Hour 15
    0.48,                    !- Hour 16
    0.24,                    !- Hour 17
    0.12,                    !- Hour 18
    0.10,                    !- Hour 19
    0.10,                    !- Hour 20
    0.10,                    !- Hour 21
    0.10,                    !- Hour 22
    0.10,                    !- Hour 23
    0.10;                    !- Hour 24

  Schedule:Week:Compact,
    Sched_Fraction_Office_Occupation_Week100,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_Occupation_Day100;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Office_Occupation_Week080,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_Occupation_Day080;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Office_Occupation_Week060,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_Occupation_Day060;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Office_LightsElEq_Week100,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_LightsElEq_Day100;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Office_LightsElEq_Week080,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_LightsElEq_Day080;  !- Schedule:Day Name 1

  Schedule:Week:Compact,
    Sched_Fraction_Office_LightsElEq_Week060,  !- Name
    For AllDays,             !- DayType List 1
    Sched_Fraction_Office_LightsElEq_Day060;  !- Schedule:Day Name 1

  Schedule:Year,
    Schedule_Fraction_Office_Occupation,  !- Name
    Fraction,                !- Schedule Type Limits Name
    Sched_Fraction_Office_Occupation_Week080,  !- Schedule:Week Name 1
    1,                       !- Start Month 1
    1,                       !- Start Day 1
    1,                       !- End Month 1
    31,                      !- End Day 1
    Sched_Fraction_Office_Occupation_Week060,  !- Schedule:Week Name 2
    2,                       !- Start Month 2
    1,                       !- Start Day 2
    2,                       !- End Month 2
    28,                      !- End Day 2
    Sched_Fraction_Office_Occupation_Week100,  !- Schedule:Week Name 3
    3,                       !- Start Month 3
    1,                       !- Start Day 3
    3,                       !- End Month 3
    31,                      !- End Day 3
    Sched_Fraction_Office_Occupation_Week080,  !- Schedule:Week Name 4
    4,                       !- Start Month 4
    1,                       !- Start Day 4
    4,                       !- End Month 4
    30,                      !- End Day 4
    Sched_Fraction_Office_Occupation_Week060,  !- Schedule:Week Name 5
    5,                       !- Start Month 5
    1,                       !- Start Day 5
    5,                       !- End Month 5
    31,                      !- End Day 5
    Sched_Fraction_Office_Occupation_Week100,  !- Schedule:Week Name 6
    6,                       !- Start Month 6
    1,                       !- Start Day 6
    6,                       !- End Month 6
    30,                      !- End Day 6
    Sched_Fraction_Office_Occupation_Week060,  !- Schedule:Week Name 7
    7,                       !- Start Month 7
    1,                       !- Start Day 7
    7,                       !- End Month 7
    31,                      !- End Day 7
    Sched_Fraction_Office_Occupation_Week060,  !- Schedule:Week Name 8
    8,                       !- Start Month 8
    1,                       !- Start Day 8
    8,                       !- End Month 8
    31,                      !- End Day 8
    Sched_Fraction_Office_Occupation_Week100,  !- Schedule:Week Name 9
    9,                       !- Start Month 9
    1,                       !- Start Day 9
    9,                       !- End Month 9
    30,                      !- End Day 9
    Sched_Fraction_Office_Occupation_Week080,  !- Schedule:Week Name 10
    10,                      !- Start Month 10
    1,                       !- Start Day 10
    10,                      !- End Month 10
    31,                      !- End Day 10
    Sched_Fraction_Office_Occupation_Week100,  !- Schedule:Week Name 11
    11,                      !- Start Month 11
    1,                       !- Start Day 11
    11,                      !- End Month 11
    30,                      !- End Day 11
    Sched_Fraction_Office_Occupation_Week060,  !- Schedule:Week Name 12
    12,                      !- Start Month 12
    1,                       !- Start Day 12
    12,                      !- End Month 12
    31;                      !- End Day 12

  Schedule:Year,
    Schedule_Fraction_Office_LightsElEq,  !- Name
    Fraction,                !- Schedule Type Limits Name
    Sched_Fraction_Office_LightsElEq_Week080,  !- Schedule:Week Name 1
    1,                       !- Start Month 1
    1,                       !- Start Day 1
    1,                       !- End Month 1
    31,                      !- End Day 1
    Sched_Fraction_Office_LightsElEq_Week060,  !- Schedule:Week Name 2
    2,                       !- Start Month 2
    1,                       !- Start Day 2
    2,                       !- End Month 2
    28,                      !- End Day 2
    Sched_Fraction_Office_LightsElEq_Week100,  !- Schedule:Week Name 3
    3,                       !- Start Month 3
    1,                       !- Start Day 3
    3,                       !- End Month 3
    31,                      !- End Day 3
    Sched_Fraction_Office_LightsElEq_Week080,  !- Schedule:Week Name 4
    4,                       !- Start Month 4
    1,                       !- Start Day 4
    4,                       !- End Month 4
    30,                      !- End Day 4
    Sched_Fraction_Office_LightsElEq_Week060,  !- Schedule:Week Name 5
    5,                       !- Start Month 5
    1,                       !- Start Day 5
    5,                       !- End Month 5
    31,                      !- End Day 5
    Sched_Fraction_Office_LightsElEq_Week100,  !- Schedule:Week Name 6
    6,                       !- Start Month 6
    1,                       !- Start Day 6
    6,                       !- End Month 6
    30,                      !- End Day 6
    Sched_Fraction_Office_LightsElEq_Week060,  !- Schedule:Week Name 7
    7,                       !- Start Month 7
    1,                       !- Start Day 7
    7,                       !- End Month 7
    31,                      !- End Day 7
    Sched_Fraction_Office_LightsElEq_Week060,  !- Schedule:Week Name 8
    8,                       !- Start Month 8
    1,                       !- Start Day 8
    8,                       !- End Month 8
    31,                      !- End Day 8
    Sched_Fraction_Office_LightsElEq_Week100,  !- Schedule:Week Name 9
    9,                       !- Start Month 9
    1,                       !- Start Day 9
    9,                       !- End Month 9
    30,                      !- End Day 9
    Sched_Fraction_Office_LightsElEq_Week080,  !- Schedule:Week Name 10
    10,                      !- Start Month 10
    1,                       !- Start Day 10
    10,                      !- End Month 10
    31,                      !- End Day 10
    Sched_Fraction_Office_LightsElEq_Week100,  !- Schedule:Week Name 11
    11,                      !- Start Month 11
    1,                       !- Start Day 11
    11,                      !- End Month 11
    30,                      !- End Day 11
    Sched_Fraction_Office_LightsElEq_Week060,  !- Schedule:Week Name 12
    12,                      !- Start Month 12
    1,                       !- Start Day 12
    12,                      !- End Month 12
    31;                      !- End Day 12

  Schedule:Constant,Schedule_AnyNumber_Office_PeopleActivity,AnyNumber,70;

    ! =========== INTERNAL GAINS ===========

  People,
    InternalGains_People ZoneList_AllZones,  !- Name
    ZoneList_AllZones,       !- Zone or ZoneList Name
    Schedule_Fraction_Office_Occupation,  !- Number of People Schedule Name
    Area/Person,             !- Number of People Calculation Method
    ,                        !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    14.0,                    !- Zone Floor Area per Person {m2/person}
    0.30,                    !- Fraction Radiant
    autocalculate,           !- Sensible Heat Fraction
    Schedule_AnyNumber_Office_PeopleActivity,  !- Activity Level Schedule Name
    ,                        !- Carbon Dioxide Generation Rate {m3/s-W}
    No,                      !- Enable ASHRAE 55 Comfort Warnings
    ZoneAveraged;            !- Mean Radiant Temperature Calculation Type

  Lights,
    InternalGains_Lights ZoneList_AllZones,  !- Name
    ZoneList_AllZones,       !- Zone or ZoneList Name
    Schedule_Fraction_Office_LightsElEq,  !- Schedule Name
    Watts/Area,              !- Design Level Calculation Method
    ,                        !- Lighting Level {W}
    15.9,                    !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.00,                    !- Return Air Fraction
    0.20,                    !- Fraction Radiant
    0.20,                    !- Fraction Visible
    1.00,                    !- Fraction Replaceable
    General;                 !- End-Use Subcategory

  ElectricEquipment,
    InternalGains_ElEq ZoneList_AllZones,  !- Name
    ZoneList_AllZones,       !- Zone or ZoneList Name
    Schedule_Fraction_Office_LightsElEq,  !- Schedule Name
    Watts/Area,              !- Design Level Calculation Method
    ,                        !- Design Level {W}
    7.0,                     !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.00,                    !- Fraction Latent
    0.50,                    !- Fraction Radiant
    0.00,                    !- Fraction Lost
    General;                 !- End-Use Subcategory

  Output:PreprocessorMessage,
    CustomWarningGenerator,  !- Preprocessor Name
    Warning,                 !- Error Severity
    Fix constant coefficients macro. Discuss with Carina.;  !- Message Line 1

  ZoneInfiltration:DesignFlowRate,
    Infiltration ZoneList_AllZones,  !- Name
    ZoneList_AllZones,       !- Zone or ZoneList Name
    Schedule_Fraction_Always1,  !- Schedule Name
    AirChanges/Hour,         !- Design Flow Rate Calculation Method
    ,                        !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    0.072727285,             !- Air Changes per Hour {1/hr}
    0.606,                   !- Constant Term Coefficient
    0.03636,                 !- Temperature Term Coefficient
    0.1177,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

! SCHEDULES
! SYSTEM NODES: MFR AND TEMPERATURE
! ==== OUTPUT VARIABLES FOR BASIC ENERGY BALANCE ====
! INTERNAL GAINS

  Output:Variable,*,Zone People Sensible Heating Energy,TimeStep;

  Output:Variable,*,Zone Lights Total Heating Energy,TimeStep;

  Output:Variable,*,Zone Electric Equipment Radiant Heating Energy,TimeStep;

  Output:Variable,*,Zone Electric Equipment Convective Heating Energy,TimeStep;

! WINDOWS

  Output:Variable,*,Zone Windows Total Heat Gain Energy,TimeStep;

  Output:Variable,*,Zone Windows Total Heat Loss Energy,TimeStep;

! OPAQUE SURFACES {#OPA}

  Output:Variable,*,Zone Opaque Surface Inside Faces Total Conduction Heat Gain Energy,TimeStep;

  Output:Variable,*,Zone Opaque Surface Inside Faces Total Conduction Heat Loss Energy,TimeStep;

  Output:Diagnostics,
    DisplayAdvancedReportVariables;  !- Key 1

! INFILTRATION AND VENTILATION {#IV}

  Output:Variable,*,Zone Air Heat Balance Outdoor Air Transfer Rate,TimeStep;

! INFILTRATION AND VENTILATION - ALTERNATIVE {#IV}

  Output:Variable,*,Zone Infiltration Sensible Heat Loss Energy,TimeStep;

  Output:Variable,*,Zone Infiltration Sensible Heat Gain Energy,TimeStep;

  Output:Variable,*,Zone Ventilation Sensible Heat Loss Energy,TimeStep;

  Output:Variable,*,Zone Ventilation Sensible Heat Gain Energy,TimeStep;

! ENERGY STORED IN ZONE AIR {#AES}

  Output:Variable,*,Zone Air Heat Balance Air Energy Storage Rate,TimeStep;

    ! ZONE TEMPERATURES

  Output:Variable,*,Zone Mean Air Temperature,hourly;

  Output:Variable,*,Zone Mean Air Temperature,TimeStep;

    ! WEATHER

  Output:Variable,*,Site Outdoor Air Drybulb Temperature,hourly;

  Output:Variable,*,Site Outdoor Air Drybulb Temperature,TimeStep;

  Output:Variable,*,Site Wind Speed,hourly;

    ! TOTAL HEATING/COOLING ENERGY FOR WHOLE BUILDING (EMS)

  Output:Variable,*,All Zones Total Heating Energy {J},RunPeriod;

  Output:Variable,*,All Zones Total Cooling Energy {J},RunPeriod;

  Output:Variable,*,All Zones Total Heating Energy {J},monthly;

  Output:Variable,*,All Zones Total Cooling Energy {J},monthly;

    ! TOTAL HEATING/COOLING ENERGY FOR WHOLE BUILDING (FROM EMS)
    ! OUTPUTS FOR LOW TEMP RADIANT AKA. HEPTAPANEL

  Output:Variable,*,Zone Radiant HVAC Cooling Rate,hourly;

  Output:Variable,*,Zone Radiant HVAC Heating Rate,hourly;

  Output:Variable,*,Zone Radiant HVAC Cooling Rate,TimeStep;

  Output:Variable,*,Zone Radiant HVAC Heating Rate,TimeStep;

    ! OUTPUTS FOR DECENTRALIZED VENTILATION AKA. AIRBOX

  Output:Variable,*,Cooling Coil Total Cooling Rate,hourly;

  Output:Variable,*,Heating Coil Heating Rate,hourly;

  Output:Variable,*,Cooling Coil Total Cooling Rate,TimeStep;

  Output:Variable,*,Heating Coil Heating Rate,TimeStep;

  Output:Variable,*,Heating Coil U Factor Times Area Value,TimeStep;

    ! OUTPUT VARIABLES FOR CONVECTORS

  Output:Variable,*,Baseboard Total Heating Rate,hourly;

  Output:Variable,*,Baseboard Total Heating Energy,TimeStep;

  Output:Variable,*,Baseboard Total Heating Rate,TimeStep;

! =========== REPORTS / GENERAL OUTPUT / OUTPUT SETTINGS ===========

  Output:VariableDictionary,IDF,Name;

  Output:Surfaces:List,Details;

  Output:Surfaces:Drawing,DXF;

  Output:Constructions,Constructions,Materials;

  OutputControl:Table:Style,
    CommaAndHTML,            !- Column Separator
    JtokWh;                  !- Unit Conversion

  Output:Table:SummaryReports,
    AnnualBuildingUtilityPerformanceSummary,  !- Report 1 Name
    EnvelopeSummary,         !- Report 2 Name
    ZoneHeatingSummaryMonthly,  !- Report 3 Name
    ZoneCoolingSummaryMonthly,  !- Report 4 Name
    SetpointsNotMetWithTemperaturesMonthly,  !- Report 5 Name
    InputVerificationandResultsSummary,  !- Report 6 Name
    EquipmentSummary,        !- Report 7 Name
    HVACSizingSummary,       !- Report 8 Name
    WindowReportMonthly,     !- Report 9 Name
    WindowEnergyReportMonthly,  !- Report 10 Name
    WindowZoneSummaryMonthly,!- Report 11 Name
    WindowEnergyZoneSummaryMonthly,  !- Report 12 Name
    AverageOutdoorConditionsMonthly;  !- Report 13 Name

    ! SpaceGainComponentsAtCoolingPeakMonthly, OccupantComfortDataSummaryMonthly, ComfortReportSimple55Monthly ;

  EnergyManagementSystem:Sensor,
    Is_Heptapanel_ControlAvail,  !- Name
    Schedule_Availability_AlwaysOn,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

! ====================================================================================================
!
!   .... powered by
!
!            __                 ______        ______                     __      __
!           / /  ____ _      __/ ____/  __   /_  __/__  ____ ___  ____  / /___ _/ /____
!          / /  / __ \ | /| / / __/ | |/_/    / / / _ \/ __ `__ \/ __ \/ / __ `/ __/ _ \
!         / /___ /_/ / |/ |/ / /___ /  |     / / /  __/ / / / / / /_/ / / /_/ / /_/  __/
!        /_____\____/|__/|__/_____/_/|_|    /_/  \___/_/ /_/ /_/ .___/_/\__,_/\__/\___/
!                                                             /_/
!        Version 0.51, Christian Hersberger, SuAT, ETHZ, hersberger@arch.ethz.ch
!
!
! ====================================================================================================
! ====================================================================================================
! ===     HOT WATER LOOP (SCHEDULES SETPOINT MANAGERS, PUMP, BRANCHES, ...)
! ===
! ===     USED PARAMETER VALUES: HWLOOPDISTRICTHEATINGPOWER = 117300 {W}, HWLOOPMAXVOLUMEFLOWRATE = 8.88889E-3 {m3/s}, HWLOOPNUMBER = 1 { }, HWLOOPSUPPLYTEMPERATURE = 35 {C},
! ===         HWLOOPTEMPERATUREDIFFERENCE = 4 {C},
! ====================================================================================================
! ========= MISC. / EMS =========

  Sizing:Plant,
    PlantLoop_Hw1,           !- Plant or Condenser Loop Name
    Heating,                 !- Loop Type
    34,                      !- Design Loop Exit Temperature {C}
    3;                       !- Loop Design Temperature Difference {deltaC}

  EnergyManagementSystem:Sensor,
    Is_HeatingSeason,        !- Name
    Schedule_Availability_HwLoop1,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

! ========= SCHEDULES / SETPOINTMANAGERS =========

  Schedule:Compact,
    Schedule_Availability_HwLoop1,  !- Name
    Availability,            !- Schedule Type Limits Name
    Through: 4/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1,          !- Field 3
    Through: 9/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,0,          !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,1;          !- Field 11

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_HwSupply1,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_HwSupply1,  !- Schedule Name
    Node_HwSupply1Outlet_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Constant,Schedule_TemperatureSp_HwSupply1,Temperature,34;

! ========= PUMP & DISTRICT HEATING WITH BRANCH =========

  Pump:VariableSpeed,
    PumpVariableSpeed_HwSupply1,  !- Name
    Node_PumpVariableSpeed_HwSupply1_Inlet,  !- Inlet Node Name
    Node_PumpVariableSpeed_HwSupply1_Outlet,  !- Outlet Node Name
    autosize,                !- Rated Flow Rate {m3/s}
    179359.0,                !- Rated Pump Head {Pa}
    autosize,                !- Rated Power Consumption {W}
    0.9,                     !- Motor Efficiency
    0.0,                     !- Fraction of Motor Inefficiencies to Fluid Stream
    0.0,                     !- Coefficient 1 of the Part Load Performance Curve
    1.0,                     !- Coefficient 2 of the Part Load Performance Curve
    0.0,                     !- Coefficient 3 of the Part Load Performance Curve
    0.0,                     !- Coefficient 4 of the Part Load Performance Curve
    0.0,                     !- Minimum Flow Rate {m3/s}
    INTERMITTENT;            !- Pump Control Type

  Branch,
    Branch_PumpVariableSpeed_HwSupply1,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pump:VariableSpeed,      !- Component 1 Object Type
    PumpVariableSpeed_HwSupply1,  !- Component 1 Name
    Node_PumpVariableSpeed_HwSupply1_Inlet,  !- Component 1 Inlet Node Name
    Node_PumpVariableSpeed_HwSupply1_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  DistrictHeating,
    DistrictHeating_HwSupply1,  !- Name
    Node_DistrictHeating_HwSupply1Inlet,  !- Hot Water Inlet Node Name
    Node_DistrictHeating_HwSupply1Oulet,  !- Hot Water Outlet Node Name
    117300;                  !- Nominal Capacity {W}

  Branch,
    Branch_DistrictHeating_HwSupply1,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    DistrictHeating,         !- Component 1 Object Type
    DistrictHeating_HwSupply1,  !- Component 1 Name
    Node_DistrictHeating_HwSupply1Inlet,  !- Component 1 Inlet Node Name
    Node_DistrictHeating_HwSupply1Oulet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= PIPES AND BRANCHES =========
! HwSupply: Bypass & Outlet

  Pipe:Adiabatic,
    Pipe_HwSupply1Bypass,    !- Name
    Node_HwSupply1Bypass_Inlet,  !- Inlet Node Name
    Node_HwSupply1Bypass_Outlet;  !- Outlet Node Name

  Branch,
    Branch_HwSupply1Bypass,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_HwSupply1Bypass,    !- Component 1 Name
    Node_HwSupply1Bypass_Inlet,  !- Component 1 Inlet Node Name
    Node_HwSupply1Bypass_Outlet,  !- Component 1 Outlet Node Name
    Bypass;                  !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_HwSupply1Outlet,    !- Name
    Node_HwSupply1Outlet_Inlet,  !- Inlet Node Name
    Node_HwSupply1Outlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_HwSupply1Outlet,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_HwSupply1Outlet,    !- Component 1 Name
    Node_HwSupply1Outlet_Inlet,  !- Component 1 Inlet Node Name
    Node_HwSupply1Outlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

! HwDemand: Inlet & Bypass - Outlet

  Pipe:Adiabatic,
    Pipe_HwDemand1Inlet,     !- Name
    Node_HwDemand1Inlet_Inlet,  !- Inlet Node Name
    Node_HwDemand1Inlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_HwDemand1Inlet,   !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_HwDemand1Inlet,     !- Component 1 Name
    Node_HwDemand1Inlet_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand1Inlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_HwDemand1Bypass,    !- Name
    Node_HwDemand1Bypass_Inlet,  !- Inlet Node Name
    Node_HwDemand1Bypass_Outlet;  !- Outlet Node Name

  Branch,
    Branch_HwDemand1Bypass,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_HwDemand1Bypass,    !- Component 1 Name
    Node_HwDemand1Bypass_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand1Bypass_Outlet,  !- Component 1 Outlet Node Name
    Bypass;                  !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_HwDemand1Outlet,    !- Name
    Node_HwDemand1Outlet_Inlet,  !- Inlet Node Name
    Node_HwDemand1Outlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_HwDemand1Outlet,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_HwDemand1Outlet,    !- Component 1 Name
    Node_HwDemand1Outlet_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand1Outlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

! ========= BRANCHLISTS AND CONNECTORS =========
! HwSupply: Pump, DistrictHeating & Bypass, Outlet

  BranchList,
    BranchList_HwSupply1,    !- Name
    Branch_PumpVariableSpeed_HwSupply1,  !- Branch 1 Name
    Branch_DistrictHeating_HwSupply1,  !- Branch 2 Name
    Branch_HwSupply1Bypass,  !- Branch 3 Name
    Branch_HwSupply1Outlet;  !- Branch 4 Name

  Connector:Splitter,
    Splitter_HwSupply1,      !- Name
    Branch_PumpVariableSpeed_HwSupply1,  !- Inlet Branch Name
    Branch_DistrictHeating_HwSupply1,  !- Outlet Branch 1 Name
    Branch_HwSupply1Bypass;  !- Outlet Branch 2 Name

  Connector:Mixer,
    Mixer_HwSupply1,         !- Name
    Branch_HwSupply1Outlet,  !- Outlet Branch Name
    Branch_DistrictHeating_HwSupply1,  !- Inlet Branch 1 Name
    Branch_HwSupply1Bypass;  !- Inlet Branch 2 Name

  ConnectorList,
    ConnectorList_HwSupply1, !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Splitter_HwSupply1,      !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Mixer_HwSupply1;         !- Connector 2 Name

! HwDemand: Inlet, HeatingCoil & Bypass, Outlet

  BranchList,
    BranchList_HwDemand1,    !- Name
    Branch_HwDemand1Inlet,   !- Branch 1 Name
    Branch_HwDemand_WaterConvective_D_CORE,  !- Branch 2 Name
    Branch_HwDemand_WaterConvective_E_CORE_M,  !- Branch 3 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NE,  !- Branch 4 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Branch 5 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NW,  !- Branch 6 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Branch 7 Name
    Branch_HwDemand_WaterConvective_E_NW,  !- Branch 8 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SE,  !- Branch 9 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Branch 10 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SW,  !- Branch 11 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Branch 12 Name
    Branch_HwDemand_WaterConvective_E_SW,  !- Branch 13 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_W,  !- Branch 14 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Branch 15 Name
    Branch_HwDemand_WaterConvective_F_CORE,  !- Branch 16 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_E,  !- Branch 17 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Branch 18 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NE,  !- Branch 19 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Branch 20 Name
    Branch_HwDemand_WaterConvective_F_NE,  !- Branch 21 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NI,  !- Branch 22 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Branch 23 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SE,  !- Branch 24 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Branch 25 Name
    Branch_HwDemand_WaterConvective_F_SE,  !- Branch 26 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SI,  !- Branch 27 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Branch 28 Name
    Branch_HwDemand_WaterConvective_G_CORE,  !- Branch 29 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_E,  !- Branch 30 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Branch 31 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_N,  !- Branch 32 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Branch 33 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NE,  !- Branch 34 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Branch 35 Name
    Branch_HwDemand_WaterConvective_G_NE,  !- Branch 36 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NW,  !- Branch 37 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Branch 38 Name
    Branch_HwDemand_WaterConvective_G_NW,  !- Branch 39 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_S,  !- Branch 40 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Branch 41 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SE,  !- Branch 42 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Branch 43 Name
    Branch_HwDemand_WaterConvective_G_SE,  !- Branch 44 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SW,  !- Branch 45 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Branch 46 Name
    Branch_HwDemand_WaterConvective_G_SW,  !- Branch 47 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_W,  !- Branch 48 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Branch 49 Name
    Branch_HwDemand1Bypass,  !- Branch 50 Name
    Branch_HwDemand1Outlet;  !- Branch 51 Name

  Connector:Splitter,
    Splitter_HwDemand1,      !- Name
    Branch_HwDemand1Inlet,   !- Inlet Branch Name
    Branch_HwDemand_WaterConvective_D_CORE,  !- Outlet Branch 1 Name
    Branch_HwDemand_WaterConvective_E_CORE_M,  !- Outlet Branch 2 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NE,  !- Outlet Branch 3 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Outlet Branch 4 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NW,  !- Outlet Branch 5 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Outlet Branch 6 Name
    Branch_HwDemand_WaterConvective_E_NW,  !- Outlet Branch 7 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SE,  !- Outlet Branch 8 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Outlet Branch 9 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SW,  !- Outlet Branch 10 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Outlet Branch 11 Name
    Branch_HwDemand_WaterConvective_E_SW,  !- Outlet Branch 12 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_W,  !- Outlet Branch 13 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Outlet Branch 14 Name
    Branch_HwDemand_WaterConvective_F_CORE,  !- Outlet Branch 15 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_E,  !- Outlet Branch 16 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Outlet Branch 17 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NE,  !- Outlet Branch 18 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Outlet Branch 19 Name
    Branch_HwDemand_WaterConvective_F_NE,  !- Outlet Branch 20 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NI,  !- Outlet Branch 21 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Outlet Branch 22 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SE,  !- Outlet Branch 23 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Outlet Branch 24 Name
    Branch_HwDemand_WaterConvective_F_SE,  !- Outlet Branch 25 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SI,  !- Outlet Branch 26 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Outlet Branch 27 Name
    Branch_HwDemand_WaterConvective_G_CORE,  !- Outlet Branch 28 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_E,  !- Outlet Branch 29 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Outlet Branch 30 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_N,  !- Outlet Branch 31 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Outlet Branch 32 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NE,  !- Outlet Branch 33 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Outlet Branch 34 Name
    Branch_HwDemand_WaterConvective_G_NE,  !- Outlet Branch 35 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NW,  !- Outlet Branch 36 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Outlet Branch 37 Name
    Branch_HwDemand_WaterConvective_G_NW,  !- Outlet Branch 38 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_S,  !- Outlet Branch 39 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Outlet Branch 40 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SE,  !- Outlet Branch 41 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Outlet Branch 42 Name
    Branch_HwDemand_WaterConvective_G_SE,  !- Outlet Branch 43 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SW,  !- Outlet Branch 44 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Outlet Branch 45 Name
    Branch_HwDemand_WaterConvective_G_SW,  !- Outlet Branch 46 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_W,  !- Outlet Branch 47 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Outlet Branch 48 Name
    Branch_HwDemand1Bypass;  !- Outlet Branch 49 Name

  Connector:Mixer,
    Mixer_HwDemand1,         !- Name
    Branch_HwDemand1Outlet,  !- Outlet Branch Name
    Branch_HwDemand_WaterConvective_D_CORE,  !- Inlet Branch 1 Name
    Branch_HwDemand_WaterConvective_E_CORE_M,  !- Inlet Branch 2 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NE,  !- Inlet Branch 3 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Inlet Branch 4 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NW,  !- Inlet Branch 5 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Inlet Branch 6 Name
    Branch_HwDemand_WaterConvective_E_NW,  !- Inlet Branch 7 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SE,  !- Inlet Branch 8 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Inlet Branch 9 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SW,  !- Inlet Branch 10 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Inlet Branch 11 Name
    Branch_HwDemand_WaterConvective_E_SW,  !- Inlet Branch 12 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_E_W,  !- Inlet Branch 13 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Inlet Branch 14 Name
    Branch_HwDemand_WaterConvective_F_CORE,  !- Inlet Branch 15 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_E,  !- Inlet Branch 16 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Inlet Branch 17 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NE,  !- Inlet Branch 18 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Inlet Branch 19 Name
    Branch_HwDemand_WaterConvective_F_NE,  !- Inlet Branch 20 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NI,  !- Inlet Branch 21 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Inlet Branch 22 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SE,  !- Inlet Branch 23 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Inlet Branch 24 Name
    Branch_HwDemand_WaterConvective_F_SE,  !- Inlet Branch 25 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SI,  !- Inlet Branch 26 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Inlet Branch 27 Name
    Branch_HwDemand_WaterConvective_G_CORE,  !- Inlet Branch 28 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_E,  !- Inlet Branch 29 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Inlet Branch 30 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_N,  !- Inlet Branch 31 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Inlet Branch 32 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NE,  !- Inlet Branch 33 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Inlet Branch 34 Name
    Branch_HwDemand_WaterConvective_G_NE,  !- Inlet Branch 35 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NW,  !- Inlet Branch 36 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Inlet Branch 37 Name
    Branch_HwDemand_WaterConvective_G_NW,  !- Inlet Branch 38 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_S,  !- Inlet Branch 39 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Inlet Branch 40 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SE,  !- Inlet Branch 41 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Inlet Branch 42 Name
    Branch_HwDemand_WaterConvective_G_SE,  !- Inlet Branch 43 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SW,  !- Inlet Branch 44 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Inlet Branch 45 Name
    Branch_HwDemand_WaterConvective_G_SW,  !- Inlet Branch 46 Name
    Branch_HwDemand_WaterHeatingCoil_Abx_G_W,  !- Inlet Branch 47 Name
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Inlet Branch 48 Name
    Branch_HwDemand1Bypass;  !- Inlet Branch 49 Name

  ConnectorList,
    ConnectorList_HwDemand1, !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Splitter_HwDemand1,      !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Mixer_HwDemand1;         !- Connector 2 Name

! ========= PLANTLOOPS AND PLANTEQUIPMENTOPERATIONSCHEMES =========

  PlantLoop,
    PlantLoop_Hw1,           !- Name
    Water,                   !- Fluid Type
    ,                        !- User Defined Fluid Type
    PlantEquipmentOperationScheme_DistrictHeating_HwSupply1,  !- Plant Equipment Operation Scheme Name
    Node_HwSupply1Outlet_Outlet,  !- Loop Temperature Setpoint Node Name
    100,                     !- Maximum Loop Temperature {C}
    0,                       !- Minimum Loop Temperature {C}
    8.88889E-3,              !- Maximum Loop Flow Rate {m3/s}
    0.0,                     !- Minimum Loop Flow Rate {m3/s}
    autocalculate,           !- Plant Loop Volume {m3}
    Node_PumpVariableSpeed_HwSupply1_Inlet,  !- Plant Side Inlet Node Name
    Node_HwSupply1Outlet_Outlet,  !- Plant Side Outlet Node Name
    BranchList_HwSupply1,    !- Plant Side Branch List Name
    ConnectorList_HwSupply1, !- Plant Side Connector List Name
    Node_HwDemand1Inlet_Inlet,  !- Demand Side Inlet Node Name
    Node_HwDemand1Outlet_Outlet,  !- Demand Side Outlet Node Name
    BranchList_HwDemand1,    !- Demand Side Branch List Name
    ConnectorList_HwDemand1, !- Demand Side Connector List Name
    Optimal;                 !- Load Distribution Scheme

  PlantEquipmentOperationSchemes,
    PlantEquipmentOperationScheme_DistrictHeating_HwSupply1,  !- Name
    PlantEquipmentOperation:HeatingLoad,  !- Control Scheme 1 Object Type
    PlantEquipmentOperation_DistrictHeating_HwSupply1,  !- Control Scheme 1 Name
    Schedule_Availability_HwLoop1;  !- Control Scheme 1 Schedule Name

  PlantEquipmentOperation:HeatingLoad,
    PlantEquipmentOperation_DistrictHeating_HwSupply1,  !- Name
    0.0,                     !- Load Range 1 Lower Limit {W}
    10000000,                !- Load Range 1 Upper Limit {W}
    PlantEquipmentList_HwLoop1;  !- Range 1 Equipment List Name

  PlantEquipmentList,
    PlantEquipmentList_HwLoop1,  !- Name
    DistrictHeating,         !- Equipment 1 Object Type
    DistrictHeating_HwSupply1;  !- Equipment 1 Name

! ====================================================================================================
! ===     CHILLED WATER LOOP (SCHEDULES SETPOINT MANAGERS, PUMP, BRANCHES, ...)
! ===
! ===     USED PARAMETER VALUES: CWLOOPDISTRICTCOOLINGPOWER = 64000 {W}, CWLOOPMAXVOLUMEFLOWRATE = 7.72222E-3 {m3/s}, CWLOOPNUMBER = 1 { }, CWLOOPSUPPLYTEMPERATURE = 18 {C},
! ===         CWLOOPTEMPERATUREDIFFERENCE = 4 {C},
! ====================================================================================================
! ========= MISC. / EMS =========

  Sizing:Plant,
    PlantLoop_Cw1,           !- Plant or Condenser Loop Name
    Cooling,                 !- Loop Type
    18,                      !- Design Loop Exit Temperature {C}
    3;                       !- Loop Design Temperature Difference {deltaC}

  EnergyManagementSystem:Sensor,
    Is_CoolingSeason,        !- Name
    Schedule_Availability_CwLoop1,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

! ========= SCHEDULES / SETPOINTMANAGERS =========

  Schedule:Compact,
    Schedule_Availability_CwLoop1,  !- Name
    Availability,            !- Schedule Type Limits Name
    Through: 4/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,0,          !- Field 3
    Through: 9/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,1,          !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,0;          !- Field 11

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_CwSupply1,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_CwSupply1,  !- Schedule Name
    Node_CwSupply1Outlet_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Constant,Schedule_TemperatureSp_CwSupply1,Temperature,18;

! ========= PUMP & DISTRICT COOLING WITH BRANCH =========

  Pump:VariableSpeed,
    PumpVariableSpeed_CwSupply1,  !- Name
    Node_PumpVariableSpeed_CwSupply1_Inlet,  !- Inlet Node Name
    Node_PumpVariableSpeed_CwSupply1_Outlet,  !- Outlet Node Name
    autosize,                !- Rated Flow Rate {m3/s}
    179359.0,                !- Rated Pump Head {Pa}
    autosize,                !- Rated Power Consumption {W}
    0.9,                     !- Motor Efficiency
    0.0,                     !- Fraction of Motor Inefficiencies to Fluid Stream
    0.0,                     !- Coefficient 1 of the Part Load Performance Curve
    1.0,                     !- Coefficient 2 of the Part Load Performance Curve
    0.0,                     !- Coefficient 3 of the Part Load Performance Curve
    0.0,                     !- Coefficient 4 of the Part Load Performance Curve
    0.0,                     !- Minimum Flow Rate {m3/s}
    INTERMITTENT;            !- Pump Control Type

  Branch,
    Branch_PumpVariableSpeed_CwSupply1,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pump:VariableSpeed,      !- Component 1 Object Type
    PumpVariableSpeed_CwSupply1,  !- Component 1 Name
    Node_PumpVariableSpeed_CwSupply1_Inlet,  !- Component 1 Inlet Node Name
    Node_PumpVariableSpeed_CwSupply1_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  DistrictCooling,
    DistrictCooling_CwSupply1,  !- Name
    Node_DistrictCooling_CwSupply1Inlet,  !- Chilled Water Inlet Node Name
    Node_DistrictCooling_CwSupply1Outlet,  !- Chilled Water Outlet Node Name
    64000;                   !- Nominal Capacity {W}

  Branch,
    Branch_DistrictCooling_CwSupply1,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    DistrictCooling,         !- Component 1 Object Type
    DistrictCooling_CwSupply1,  !- Component 1 Name
    Node_DistrictCooling_CwSupply1Inlet,  !- Component 1 Inlet Node Name
    Node_DistrictCooling_CwSupply1Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= PIPES AND BRANCHES =========
! CwSupply: Bypass & Outlet

  Pipe:Adiabatic,
    Pipe_CwSupply1Bypass,    !- Name
    Node_CwSupply1Bypass_Inlet,  !- Inlet Node Name
    Node_CwSupply1Bypass_Outlet;  !- Outlet Node Name

  Branch,
    Branch_CwSupply1Bypass,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_CwSupply1Bypass,    !- Component 1 Name
    Node_CwSupply1Bypass_Inlet,  !- Component 1 Inlet Node Name
    Node_CwSupply1Bypass_Outlet,  !- Component 1 Outlet Node Name
    Bypass;                  !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_CwSupply1Outlet,    !- Name
    Node_CwSupply1Outlet_Inlet,  !- Inlet Node Name
    Node_CwSupply1Outlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_CwSupply1Outlet,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_CwSupply1Outlet,    !- Component 1 Name
    Node_CwSupply1Outlet_Inlet,  !- Component 1 Inlet Node Name
    Node_CwSupply1Outlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

! CwDemand: Inlet & Bypass - Outlet

  Pipe:Adiabatic,
    Pipe_CwDemand1Inlet,     !- Name
    Node_CwDemand1Inlet_Inlet,  !- Inlet Node Name
    Node_CwDemand1Inlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_CwDemand1Inlet,   !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_CwDemand1Inlet,     !- Component 1 Name
    Node_CwDemand1Inlet_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand1Inlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_CwDemand1Bypass,    !- Name
    Node_CwDemand1Bypass_Inlet,  !- Inlet Node Name
    Node_CwDemand1Bypass_Outlet;  !- Outlet Node Name

  Branch,
    Branch_CwDemand1Bypass,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_CwDemand1Bypass,    !- Component 1 Name
    Node_CwDemand1Bypass_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand1Bypass_Outlet,  !- Component 1 Outlet Node Name
    Bypass;                  !- Component 1 Branch Control Type

  Pipe:Adiabatic,
    Pipe_CwDemand1Outlet,    !- Name
    Node_CwDemand1Outlet_Inlet,  !- Inlet Node Name
    Node_CwDemand1Outlet_Outlet;  !- Outlet Node Name

  Branch,
    Branch_CwDemand1Outlet,  !- Name
    autosize,                !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Pipe_CwDemand1Outlet,    !- Component 1 Name
    Node_CwDemand1Outlet_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand1Outlet_Outlet,  !- Component 1 Outlet Node Name
    Passive;                 !- Component 1 Branch Control Type

! ========= BRANCHLISTS AND CONNECTORS =========
! CwSupply: Pump, DistrictCooling & Bypass, Outlet

  BranchList,
    BranchList_CwSupply1,    !- Name
    Branch_PumpVariableSpeed_CwSupply1,  !- Branch 1 Name
    Branch_DistrictCooling_CwSupply1,  !- Branch 2 Name
    Branch_CwSupply1Bypass,  !- Branch 3 Name
    Branch_CwSupply1Outlet;  !- Branch 4 Name

  Connector:Splitter,
    Splitter_CwSupply1,      !- Name
    Branch_PumpVariableSpeed_CwSupply1,  !- Inlet Branch Name
    Branch_DistrictCooling_CwSupply1,  !- Outlet Branch 1 Name
    Branch_CwSupply1Bypass;  !- Outlet Branch 2 Name

  Connector:Mixer,
    Mixer_CwSupply1,         !- Name
    Branch_CwSupply1Outlet,  !- Outlet Branch Name
    Branch_DistrictCooling_CwSupply1,  !- Inlet Branch 1 Name
    Branch_CwSupply1Bypass;  !- Inlet Branch 2 Name

  ConnectorList,
    ConnectorList_CwSupply1, !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Splitter_CwSupply1,      !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Mixer_CwSupply1;         !- Connector 2 Name

! CwDemand: Inlet, CoolingCoil & Bypass, Outlet

  BranchList,
    BranchList_CwDemand1,    !- Name
    Branch_CwDemand1Inlet,   !- Branch 1 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NE,  !- Branch 2 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Branch 3 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NW,  !- Branch 4 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Branch 5 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SE,  !- Branch 6 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Branch 7 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SW,  !- Branch 8 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Branch 9 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_W,  !- Branch 10 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Branch 11 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_E,  !- Branch 12 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Branch 13 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NE,  !- Branch 14 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Branch 15 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NI,  !- Branch 16 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Branch 17 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SE,  !- Branch 18 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Branch 19 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SI,  !- Branch 20 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Branch 21 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_E,  !- Branch 22 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Branch 23 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_N,  !- Branch 24 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Branch 25 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NE,  !- Branch 26 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Branch 27 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NW,  !- Branch 28 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Branch 29 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_S,  !- Branch 30 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Branch 31 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SE,  !- Branch 32 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Branch 33 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SW,  !- Branch 34 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Branch 35 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_W,  !- Branch 36 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Branch 37 Name
    Branch_CwDemand1Bypass,  !- Branch 38 Name
    Branch_CwDemand1Outlet;  !- Branch 39 Name

  Connector:Splitter,
    Splitter_CwDemand1,      !- Name
    Branch_CwDemand1Inlet,   !- Inlet Branch Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NE,  !- Outlet Branch 1 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Outlet Branch 2 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NW,  !- Outlet Branch 3 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Outlet Branch 4 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SE,  !- Outlet Branch 5 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Outlet Branch 6 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SW,  !- Outlet Branch 7 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Outlet Branch 8 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_W,  !- Outlet Branch 9 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Outlet Branch 10 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_E,  !- Outlet Branch 11 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Outlet Branch 12 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NE,  !- Outlet Branch 13 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Outlet Branch 14 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NI,  !- Outlet Branch 15 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Outlet Branch 16 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SE,  !- Outlet Branch 17 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Outlet Branch 18 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SI,  !- Outlet Branch 19 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Outlet Branch 20 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_E,  !- Outlet Branch 21 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Outlet Branch 22 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_N,  !- Outlet Branch 23 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Outlet Branch 24 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NE,  !- Outlet Branch 25 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Outlet Branch 26 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NW,  !- Outlet Branch 27 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Outlet Branch 28 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_S,  !- Outlet Branch 29 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Outlet Branch 30 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SE,  !- Outlet Branch 31 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Outlet Branch 32 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SW,  !- Outlet Branch 33 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Outlet Branch 34 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_W,  !- Outlet Branch 35 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Outlet Branch 36 Name
    Branch_CwDemand1Bypass;  !- Outlet Branch 37 Name

  Connector:Mixer,
    Mixer_CwDemand1,         !- Name
    Branch_CwDemand1Outlet,  !- Outlet Branch Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NE,  !- Inlet Branch 1 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Inlet Branch 2 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NW,  !- Inlet Branch 3 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Inlet Branch 4 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SE,  !- Inlet Branch 5 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Inlet Branch 6 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SW,  !- Inlet Branch 7 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Inlet Branch 8 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_E_W,  !- Inlet Branch 9 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Inlet Branch 10 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_E,  !- Inlet Branch 11 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Inlet Branch 12 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NE,  !- Inlet Branch 13 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Inlet Branch 14 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NI,  !- Inlet Branch 15 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Inlet Branch 16 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SE,  !- Inlet Branch 17 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Inlet Branch 18 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SI,  !- Inlet Branch 19 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Inlet Branch 20 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_E,  !- Inlet Branch 21 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Inlet Branch 22 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_N,  !- Inlet Branch 23 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Inlet Branch 24 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NE,  !- Inlet Branch 25 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Inlet Branch 26 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NW,  !- Inlet Branch 27 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Inlet Branch 28 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_S,  !- Inlet Branch 29 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Inlet Branch 30 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SE,  !- Inlet Branch 31 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Inlet Branch 32 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SW,  !- Inlet Branch 33 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Inlet Branch 34 Name
    Branch_CwDemand_WaterCoolingCoil_Abx_G_W,  !- Inlet Branch 35 Name
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Inlet Branch 36 Name
    Branch_CwDemand1Bypass;  !- Inlet Branch 37 Name

  ConnectorList,
    ConnectorList_CwDemand1, !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Splitter_CwDemand1,      !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Mixer_CwDemand1;         !- Connector 2 Name

! ========= PLANTLOOPS AND PLANTEQUIPMENTOPERATIONSCHEMES =========

  PlantLoop,
    PlantLoop_Cw1,           !- Name
    Water,                   !- Fluid Type
    ,                        !- User Defined Fluid Type
    PlantEquipmentOperationScheme_DistrictCooling_CwSupply1,  !- Plant Equipment Operation Scheme Name
    Node_CwSupply1Outlet_Outlet,  !- Loop Temperature Setpoint Node Name
    100,                     !- Maximum Loop Temperature {C}
    0,                       !- Minimum Loop Temperature {C}
    7.72222E-3,              !- Maximum Loop Flow Rate {m3/s}
    0.0,                     !- Minimum Loop Flow Rate {m3/s}
    autocalculate,           !- Plant Loop Volume {m3}
    Node_PumpVariableSpeed_CwSupply1_Inlet,  !- Plant Side Inlet Node Name
    Node_CwSupply1Outlet_Outlet,  !- Plant Side Outlet Node Name
    BranchList_CwSupply1,    !- Plant Side Branch List Name
    ConnectorList_CwSupply1, !- Plant Side Connector List Name
    Node_CwDemand1Inlet_Inlet,  !- Demand Side Inlet Node Name
    Node_CwDemand1Outlet_Outlet,  !- Demand Side Outlet Node Name
    BranchList_CwDemand1,    !- Demand Side Branch List Name
    ConnectorList_CwDemand1, !- Demand Side Connector List Name
    Optimal;                 !- Load Distribution Scheme

  PlantEquipmentOperationSchemes,
    PlantEquipmentOperationScheme_DistrictCooling_CwSupply1,  !- Name
    PlantEquipmentOperation:CoolingLoad,  !- Control Scheme 1 Object Type
    PlantEquipmentOperation_DistrictCooling_CwSupply1,  !- Control Scheme 1 Name
    Schedule_Availability_CwLoop1;  !- Control Scheme 1 Schedule Name

  PlantEquipmentOperation:CoolingLoad,
    PlantEquipmentOperation_DistrictCooling_CwSupply1,  !- Name
    0.0,                     !- Load Range 1 Lower Limit {W}
    10000000,                !- Load Range 1 Upper Limit {W}
    PlantEquipmentList_CwLoop1;  !- Range 1 Equipment List Name

  PlantEquipmentList,
    PlantEquipmentList_CwLoop1,  !- Name
    DistrictCooling,         !- Equipment 1 Object Type
    DistrictCooling_CwSupply1;  !- Equipment 1 Name

  EnergyManagementSystem:Sensor,
    Is_Airbox_AirMFR_ControlAvail,  !- Name
    Schedule_Availability_AlwaysOn,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Airbox_TempSP_ControlAvail,  !- Name
    Schedule_Availability_AlwaysOn,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

! =======================================
! ========= HEPTAPANEL SETTINGS =========
! =======================================
! ============================================
! ========= GENERAL HEPTAPANEL STUFF =========
! ============================================
! ============================================
! ========= HEPTAPANEL SIZING MACROS =========
! ============================================
! ========================================
! ========= HEPTAPANEL EMS STUFF =========
! ========================================
! Surface Convection Coefficient Standard Value = 1.5 {W/m2-K} and Actuator to Override it
! EMSFROMHEPTAPANELGEOMETRIES, DEFAULTSURFACECONVCOEFF,

  SurfaceProperty:ConvectionCoefficients,
    Roof G_SE Hepta,         !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_S Hepta,          !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_SW Hepta,         !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_W Hepta,          !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_NW Hepta,         !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_N Hepta,          !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_NE Hepta,         !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Roof G_E Hepta,          !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_SE.1 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_SE.2 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_SW Hepta,      !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_W.1 Hepta,     !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_W.2 Hepta,     !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_NW Hepta,      !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling E_NE Hepta,      !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_SE Hepta,      !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_SI.1 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_SI.2 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_SI.3 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_NI.1 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_NI.2 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_NI.3 Hepta,    !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_NE Hepta,      !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_E.1 Hepta,     !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_E.2 Hepta,     !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

  SurfaceProperty:ConvectionCoefficients,
    Ceiling F_E.3 Hepta,     !- Surface Name
    Inside,                  !- Convection Coefficient 1 Location
    Value,                   !- Convection Coefficient 1 Type
    1.5,                     !- Convection Coefficient 1 {W/m2-K}
    ,                        !- Convection Coefficient 1 Schedule Name
    ;                        !- Convection Coefficient 1 User Curve Name

! EMSFROMHEPTAPANELGEOMETRIES, SETSURFACECONVCOEFFACTUATOR,

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_SE,  !- Name
    Roof G_SE Hepta,         !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_S,!- Name
    Roof G_S Hepta,          !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_SW,  !- Name
    Roof G_SW Hepta,         !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_W,!- Name
    Roof G_W Hepta,          !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_NW,  !- Name
    Roof G_NW Hepta,         !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_N,!- Name
    Roof G_N Hepta,          !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_NE,  !- Name
    Roof G_NE Hepta,         !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Roof_G_E,!- Name
    Roof G_E Hepta,          !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_SE_1,  !- Name
    Ceiling E_SE.1 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_SE_2,  !- Name
    Ceiling E_SE.2 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_SW,  !- Name
    Ceiling E_SW Hepta,      !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_W_1,  !- Name
    Ceiling E_W.1 Hepta,     !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_W_2,  !- Name
    Ceiling E_W.2 Hepta,     !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_NW,  !- Name
    Ceiling E_NW Hepta,      !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_E_NE,  !- Name
    Ceiling E_NE Hepta,      !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_SE,  !- Name
    Ceiling F_SE Hepta,      !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_SI_1,  !- Name
    Ceiling F_SI.1 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_SI_2,  !- Name
    Ceiling F_SI.2 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_SI_3,  !- Name
    Ceiling F_SI.3 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_NI_1,  !- Name
    Ceiling F_NI.1 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_NI_2,  !- Name
    Ceiling F_NI.2 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_NI_3,  !- Name
    Ceiling F_NI.3 Hepta,    !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_NE,  !- Name
    Ceiling F_NE Hepta,      !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_E_1,  !- Name
    Ceiling F_E.1 Hepta,     !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_E_2,  !- Name
    Ceiling F_E.2 Hepta,     !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    ConvCoeff_Hepta_Ceiling_F_E_3,  !- Name
    Ceiling F_E.3 Hepta,     !- Actuated Component Unique Name
    Surface,                 !- Actuated Component Type
    Interior Surface Convection Heat Transfer Coefficient;  !- Actuated Component Control Type

! EMSFROMHEPTAPANELGEOMETRIES, SURFACECONVCOEFEMSOUTPUTVARIABLE,

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_SE : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_SE,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_S : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_S,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_SW : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_SW,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_W : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_W,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_NW : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_NW,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_N : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_N,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_NE : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_NE,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Roof G_E : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Roof_G_E,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_SE.1 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_SE_1,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_SE.2 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_SE_2,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_SW : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_SW,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_W.1 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_W_1,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_W.2 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_W_2,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_NW : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_NW,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling E_NE : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_E_NE,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_SE : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_SE,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_SI.1 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_SI_1,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_SI.2 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_SI_2,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_SI.3 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_SI_3,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_NI.1 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_NI_1,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_NI.2 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_NI_2,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_NI.3 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_NI_3,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_NE : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_NE,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_E.1 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_E_1,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_E.2 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_E_2,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_Ceiling F_E.3 : Convection Coefficient (W/m2 K),  !- Name
    ConvCoeff_Hepta_Ceiling_F_E_3,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! =================================================================================
! ===
! ===     EMS
! ===
! =================================================================================
! ========= GENERAL =========

  Output:EnergyManagementSystem,
    Verbose,                 !- Actuator Availability Dictionary Reporting
    Verbose,                 !- Internal Variable Availability Dictionary Reporting
    ErrorsOnly;              !- EMS Runtime Language Debug Output Level

! ========= GENERAL EMS =========

  EnergyManagementSystem:Sensor,
    t_ODB,                   !- Name
    Environment,             !- Output:Variable or Output:Meter Index Key Name
    Site Outdoor Air Drybulb Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:TrendVariable,
    t_ODB_Trend,             !- Name
    t_ODB,                   !- EMS Variable Name
    40;                      !- Number of Timesteps to be Logged

! ========= PROGRAMCALLINGMANAGERS =========

  EnergyManagementSystem:ProgramCallingManager,
    PCM_Init_HeptaAbx_RunPeriodAvg,  !- Name
    AfterNewEnvironmentWarmUpIsComplete,  !- EnergyPlus Model Calling Point
    Init_Hepta_RunPeriodAvg, !- Program Name 1
    Init_Abx_RunPeriodAvg,   !- Program Name 2
    Init_Convector_RunPeriodAvg;  !- Program Name 3

  EnergyManagementSystem:ProgramCallingManager,
    PCM_AirboxHeptapanel_Control,  !- Name
    BeginTimestepBeforePredictor,  !- EnergyPlus Model Calling Point
    Set_Heptapanel_MassFlowRates,  !- Program Name 1
    Set_Airbox_MassFlowRates,!- Program Name 2
    Set_Heptapanel_ConvCoefficients;  !- Program Name 3

  EnergyManagementSystem:ProgramCallingManager,
    PCM_Calc_Ext_Output_Vars,!- Name
    EndOfSystemTimestepBeforeHVACReporting,  !- EnergyPlus Model Calling Point
    Calc_Heptapanel_Temperature_Differences,  !- Program Name 1
    Calc_Airbox_Temperature_Differences,  !- Program Name 2
    Calc_Convector_Temperature_Differences,  !- Program Name 3
    Calc_Per_Zone_Energy_Totals,  !- Program Name 4
    Calc_Building_Energy_Totals;  !- Program Name 5

! ========= TOTAL HEATING / COOLING ENERGY FOR ALL ZONES =========

  EnergyManagementSystem:GlobalVariable,
    Total_Heating_Energy;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    Total_Cooling_Energy;    !- Erl Variable 1 Name

! ========= EMS PROGRAMS (THAT CALL PER-ZONE SUBROUTINES) =========

  EnergyManagementSystem:Program,
    Init_Hepta_RunPeriodAvg, !- Name
    Run Init_Hepta_E_NE_RunPeriodAvg,  !- Program Line 1
    Run Init_Hepta_E_NW_RunPeriodAvg,  !- Program Line 2
    Run Init_Hepta_E_SE_RunPeriodAvg,  !- <none>
    Run Init_Hepta_E_SW_RunPeriodAvg,  !- <none>
    Run Init_Hepta_E_W_RunPeriodAvg,  !- <none>
    Run Init_Hepta_F_E_RunPeriodAvg,  !- <none>
    Run Init_Hepta_F_NE_RunPeriodAvg,  !- <none>
    Run Init_Hepta_F_NI_RunPeriodAvg,  !- <none>
    Run Init_Hepta_F_SE_RunPeriodAvg,  !- <none>
    Run Init_Hepta_F_SI_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_E_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_N_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_NE_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_NW_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_S_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_SE_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_SW_RunPeriodAvg,  !- <none>
    Run Init_Hepta_G_W_RunPeriodAvg;  !- <none>

  EnergyManagementSystem:Program,
    Init_Abx_RunPeriodAvg,   !- Name
    Run Init_Abx_E_NE_RunPeriodAvg,  !- Program Line 1
    Run Init_Abx_E_NW_RunPeriodAvg,  !- Program Line 2
    Run Init_Abx_E_SE_RunPeriodAvg,  !- <none>
    Run Init_Abx_E_SW_RunPeriodAvg,  !- <none>
    Run Init_Abx_E_W_RunPeriodAvg,  !- <none>
    Run Init_Abx_F_E_RunPeriodAvg,  !- <none>
    Run Init_Abx_F_NE_RunPeriodAvg,  !- <none>
    Run Init_Abx_F_NI_RunPeriodAvg,  !- <none>
    Run Init_Abx_F_SE_RunPeriodAvg,  !- <none>
    Run Init_Abx_F_SI_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_E_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_N_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_NE_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_NW_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_S_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_SE_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_SW_RunPeriodAvg,  !- <none>
    Run Init_Abx_G_W_RunPeriodAvg;  !- <none>

  EnergyManagementSystem:Program,
    Init_Convector_RunPeriodAvg,  !- Name
    Run Init_Conv_D_CORE_RunPeriodAvg,  !- Program Line 1
    Run Init_Conv_E_CORE_M_RunPeriodAvg,  !- Program Line 2
    Run Init_Conv_E_NW_RunPeriodAvg,  !- <none>
    Run Init_Conv_E_SW_RunPeriodAvg,  !- <none>
    Run Init_Conv_F_CORE_RunPeriodAvg,  !- <none>
    Run Init_Conv_F_NE_RunPeriodAvg,  !- <none>
    Run Init_Conv_F_SE_RunPeriodAvg,  !- <none>
    Run Init_Conv_G_CORE_RunPeriodAvg,  !- <none>
    Run Init_Conv_G_NE_RunPeriodAvg,  !- <none>
    Run Init_Conv_G_NW_RunPeriodAvg,  !- <none>
    Run Init_Conv_G_SE_RunPeriodAvg,  !- <none>
    Run Init_Conv_G_SW_RunPeriodAvg;  !- <none>

  EnergyManagementSystem:Program,
    Init_Heptapanel_MassFlowRates,  !- Name
    Run Init_MFR_Hepta_E_NE, !- Program Line 1
    Run Init_MFR_Hepta_E_NW, !- Program Line 2
    Run Init_MFR_Hepta_E_SE, !- <none>
    Run Init_MFR_Hepta_E_SW, !- <none>
    Run Init_MFR_Hepta_E_W,  !- <none>
    Run Init_MFR_Hepta_F_E,  !- <none>
    Run Init_MFR_Hepta_F_NE, !- <none>
    Run Init_MFR_Hepta_F_NI, !- <none>
    Run Init_MFR_Hepta_F_SE, !- <none>
    Run Init_MFR_Hepta_F_SI, !- <none>
    Run Init_MFR_Hepta_G_E,  !- <none>
    Run Init_MFR_Hepta_G_N,  !- <none>
    Run Init_MFR_Hepta_G_NE, !- <none>
    Run Init_MFR_Hepta_G_NW, !- <none>
    Run Init_MFR_Hepta_G_S,  !- <none>
    Run Init_MFR_Hepta_G_SE, !- <none>
    Run Init_MFR_Hepta_G_SW, !- <none>
    Run Init_MFR_Hepta_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Set_Heptapanel_MassFlowRates,  !- Name
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_E_NE,  !- Program Line 1
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_E_NW,  !- Program Line 2
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_E_SE,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_E_SW,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_E_W,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_F_E,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_F_NE,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_F_NI,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_F_SE,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_F_SI,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_E,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_N,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_NE,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_NW,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_S,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_SE,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_SW,  !- <none>
    Run Set_MFR_LowTempRadiantVarFlow_Hepta_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Set_Airbox_MassFlowRates,!- Name
    Run Set_MFR_AirboxAbx_E_NE,  !- Program Line 1
    Run Set_MFR_AirboxAbx_E_NW,  !- Program Line 2
    Run Set_MFR_AirboxAbx_E_SE,  !- <none>
    Run Set_MFR_AirboxAbx_E_SW,  !- <none>
    Run Set_MFR_AirboxAbx_E_W,  !- <none>
    Run Set_MFR_AirboxAbx_F_E,  !- <none>
    Run Set_MFR_AirboxAbx_F_NE,  !- <none>
    Run Set_MFR_AirboxAbx_F_NI,  !- <none>
    Run Set_MFR_AirboxAbx_F_SE,  !- <none>
    Run Set_MFR_AirboxAbx_F_SI,  !- <none>
    Run Set_MFR_AirboxAbx_G_E,  !- <none>
    Run Set_MFR_AirboxAbx_G_N,  !- <none>
    Run Set_MFR_AirboxAbx_G_NE,  !- <none>
    Run Set_MFR_AirboxAbx_G_NW,  !- <none>
    Run Set_MFR_AirboxAbx_G_S,  !- <none>
    Run Set_MFR_AirboxAbx_G_SE,  !- <none>
    Run Set_MFR_AirboxAbx_G_SW,  !- <none>
    Run Set_MFR_AirboxAbx_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Set_Heptapanel_ConvCoefficients,  !- Name
    Run SetConvCoeff_Hepta_E_NE,  !- Program Line 1
    Run SetConvCoeff_Hepta_E_NW,  !- Program Line 2
    Run SetConvCoeff_Hepta_E_SE,  !- <none>
    Run SetConvCoeff_Hepta_E_SW,  !- <none>
    Run SetConvCoeff_Hepta_E_W,  !- <none>
    Run SetConvCoeff_Hepta_F_E,  !- <none>
    Run SetConvCoeff_Hepta_F_NE,  !- <none>
    Run SetConvCoeff_Hepta_F_NI,  !- <none>
    Run SetConvCoeff_Hepta_F_SE,  !- <none>
    Run SetConvCoeff_Hepta_F_SI,  !- <none>
    Run SetConvCoeff_Hepta_G_E,  !- <none>
    Run SetConvCoeff_Hepta_G_N,  !- <none>
    Run SetConvCoeff_Hepta_G_NE,  !- <none>
    Run SetConvCoeff_Hepta_G_NW,  !- <none>
    Run SetConvCoeff_Hepta_G_S,  !- <none>
    Run SetConvCoeff_Hepta_G_SE,  !- <none>
    Run SetConvCoeff_Hepta_G_SW,  !- <none>
    Run SetConvCoeff_Hepta_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Set_Airbox_TemperatureSetpoints,  !- Name
    Run Set_TempSP_Abx_E_NE, !- Program Line 1
    Run Set_TempSP_Abx_E_NW, !- Program Line 2
    Run Set_TempSP_Abx_E_SE, !- <none>
    Run Set_TempSP_Abx_E_SW, !- <none>
    Run Set_TempSP_Abx_E_W,  !- <none>
    Run Set_TempSP_Abx_F_E,  !- <none>
    Run Set_TempSP_Abx_F_NE, !- <none>
    Run Set_TempSP_Abx_F_NI, !- <none>
    Run Set_TempSP_Abx_F_SE, !- <none>
    Run Set_TempSP_Abx_F_SI, !- <none>
    Run Set_TempSP_Abx_G_E,  !- <none>
    Run Set_TempSP_Abx_G_N,  !- <none>
    Run Set_TempSP_Abx_G_NE, !- <none>
    Run Set_TempSP_Abx_G_NW, !- <none>
    Run Set_TempSP_Abx_G_S,  !- <none>
    Run Set_TempSP_Abx_G_SE, !- <none>
    Run Set_TempSP_Abx_G_SW, !- <none>
    Run Set_TempSP_Abx_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Calc_Heptapanel_Temperature_Differences,  !- Name
    Run Calc_Hepta_E_NE_TempDiff,  !- Program Line 1
    Run Calc_Hepta_E_NW_TempDiff,  !- Program Line 2
    Run Calc_Hepta_E_SE_TempDiff,  !- <none>
    Run Calc_Hepta_E_SW_TempDiff,  !- <none>
    Run Calc_Hepta_E_W_TempDiff,  !- <none>
    Run Calc_Hepta_F_E_TempDiff,  !- <none>
    Run Calc_Hepta_F_NE_TempDiff,  !- <none>
    Run Calc_Hepta_F_NI_TempDiff,  !- <none>
    Run Calc_Hepta_F_SE_TempDiff,  !- <none>
    Run Calc_Hepta_F_SI_TempDiff,  !- <none>
    Run Calc_Hepta_G_E_TempDiff,  !- <none>
    Run Calc_Hepta_G_N_TempDiff,  !- <none>
    Run Calc_Hepta_G_NE_TempDiff,  !- <none>
    Run Calc_Hepta_G_NW_TempDiff,  !- <none>
    Run Calc_Hepta_G_S_TempDiff,  !- <none>
    Run Calc_Hepta_G_SE_TempDiff,  !- <none>
    Run Calc_Hepta_G_SW_TempDiff,  !- <none>
    Run Calc_Hepta_G_W_TempDiff;  !- <none>

  EnergyManagementSystem:Program,
    Calc_Airbox_Temperature_Differences,  !- Name
    Run Calc_Abx_E_NE_TempDiff,  !- Program Line 1
    Run Calc_Abx_E_NW_TempDiff,  !- Program Line 2
    Run Calc_Abx_E_SE_TempDiff,  !- <none>
    Run Calc_Abx_E_SW_TempDiff,  !- <none>
    Run Calc_Abx_E_W_TempDiff,  !- <none>
    Run Calc_Abx_F_E_TempDiff,  !- <none>
    Run Calc_Abx_F_NE_TempDiff,  !- <none>
    Run Calc_Abx_F_NI_TempDiff,  !- <none>
    Run Calc_Abx_F_SE_TempDiff,  !- <none>
    Run Calc_Abx_F_SI_TempDiff,  !- <none>
    Run Calc_Abx_G_E_TempDiff,  !- <none>
    Run Calc_Abx_G_N_TempDiff,  !- <none>
    Run Calc_Abx_G_NE_TempDiff,  !- <none>
    Run Calc_Abx_G_NW_TempDiff,  !- <none>
    Run Calc_Abx_G_S_TempDiff,  !- <none>
    Run Calc_Abx_G_SE_TempDiff,  !- <none>
    Run Calc_Abx_G_SW_TempDiff,  !- <none>
    Run Calc_Abx_G_W_TempDiff;  !- <none>

  EnergyManagementSystem:Program,
    Calc_Convector_Temperature_Differences,  !- Name
    Run Calc_Conv_D_CORE_TempDiff,  !- Program Line 1
    Run Calc_Conv_E_CORE_M_TempDiff,  !- Program Line 2
    Run Calc_Conv_E_NW_TempDiff,  !- <none>
    Run Calc_Conv_E_SW_TempDiff,  !- <none>
    Run Calc_Conv_F_CORE_TempDiff,  !- <none>
    Run Calc_Conv_F_NE_TempDiff,  !- <none>
    Run Calc_Conv_F_SE_TempDiff,  !- <none>
    Run Calc_Conv_G_CORE_TempDiff,  !- <none>
    Run Calc_Conv_G_NE_TempDiff,  !- <none>
    Run Calc_Conv_G_NW_TempDiff,  !- <none>
    Run Calc_Conv_G_SE_TempDiff,  !- <none>
    Run Calc_Conv_G_SW_TempDiff;  !- <none>

  EnergyManagementSystem:Program,
    Calc_Per_Zone_Energy_Totals,  !- Name
    Run Calc_HeatingEnergy_Zone_D_CORE,  !- Program Line 1
    Run Calc_CoolingEnergy_Zone_D_CORE,  !- Program Line 2
    Run Calc_HeatingEnergy_Zone_E_CORE_M,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_CORE_M,  !- <none>
    Run Calc_HeatingEnergy_Zone_E_NE,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_NE,  !- <none>
    Run Calc_HeatingEnergy_Zone_E_NW,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_NW,  !- <none>
    Run Calc_HeatingEnergy_Zone_E_SE,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_SE,  !- <none>
    Run Calc_HeatingEnergy_Zone_E_SW,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_SW,  !- <none>
    Run Calc_HeatingEnergy_Zone_E_W,  !- <none>
    Run Calc_CoolingEnergy_Zone_E_W,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_CORE,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_CORE,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_E,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_E,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_NE,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_NE,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_NI,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_NI,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_SE,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_SE,  !- <none>
    Run Calc_HeatingEnergy_Zone_F_SI,  !- <none>
    Run Calc_CoolingEnergy_Zone_F_SI,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_CORE,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_CORE,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_E,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_E,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_N,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_N,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_NE,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_NE,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_NW,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_NW,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_S,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_S,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_SE,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_SE,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_SW,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_SW,  !- <none>
    Run Calc_HeatingEnergy_Zone_G_W,  !- <none>
    Run Calc_CoolingEnergy_Zone_G_W;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_Total_Heating_Energy,  !- Name
    Set Total_Heating_Energy = 0,  !- Program Line 1
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_D_CORE,  !- Program Line 2
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_CORE_M,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_NE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_NW,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_SE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_SW,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_E_W,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_CORE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_E,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_NE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_NI,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_SE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_F_SI,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_CORE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_E,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_N,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_NE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_NW,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_S,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_SE,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_SW,  !- <none>
    Set Total_Heating_Energy = Total_Heating_Energy + Heating_Energy_Zone_G_W;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_Total_Cooling_Energy,  !- Name
    Set Total_Cooling_Energy = 0,  !- Program Line 1
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_D_CORE,  !- Program Line 2
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_CORE_M,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_NE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_NW,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_SE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_SW,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_E_W,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_CORE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_E,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_NE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_NI,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_SE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_F_SI,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_CORE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_E,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_N,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_NE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_NW,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_S,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_SE,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_SW,  !- <none>
    Set Total_Cooling_Energy = Total_Cooling_Energy + Cooling_Energy_Zone_G_W;  !- <none>

  EnergyManagementSystem:Program,
    Calc_Building_Energy_Totals,  !- Name
    Run Calc_Total_Heating_Energy,  !- Program Line 1
    Run Calc_Total_Cooling_Energy;  !- Program Line 2

! ====================================================================================================
! ===     GENERAL Zone_D_CORE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = D_CORE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_D_CORE,  !- Name
    Zone_D_CORE,             !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_D_CORE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_D_CORE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_D_CORE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_D_CORE,  !- Name
    Schedule_TemperatureMinimum_Zone_D_CORE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_D_CORE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_D_CORE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_D_CORE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_D_CORE,  !- Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 1 Object Type
    WaterConvective_D_CORE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1;                       !- Zone Equipment 1 Heating or No-Load Sequence

  ZoneHVAC:EquipmentConnections,
    Zone_D_CORE,             !- Zone Name
    ZoneHvacEquipmentList_D_CORE,  !- Zone Conditioning Equipment List Name
    ,                        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_D_CORE, !- Zone Air Node Name
    AirNode_D_CORE_Outlet;   !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE D_CORE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_D_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_D_CORE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_D_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_D_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_D_CORE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_D_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_D_CORE,  !- Name
    Set Heating_Energy_Zone_D_CORE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_D_CORE = Heating_Energy_Zone_D_CORE + Q_Heating_WaterConvective_D_CORE;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_D_CORE,  !- Name
    Set Cooling_Energy_Zone_D_CORE = 0;  !- Program Line 1

! ====================================================================================================
! ===     CONVECTOR D_CORE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 4962 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = D_CORE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_D_CORE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_D_CORE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_D_CORE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    396.959991455,           !- U-Factor Times Area Value {W/K}
    0.39569379E-03,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_D_CORE,  !- Name
    0.39569379E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_D_CORE,  !- Component 1 Name
    Node_HwDemand_WaterConvective_D_CORE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_D_CORE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_D_CORE,  !- Name
    WaterConvective_D_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_D_CORE,    !- Name
    WaterConvective_D_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_D_CORE,   !- Name
    WaterConvective_D_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_D_CORE, !- Name
    WaterConvective_D_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_D_CORE,!- Name
    WaterConvective_D_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_D_CORE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_D_CORE;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_D_CORE;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_D_CORE: dT(HWater) {K},  !- Name
    dT_HW_Conv_D_CORE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_D_CORE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_D_CORE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_D_CORE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_D_CORE,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_D_CORE_TempDiff,  !- Name
    Set dT_HW_Conv_D_CORE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_D_CORE = 0,  !- Program Line 2
    Set dT_HWA_Conv_D_CORE   = 0,  !- <none>
    Set dT_HW_Conv_D_CORE    = t_NodeIn_Conv_D_CORE - t_NodeOut_Conv_D_CORE,  !- <none>
    IF (dT_HW_Conv_D_CORE > 0),  !- <none>
    Set t_AvgAir_Conv_D_CORE = t_AirNodeOut_Conv_D_CORE + t_AirNodeIn_Conv_D_CORE,  !- <none>
    Set t_AvgAir_Conv_D_CORE = t_AvgAir_Conv_D_CORE / 2,  !- <none>
    Set dT_HWA_Conv_D_CORE = t_NodeOut_Conv_D_CORE + t_NodeIn_Conv_D_CORE,  !- <none>
    Set dT_HWA_Conv_D_CORE = dT_HWA_Conv_D_CORE / 2,  !- <none>
    Set dT_HWA_Conv_D_CORE = dT_HWA_Conv_D_CORE - t_AvgAir_Conv_D_CORE,  !- <none>
    Set dT_HW_Conv_D_CORE_Num = dT_HW_Conv_D_CORE_Num + 1,  !- <none>
    Set dT_HW_Conv_D_CORE_Sum = dT_HW_Conv_D_CORE_Sum + dT_HW_Conv_D_CORE,  !- <none>
    Set dT_HW_Conv_D_CORE_Avg = dT_HW_Conv_D_CORE_Sum / dT_HW_Conv_D_CORE_Num,  !- <none>
    Set dT_HWA_Conv_D_CORE_Num = dT_HWA_Conv_D_CORE_Num + 1,  !- <none>
    Set dT_HWA_Conv_D_CORE_Sum = dT_HWA_Conv_D_CORE_Sum + dT_HWA_Conv_D_CORE,  !- <none>
    Set dT_HWA_Conv_D_CORE_Avg = dT_HWA_Conv_D_CORE_Sum / dT_HWA_Conv_D_CORE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_D_CORE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_D_CORE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_D_CORE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_D_CORE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_D_CORE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_D_CORE_Num = 0,  !- <none>
    Set dT_HWA_Conv_D_CORE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_D_CORE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_D_CORE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_D_CORE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_D_CORE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_D_CORE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_D_CORE_Sum;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_D_CORE_Num;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_D_CORE_Avg;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_D_CORE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_D_CORE_Avg,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_E_CORE_M
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_CORE_M { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_CORE_M,  !- Name
    Zone_E_CORE_M,           !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_CORE_M,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_CORE_M;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_CORE_M,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_CORE_M,  !- Name
    Schedule_TemperatureMinimum_Zone_E_CORE_M,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_CORE_M;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_CORE_M,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_CORE_M,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_CORE_M,  !- Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 1 Object Type
    WaterConvective_E_CORE_M,!- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1;                       !- Zone Equipment 1 Heating or No-Load Sequence

  ZoneHVAC:EquipmentConnections,
    Zone_E_CORE_M,           !- Zone Name
    ZoneHvacEquipmentList_E_CORE_M,  !- Zone Conditioning Equipment List Name
    ,                        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_CORE_M,  !- Zone Air Node Name
    AirNode_E_CORE_M_Outlet; !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_CORE_M =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_CORE_M;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_CORE_M Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_CORE_M,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_CORE_M;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_CORE_M Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_CORE_M,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_CORE_M,  !- Name
    Set Heating_Energy_Zone_E_CORE_M = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_CORE_M = Heating_Energy_Zone_E_CORE_M + Q_Heating_WaterConvective_E_CORE_M;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_CORE_M,  !- Name
    Set Cooling_Energy_Zone_E_CORE_M = 0;  !- Program Line 1

! ====================================================================================================
! ===     CONVECTOR E_CORE_M
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 1554 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_CORE_M { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_E_CORE_M,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_E_CORE_M_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_E_CORE_M_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    124.319999695,           !- U-Factor Times Area Value {W/K}
    0.12392344E-03,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_E_CORE_M,  !- Name
    0.12392344E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_E_CORE_M,!- Component 1 Name
    Node_HwDemand_WaterConvective_E_CORE_M_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_E_CORE_M_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_E_CORE_M,  !- Name
    WaterConvective_E_CORE_M,!- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_E_CORE_M,  !- Name
    WaterConvective_E_CORE_M,!- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_E_CORE_M, !- Name
    WaterConvective_E_CORE_M,!- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_E_CORE_M,  !- Name
    WaterConvective_E_CORE_M,!- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_E_CORE_M,  !- Name
    WaterConvective_E_CORE_M,!- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_CORE_M;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_CORE_M;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_E_CORE_M;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_CORE_M: dT(HWater) {K},  !- Name
    dT_HW_Conv_E_CORE_M,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_CORE_M: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_E_CORE_M,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_CORE_M: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_E_CORE_M,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_E_CORE_M_TempDiff,  !- Name
    Set dT_HW_Conv_E_CORE_M    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_E_CORE_M = 0,  !- Program Line 2
    Set dT_HWA_Conv_E_CORE_M   = 0,  !- <none>
    Set dT_HW_Conv_E_CORE_M    = t_NodeIn_Conv_E_CORE_M - t_NodeOut_Conv_E_CORE_M,  !- <none>
    IF (dT_HW_Conv_E_CORE_M > 0),  !- <none>
    Set t_AvgAir_Conv_E_CORE_M = t_AirNodeOut_Conv_E_CORE_M + t_AirNodeIn_Conv_E_CORE_M,  !- <none>
    Set t_AvgAir_Conv_E_CORE_M = t_AvgAir_Conv_E_CORE_M / 2,  !- <none>
    Set dT_HWA_Conv_E_CORE_M = t_NodeOut_Conv_E_CORE_M + t_NodeIn_Conv_E_CORE_M,  !- <none>
    Set dT_HWA_Conv_E_CORE_M = dT_HWA_Conv_E_CORE_M / 2,  !- <none>
    Set dT_HWA_Conv_E_CORE_M = dT_HWA_Conv_E_CORE_M - t_AvgAir_Conv_E_CORE_M,  !- <none>
    Set dT_HW_Conv_E_CORE_M_Num = dT_HW_Conv_E_CORE_M_Num + 1,  !- <none>
    Set dT_HW_Conv_E_CORE_M_Sum = dT_HW_Conv_E_CORE_M_Sum + dT_HW_Conv_E_CORE_M,  !- <none>
    Set dT_HW_Conv_E_CORE_M_Avg = dT_HW_Conv_E_CORE_M_Sum / dT_HW_Conv_E_CORE_M_Num,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Num = dT_HWA_Conv_E_CORE_M_Num + 1,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Sum = dT_HWA_Conv_E_CORE_M_Sum + dT_HWA_Conv_E_CORE_M,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Avg = dT_HWA_Conv_E_CORE_M_Sum / dT_HWA_Conv_E_CORE_M_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_E_CORE_M_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_E_CORE_M_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_E_CORE_M_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_E_CORE_M_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Sum = 0,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Num = 0,  !- <none>
    Set dT_HWA_Conv_E_CORE_M_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_CORE_M_Sum; !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_CORE_M_Num; !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_CORE_M_Avg; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_CORE_M: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_E_CORE_M_Avg, !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_CORE_M_Sum;!- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_CORE_M_Num;!- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_CORE_M_Avg;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_CORE_M: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_E_CORE_M_Avg,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_E_NE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_NE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_NE,  !- Name
    Zone_E_NE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_NE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_NE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_NE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_NE,  !- Name
    Schedule_TemperatureMinimum_Zone_E_NE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_NE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_NE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_NE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_NE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_E_NE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 3 Object Type
    ElectricConvective_E_NE, !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3;                       !- Zone Equipment 3 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_E_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_E_NE,               !- Zone Name
    ZoneHvacEquipmentList_E_NE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_E_NE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_NE,   !- Zone Air Node Name
    AirNode_E_NE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_NE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_NE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_NE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_NE,  !- Name
    Set Heating_Energy_Zone_E_NE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_NE = Heating_Energy_Zone_E_NE + Q_Heating_Abx_E_NE,  !- Program Line 2
    Set Heating_Energy_Zone_E_NE = Heating_Energy_Zone_E_NE + Q_Heating_Hepta_E_NE,  !- <none>
    Set Heating_Energy_Zone_E_NE = Heating_Energy_Zone_E_NE + Q_Heating_RecircAbx_E_NE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_NE,  !- Name
    Set Cooling_Energy_Zone_E_NE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_E_NE = Cooling_Energy_Zone_E_NE + Q_Cooling_Abx_E_NE,  !- Program Line 2
    Set Cooling_Energy_Zone_E_NE = Cooling_Energy_Zone_E_NE + Q_Cooling_Hepta_E_NE;  !- <none>

! ====================================================================================================
! ===     AIRBOX E_NE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = E_NE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_E_NE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_E_NE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_E_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_E_NE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_E_NE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_E_NE,  !- Name
    Schedule_Availability_Abx_E_NE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_E_NE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_E_NE,  !- Name
    Schedule_Availability_Abx_E_NE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_E_NE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_E_NE_FanAvail,    !- Name
    Schedule_Availability_Abx_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_E_NE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_E_NE_Fan,        !- Name
    FanVariableVolume_Abx_E_NE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_E_NE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_E_NE_Fan = 0,!- Program Line 2
    IF (Is_Abx_E_NE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_E_NE > 0.1),  !- <none>
    Set MFR_Abx_E_NE_Fan =    0.104500003 * rho_Abx_E_NE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_NE_Fan =    0.071133330 * rho_Abx_E_NE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_NE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_E_NE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_E_NE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_E_NE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_E_NE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_E_NE_SupplyAir = t_Abx_E_NE_WaterSupply - t_Abx_E_NE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_E_NE_SupplyAir = 0.794871807 * TempSP_Abx_E_NE_SupplyAir,  !- <none>
    Set TempSP_Abx_E_NE_SupplyAir = t_Abx_E_NE_OutdoorAir + TempSP_Abx_E_NE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_E_NE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_E_NE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NE,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_E_NE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_E_NE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_E_NE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NE,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_E_NE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_E_NE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_NE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_E_NE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_E_NE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_E_NE, !- Name
    AirBranch_Abx_E_NE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_E_NE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_E_NE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_E_NE,!- Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_E_NE,  !- Name
    ControllerList_Abx_E_NE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_E_NE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_E_NE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_E_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_NE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_E_NE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_E_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_E_NE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_E_NE,  !- Name
    Schedule_Availability_Abx_E_NE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NE_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_E_NE,        !- Name
    ControllerList_Abx_E_NE_Coils,  !- Controller List Name
    AvailabilityList_Abx_E_NE,  !- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_E_NE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_E_NE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_E_NE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_E_NE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_E_NE,      !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_E_NE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_E_NE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_E_NE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_E_NE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_E_NE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_E_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_NE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_E_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_NE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_E_NE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_E_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_NE_Outlet,  !- Outlet Node Name
    AirNode_E_NE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_E_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_NE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_E_NE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_NE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_NE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_E_NE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_E_NE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_E_NE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_E_NE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_E_NE,    !- Name
    AirNode_OutdoorAirMixer_Abx_E_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_E_NE,   !- Name
    AirNode_WaterCoolingCoil_Abx_E_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_E_NE,        !- Name
    AirNode_FanVariableVolume_Abx_E_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_E_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(HWater) {K},!- Name
    dT_HW_Abx_E_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(CWater) {K},!- Name
    dT_CW_Abx_E_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_E_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_E_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_E_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_E_NE_TempDiff,  !- Name
    Set dT_HW_Abx_E_NE  = 0, !- Program Line 1
    Set dT_CW_Abx_E_NE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_E_NE = 0,  !- <none>
    Set dT_HWA_Abx_E_NE  = 0,!- <none>
    Set dT_CWA_Abx_E_NE = 0, !- <none>
    IF (MFR_Air_Abx_E_NE > 0),  !- <none>
    Set t_AvgAir_Abx_E_NE = t_AirNodeOut_Abx_E_NE + t_AirNodeIn_Abx_E_NE,  !- <none>
    Set t_AvgAir_Abx_E_NE = t_AvgAir_Abx_E_NE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_E_NE = t_NodeIn_AbxHC_E_NE - t_NodeOut_AbxHC_E_NE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_E_NE = t_NodeOut_AbxCC_E_NE - t_NodeIn_AbxCC_E_NE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_E_NE <> 0),!- <none>
    IF (dT_HW_Abx_E_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_E_NE = t_NodeOut_AbxHC_E_NE + t_NodeIn_AbxHC_E_NE,  !- <none>
    Set dT_HWA_Abx_E_NE = dT_HWA_Abx_E_NE / 2,  !- <none>
    Set dT_HWA_Abx_E_NE = dT_HWA_Abx_E_NE - t_AvgAir_Abx_E_NE,  !- <none>
    Set dT_HW_Abx_E_NE_Num = dT_HW_Abx_E_NE_Num + 1,  !- <none>
    Set dT_HW_Abx_E_NE_Sum = dT_HW_Abx_E_NE_Sum + dT_HW_Abx_E_NE,  !- <none>
    Set dT_HW_Abx_E_NE_Avg = dT_HW_Abx_E_NE_Sum / dT_HW_Abx_E_NE_Num,  !- <none>
    Set dT_HWA_Abx_E_NE_Num = dT_HWA_Abx_E_NE_Num + 1,  !- <none>
    Set dT_HWA_Abx_E_NE_Sum = dT_HWA_Abx_E_NE_Sum + dT_HWA_Abx_E_NE,  !- <none>
    Set dT_HWA_Abx_E_NE_Avg = dT_HWA_Abx_E_NE_Sum / dT_HWA_Abx_E_NE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_E_NE <> 0),  !- <none>
    IF (dT_CW_Abx_E_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_E_NE = t_NodeIn_AbxCC_E_NE + t_NodeOut_AbxCC_E_NE,  !- <none>
    Set dT_CWA_Abx_E_NE = dT_CWA_Abx_E_NE / 2,  !- <none>
    Set dT_CWA_Abx_E_NE = dT_CWA_Abx_E_NE - t_AvgAir_Abx_E_NE,  !- <none>
    Set dT_CW_Abx_E_NE_Num = dT_CW_Abx_E_NE_Num + 1,  !- <none>
    Set dT_CW_Abx_E_NE_Sum = dT_CW_Abx_E_NE_Sum + dT_CW_Abx_E_NE,  !- <none>
    Set dT_CW_Abx_E_NE_Avg = dT_CW_Abx_E_NE_Sum / dT_CW_Abx_E_NE_Num,  !- <none>
    Set dT_CWA_Abx_E_NE_Num = dT_CWA_Abx_E_NE_Num + 1,  !- <none>
    Set dT_CWA_Abx_E_NE_Sum = dT_CWA_Abx_E_NE_Sum + dT_CWA_Abx_E_NE,  !- <none>
    Set dT_CWA_Abx_E_NE_Avg = dT_CWA_Abx_E_NE_Sum / dT_CWA_Abx_E_NE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_E_NE,      !- Name
    WaterHeatingCoil_Abx_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_E_NE,      !- Name
    WaterCoolingCoil_Abx_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_E_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_E_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_E_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_E_NE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_E_NE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_E_NE_Num  = 0,  !- <none>
    Set dT_CW_Abx_E_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_E_NE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_E_NE_Num = 0,  !- <none>
    Set dT_HWA_Abx_E_NE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_E_NE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_E_NE_Num = 0,  !- <none>
    Set dT_CWA_Abx_E_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_E_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_E_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_E_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_E_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL E_NE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling E_NE Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1254 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 2412 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_NE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_E_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_E_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_E_NE,  !- Name
    Ceiling E_NE Hepta,      !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_E_NE,               !- Zone Name
    LowTempRadiantSurfaceGroup_E_NE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.14425836E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_E_NE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.75000011E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_E_NE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Name
    0.14425836E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE,  !- Name
    0.75000011E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_E_NE,     !- Name
    AirNode_ZoneNode_E_NE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_E_NE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_E_NE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_E_NE,          !- Name
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_E_NE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_NE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_E_NE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_NE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_E_NE < t_Sp_Heating_Hepta_E_NE + 0.07 ),  !- <none>
    Set MFR_Hepta_E_NE =   0.144258380,  !- <none>
    ELSEIF (t_AirNode_Zone_E_NE > t_Sp_Cooling_Hepta_E_NE - 0.07 ),  !- <none>
    Set MFR_Hepta_E_NE =   0.075000003,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_E_NE,     !- Name
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_E_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_E_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_E_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(Water) {K},  !- Name
    dT_W_Hepta_E_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_E_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_E_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_E_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_E_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_E_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_E_NE_TempDiff,!- Name
    Set dT_W_Hepta_E_NE  = 0,!- Program Line 1
    Set dT_HW_Hepta_E_NE = 0,!- Program Line 2
    Set dT_CW_Hepta_E_NE = 0,!- <none>
    Set dT_WA_Hepta_E_NE  = 0,  !- <none>
    Set dT_HWA_Hepta_E_NE = 0,  !- <none>
    Set dT_CWA_Hepta_E_NE = 0,  !- <none>
    Set dT_W_Hepta_E_NE    = (t_NodeIn_Hepta_E_NE - t_NodeOut_Hepta_E_NE),  !- <none>
    Set dT_WA_Hepta_E_NE = (t_NodeIn_Hepta_E_NE + t_NodeOut_Hepta_E_NE) / 2,  !- <none>
    Set dT_WA_Hepta_E_NE = dT_WA_Hepta_E_NE - t_AirNode_Zone_E_NE,  !- <none>
    IF (dT_W_Hepta_E_NE > 0),!- <none>
    Set dT_HW_Hepta_E_NE    = dT_W_Hepta_E_NE,  !- <none>
    Set dT_HWA_Hepta_E_NE = dT_WA_Hepta_E_NE,  !- <none>
    Set dT_HW_Hepta_E_NE_Num = dT_HW_Hepta_E_NE_Num + 1,  !- <none>
    Set dT_HW_Hepta_E_NE_Sum = dT_HW_Hepta_E_NE_Sum + dT_HW_Hepta_E_NE,  !- <none>
    Set dT_HW_Hepta_E_NE_Avg = dT_HW_Hepta_E_NE_Sum / dT_HW_Hepta_E_NE_Num,  !- <none>
    Set dT_HWA_Hepta_E_NE_Num = dT_HWA_Hepta_E_NE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_E_NE_Sum = dT_HWA_Hepta_E_NE_Sum + dT_HWA_Hepta_E_NE,  !- <none>
    Set dT_HWA_Hepta_E_NE_Avg = dT_HWA_Hepta_E_NE_Sum / dT_HWA_Hepta_E_NE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_E_NE < 0),  !- <none>
    Set dT_CW_Hepta_E_NE    = 0.0 - dT_W_Hepta_E_NE,  !- <none>
    Set dT_CWA_Hepta_E_NE = 0.0 - dT_WA_Hepta_E_NE,  !- <none>
    Set dT_CW_Hepta_E_NE_Num = dT_CW_Hepta_E_NE_Num + 1,  !- <none>
    Set dT_CW_Hepta_E_NE_Sum = dT_CW_Hepta_E_NE_Sum + dT_CW_Hepta_E_NE,  !- <none>
    Set dT_CW_Hepta_E_NE_Avg = dT_CW_Hepta_E_NE_Sum / dT_CW_Hepta_E_NE_Num,  !- <none>
    Set dT_CWA_Hepta_E_NE_Num = dT_CWA_Hepta_E_NE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_E_NE_Sum = dT_CWA_Hepta_E_NE_Sum + dT_CWA_Hepta_E_NE,  !- <none>
    Set dT_CWA_Hepta_E_NE_Avg = dT_CWA_Hepta_E_NE_Sum / dT_CWA_Hepta_E_NE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_E_NE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_E_NE, !- Name
    Run InitConvCoeff_Sf_Zone_E_NE,  !- Program Line 1
    IF (dT_W_Hepta_E_NE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_E_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_NE = (6.12 + (0.18 * (dT_HWA_Hepta_E_NE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_NE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_E_NE < 0),  !- <none>
    IF (dT_CWA_Hepta_E_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_NE = 6.12 + (2.76 * (dT_CWA_Hepta_E_NE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_NE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_E_NE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_NE  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_E_NE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_NE  = ConvCoeffToSet_Hepta_E_NE;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_E_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_E_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_E_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_E_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_E_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_E_NE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_E_NE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_E_NE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_E_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_E_NE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_E_NE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_E_NE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_E_NE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_E_NE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_E_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_E_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_E_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_E_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_E_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX E_NE
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 3 {-}, ZONENAME = E_NE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_E_NE, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    1395,                    !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_E_NE,!- Name
    ElectricConvective_E_NE, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_E_NW
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_NW { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_NW,  !- Name
    Zone_E_NW,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_NW,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_NW;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_NW,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_NW,  !- Name
    Schedule_TemperatureMinimum_Zone_E_NW,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_NW;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_NW,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_NW,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_NW,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_E_NW,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_E_NW,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3;                       !- Zone Equipment 3 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_E_NW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NW_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_E_NW,               !- Zone Name
    ZoneHvacEquipmentList_E_NW,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_E_NW,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_NW,   !- Zone Air Node Name
    AirNode_E_NW_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_NW =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_NW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_NW Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_NW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_NW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_NW Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_NW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_NW,  !- Name
    Set Heating_Energy_Zone_E_NW = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_NW = Heating_Energy_Zone_E_NW + Q_Heating_Abx_E_NW,  !- Program Line 2
    Set Heating_Energy_Zone_E_NW = Heating_Energy_Zone_E_NW + Q_Heating_Hepta_E_NW,  !- <none>
    Set Heating_Energy_Zone_E_NW = Heating_Energy_Zone_E_NW + Q_Heating_WaterConvective_E_NW;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_NW,  !- Name
    Set Cooling_Energy_Zone_E_NW = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_E_NW = Cooling_Energy_Zone_E_NW + Q_Cooling_Abx_E_NW,  !- Program Line 2
    Set Cooling_Energy_Zone_E_NW = Cooling_Energy_Zone_E_NW + Q_Cooling_Hepta_E_NW;  !- <none>

! ====================================================================================================
! ===     AIRBOX E_NW
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 2 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = E_NW { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_E_NW,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_E_NW,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_E_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_E_NW,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_E_NW;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_E_NW,  !- Name
    Schedule_Availability_Abx_E_NW;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_E_NW,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_E_NW,  !- Name
    Schedule_Availability_Abx_E_NW,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.052250002,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.035566665,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_E_NW,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_E_NW_FanAvail,    !- Name
    Schedule_Availability_Abx_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_E_NW_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_E_NW_Fan,        !- Name
    FanVariableVolume_Abx_E_NW,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_E_NW,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_E_NW_Fan = 0,!- Program Line 2
    IF (Is_Abx_E_NW_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_E_NW > 0.1),  !- <none>
    Set MFR_Abx_E_NW_Fan =    0.052250002 * rho_Abx_E_NW_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_NW_Fan =    0.035566665 * rho_Abx_E_NW_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_NW_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_E_NW_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_E_NW_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_E_NW_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_E_NW,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_E_NW_SupplyAir = t_Abx_E_NW_WaterSupply - t_Abx_E_NW_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_E_NW_SupplyAir = 0.794871807 * TempSP_Abx_E_NW_SupplyAir,  !- <none>
    Set TempSP_Abx_E_NW_SupplyAir = t_Abx_E_NW_OutdoorAir + TempSP_Abx_E_NW_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_E_NW_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_E_NW,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    82.720001221,            !- U-Factor Times Area Value {W/K}
    0.74960124E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    1880,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_E_NW,  !- Name
    0.74960124E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_E_NW,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_E_NW,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.74960124E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_E_NW,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.53827753E-04,          !- Design Water Flow Rate {m3/s}
    0.055555556,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_E_NW,  !- Name
    0.80741615E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_E_NW,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_E_NW,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.80741615E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_NW_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_E_NW,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_E_NW;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_E_NW, !- Name
    AirBranch_Abx_E_NW;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_E_NW,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_E_NW;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_E_NW,!- Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_E_NW,  !- Name
    ControllerList_Abx_E_NW_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_E_NW,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_E_NW;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_E_NW,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_OutdoorInlet,  !- Actuator Node Name
    0.035566665,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.052250002,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_NW_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_E_NW;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_E_NW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NW_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_E_NW;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_E_NW,  !- Name
    Schedule_Availability_Abx_E_NW,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NW_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NW_Inlet,  !- Air Inlet Node Name
    0.052250002,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.035566665;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_E_NW,        !- Name
    ControllerList_Abx_E_NW_Coils,  !- Controller List Name
    AvailabilityList_Abx_E_NW,  !- Availability Manager List Name
    0.052250002,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_E_NW, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_E_NW_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_E_NW_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_E_NW_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_E_NW,      !- Name
    0.052250002,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_E_NW,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_E_NW_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_E_NW,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_E_NW,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_E_NW,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_E_NW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_NW_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_NW_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_E_NW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_NW_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_E_NW;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_E_NW,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_NW_Outlet,  !- Outlet Node Name
    AirNode_E_NW_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_E_NW,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_NW_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_E_NW;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_NW,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_NW_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_NW;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_E_NW,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_E_NW,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_E_NW,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_E_NW,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_E_NW,    !- Name
    AirNode_OutdoorAirMixer_Abx_E_NW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_E_NW,   !- Name
    AirNode_WaterCoolingCoil_Abx_E_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_E_NW,        !- Name
    AirNode_FanVariableVolume_Abx_E_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_E_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(HWater) {K},!- Name
    dT_HW_Abx_E_NW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(CWater) {K},!- Name
    dT_CW_Abx_E_NW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_E_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_E_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_E_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_E_NW_TempDiff,  !- Name
    Set dT_HW_Abx_E_NW  = 0, !- Program Line 1
    Set dT_CW_Abx_E_NW = 0,  !- Program Line 2
    Set t_AvgAir_Abx_E_NW = 0,  !- <none>
    Set dT_HWA_Abx_E_NW  = 0,!- <none>
    Set dT_CWA_Abx_E_NW = 0, !- <none>
    IF (MFR_Air_Abx_E_NW > 0),  !- <none>
    Set t_AvgAir_Abx_E_NW = t_AirNodeOut_Abx_E_NW + t_AirNodeIn_Abx_E_NW,  !- <none>
    Set t_AvgAir_Abx_E_NW = t_AvgAir_Abx_E_NW / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_E_NW = t_NodeIn_AbxHC_E_NW - t_NodeOut_AbxHC_E_NW,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_E_NW = t_NodeOut_AbxCC_E_NW - t_NodeIn_AbxCC_E_NW,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_E_NW <> 0),!- <none>
    IF (dT_HW_Abx_E_NW < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_E_NW = t_NodeOut_AbxHC_E_NW + t_NodeIn_AbxHC_E_NW,  !- <none>
    Set dT_HWA_Abx_E_NW = dT_HWA_Abx_E_NW / 2,  !- <none>
    Set dT_HWA_Abx_E_NW = dT_HWA_Abx_E_NW - t_AvgAir_Abx_E_NW,  !- <none>
    Set dT_HW_Abx_E_NW_Num = dT_HW_Abx_E_NW_Num + 1,  !- <none>
    Set dT_HW_Abx_E_NW_Sum = dT_HW_Abx_E_NW_Sum + dT_HW_Abx_E_NW,  !- <none>
    Set dT_HW_Abx_E_NW_Avg = dT_HW_Abx_E_NW_Sum / dT_HW_Abx_E_NW_Num,  !- <none>
    Set dT_HWA_Abx_E_NW_Num = dT_HWA_Abx_E_NW_Num + 1,  !- <none>
    Set dT_HWA_Abx_E_NW_Sum = dT_HWA_Abx_E_NW_Sum + dT_HWA_Abx_E_NW,  !- <none>
    Set dT_HWA_Abx_E_NW_Avg = dT_HWA_Abx_E_NW_Sum / dT_HWA_Abx_E_NW_Num,  !- <none>
    ELSEIF (dT_CW_Abx_E_NW <> 0),  !- <none>
    IF (dT_CW_Abx_E_NW < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_E_NW = t_NodeIn_AbxCC_E_NW + t_NodeOut_AbxCC_E_NW,  !- <none>
    Set dT_CWA_Abx_E_NW = dT_CWA_Abx_E_NW / 2,  !- <none>
    Set dT_CWA_Abx_E_NW = dT_CWA_Abx_E_NW - t_AvgAir_Abx_E_NW,  !- <none>
    Set dT_CW_Abx_E_NW_Num = dT_CW_Abx_E_NW_Num + 1,  !- <none>
    Set dT_CW_Abx_E_NW_Sum = dT_CW_Abx_E_NW_Sum + dT_CW_Abx_E_NW,  !- <none>
    Set dT_CW_Abx_E_NW_Avg = dT_CW_Abx_E_NW_Sum / dT_CW_Abx_E_NW_Num,  !- <none>
    Set dT_CWA_Abx_E_NW_Num = dT_CWA_Abx_E_NW_Num + 1,  !- <none>
    Set dT_CWA_Abx_E_NW_Sum = dT_CWA_Abx_E_NW_Sum + dT_CWA_Abx_E_NW,  !- <none>
    Set dT_CWA_Abx_E_NW_Avg = dT_CWA_Abx_E_NW_Sum / dT_CWA_Abx_E_NW_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_E_NW,      !- Name
    WaterHeatingCoil_Abx_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_E_NW,      !- Name
    WaterCoolingCoil_Abx_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_E_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_E_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_E_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_E_NW_Avg  = 0,  !- <none>
    Set dT_CW_Abx_E_NW_Sum  = 0,  !- <none>
    Set dT_CW_Abx_E_NW_Num  = 0,  !- <none>
    Set dT_CW_Abx_E_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_E_NW_Sum = 0,  !- <none>
    Set dT_HWA_Abx_E_NW_Num = 0,  !- <none>
    Set dT_HWA_Abx_E_NW_Avg = 0,  !- <none>
    Set dT_CWA_Abx_E_NW_Sum = 0,  !- <none>
    Set dT_CWA_Abx_E_NW_Num = 0,  !- <none>
    Set dT_CWA_Abx_E_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_NW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_E_NW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_NW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_E_NW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_E_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_NW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_E_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL E_NW
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling E_NW Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 666 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1282 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_NW { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_E_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_E_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_E_NW,  !- Name
    Ceiling E_NW Hepta,      !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_E_NW,               !- Zone Name
    LowTempRadiantSurfaceGroup_E_NW,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.76674645E-04,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_E_NW,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.39832536E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_E_NW,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Name
    0.76674645E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW,  !- Name
    0.39832536E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_E_NW,     !- Name
    AirNode_ZoneNode_E_NW,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_E_NW, !- Name
    Schedule_TemperatureSp_Heating_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_E_NW, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_E_NW,          !- Name
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_E_NW,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_NW = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_E_NW,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_NW = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_E_NW < t_Sp_Heating_Hepta_E_NW + 0.07 ),  !- <none>
    Set MFR_Hepta_E_NW =   0.076674640,  !- <none>
    ELSEIF (t_AirNode_Zone_E_NW > t_Sp_Cooling_Hepta_E_NW - 0.07 ),  !- <none>
    Set MFR_Hepta_E_NW =   0.039832536,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_E_NW,     !- Name
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_E_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_E_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_E_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(Water) {K},  !- Name
    dT_W_Hepta_E_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(HWater) {K},  !- Name
    dT_HW_Hepta_E_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(CWater) {K},  !- Name
    dT_CW_Hepta_E_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_E_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_E_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_E_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_E_NW_TempDiff,!- Name
    Set dT_W_Hepta_E_NW  = 0,!- Program Line 1
    Set dT_HW_Hepta_E_NW = 0,!- Program Line 2
    Set dT_CW_Hepta_E_NW = 0,!- <none>
    Set dT_WA_Hepta_E_NW  = 0,  !- <none>
    Set dT_HWA_Hepta_E_NW = 0,  !- <none>
    Set dT_CWA_Hepta_E_NW = 0,  !- <none>
    Set dT_W_Hepta_E_NW    = (t_NodeIn_Hepta_E_NW - t_NodeOut_Hepta_E_NW),  !- <none>
    Set dT_WA_Hepta_E_NW = (t_NodeIn_Hepta_E_NW + t_NodeOut_Hepta_E_NW) / 2,  !- <none>
    Set dT_WA_Hepta_E_NW = dT_WA_Hepta_E_NW - t_AirNode_Zone_E_NW,  !- <none>
    IF (dT_W_Hepta_E_NW > 0),!- <none>
    Set dT_HW_Hepta_E_NW    = dT_W_Hepta_E_NW,  !- <none>
    Set dT_HWA_Hepta_E_NW = dT_WA_Hepta_E_NW,  !- <none>
    Set dT_HW_Hepta_E_NW_Num = dT_HW_Hepta_E_NW_Num + 1,  !- <none>
    Set dT_HW_Hepta_E_NW_Sum = dT_HW_Hepta_E_NW_Sum + dT_HW_Hepta_E_NW,  !- <none>
    Set dT_HW_Hepta_E_NW_Avg = dT_HW_Hepta_E_NW_Sum / dT_HW_Hepta_E_NW_Num,  !- <none>
    Set dT_HWA_Hepta_E_NW_Num = dT_HWA_Hepta_E_NW_Num + 1,  !- <none>
    Set dT_HWA_Hepta_E_NW_Sum = dT_HWA_Hepta_E_NW_Sum + dT_HWA_Hepta_E_NW,  !- <none>
    Set dT_HWA_Hepta_E_NW_Avg = dT_HWA_Hepta_E_NW_Sum / dT_HWA_Hepta_E_NW_Num,  !- <none>
    ELSEIF (dT_W_Hepta_E_NW < 0),  !- <none>
    Set dT_CW_Hepta_E_NW    = 0.0 - dT_W_Hepta_E_NW,  !- <none>
    Set dT_CWA_Hepta_E_NW = 0.0 - dT_WA_Hepta_E_NW,  !- <none>
    Set dT_CW_Hepta_E_NW_Num = dT_CW_Hepta_E_NW_Num + 1,  !- <none>
    Set dT_CW_Hepta_E_NW_Sum = dT_CW_Hepta_E_NW_Sum + dT_CW_Hepta_E_NW,  !- <none>
    Set dT_CW_Hepta_E_NW_Avg = dT_CW_Hepta_E_NW_Sum / dT_CW_Hepta_E_NW_Num,  !- <none>
    Set dT_CWA_Hepta_E_NW_Num = dT_CWA_Hepta_E_NW_Num + 1,  !- <none>
    Set dT_CWA_Hepta_E_NW_Sum = dT_CWA_Hepta_E_NW_Sum + dT_CWA_Hepta_E_NW,  !- <none>
    Set dT_CWA_Hepta_E_NW_Avg = dT_CWA_Hepta_E_NW_Sum / dT_CWA_Hepta_E_NW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_E_NW;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_E_NW, !- Name
    Run InitConvCoeff_Sf_Zone_E_NW,  !- Program Line 1
    IF (dT_W_Hepta_E_NW > 0),!- Program Line 2
    IF (dT_HWA_Hepta_E_NW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_NW = (6.12 + (0.18 * (dT_HWA_Hepta_E_NW^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_NW,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_E_NW < 0),  !- <none>
    IF (dT_CWA_Hepta_E_NW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_NW = 6.12 + (2.76 * (dT_CWA_Hepta_E_NW^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_NW,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_E_NW,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_NW  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_E_NW,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_NW  = ConvCoeffToSet_Hepta_E_NW;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_E_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_E_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_E_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_E_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_E_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_E_NW_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_E_NW_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_E_NW_Num  = 0,  !- <none>
    Set dT_CW_Hepta_E_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_E_NW_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_E_NW_Num = 0,  !- <none>
    Set dT_HWA_Hepta_E_NW_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_E_NW_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_E_NW_Num = 0,  !- <none>
    Set dT_CWA_Hepta_E_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_E_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_E_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_NW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_E_NW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_NW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_NW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_E_NW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR E_NW
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 863 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_NW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_E_NW,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_E_NW_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_E_NW_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    69.040000916,            !- U-Factor Times Area Value {W/K}
    0.68819791E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_E_NW,  !- Name
    0.68819791E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_E_NW,    !- Component 1 Name
    Node_HwDemand_WaterConvective_E_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_E_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_E_NW,  !- Name
    WaterConvective_E_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_E_NW,      !- Name
    WaterConvective_E_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_E_NW,     !- Name
    WaterConvective_E_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_E_NW,   !- Name
    WaterConvective_E_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_E_NW,  !- Name
    WaterConvective_E_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_E_NW;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_NW: dT(HWater) {K},  !- Name
    dT_HW_Conv_E_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_E_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_NW: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_E_NW,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_E_NW_TempDiff, !- Name
    Set dT_HW_Conv_E_NW    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_E_NW = 0,  !- Program Line 2
    Set dT_HWA_Conv_E_NW   = 0,  !- <none>
    Set dT_HW_Conv_E_NW    = t_NodeIn_Conv_E_NW - t_NodeOut_Conv_E_NW,  !- <none>
    IF (dT_HW_Conv_E_NW > 0),!- <none>
    Set t_AvgAir_Conv_E_NW = t_AirNodeOut_Conv_E_NW + t_AirNodeIn_Conv_E_NW,  !- <none>
    Set t_AvgAir_Conv_E_NW = t_AvgAir_Conv_E_NW / 2,  !- <none>
    Set dT_HWA_Conv_E_NW = t_NodeOut_Conv_E_NW + t_NodeIn_Conv_E_NW,  !- <none>
    Set dT_HWA_Conv_E_NW = dT_HWA_Conv_E_NW / 2,  !- <none>
    Set dT_HWA_Conv_E_NW = dT_HWA_Conv_E_NW - t_AvgAir_Conv_E_NW,  !- <none>
    Set dT_HW_Conv_E_NW_Num = dT_HW_Conv_E_NW_Num + 1,  !- <none>
    Set dT_HW_Conv_E_NW_Sum = dT_HW_Conv_E_NW_Sum + dT_HW_Conv_E_NW,  !- <none>
    Set dT_HW_Conv_E_NW_Avg = dT_HW_Conv_E_NW_Sum / dT_HW_Conv_E_NW_Num,  !- <none>
    Set dT_HWA_Conv_E_NW_Num = dT_HWA_Conv_E_NW_Num + 1,  !- <none>
    Set dT_HWA_Conv_E_NW_Sum = dT_HWA_Conv_E_NW_Sum + dT_HWA_Conv_E_NW,  !- <none>
    Set dT_HWA_Conv_E_NW_Avg = dT_HWA_Conv_E_NW_Sum / dT_HWA_Conv_E_NW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_E_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_E_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_E_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_E_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_E_NW_Sum = 0,  !- <none>
    Set dT_HWA_Conv_E_NW_Num = 0,  !- <none>
    Set dT_HWA_Conv_E_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_E_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_E_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_E_SE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_SE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_SE,  !- Name
    Zone_E_SE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_SE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_SE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_SE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_SE,  !- Name
    Schedule_TemperatureMinimum_Zone_E_SE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_SE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_SE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_SE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_SE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_E_SE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_E_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_E_SE,               !- Zone Name
    ZoneHvacEquipmentList_E_SE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_E_SE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_SE,   !- Zone Air Node Name
    AirNode_E_SE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_SE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_SE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_SE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_SE,  !- Name
    Set Heating_Energy_Zone_E_SE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_SE = Heating_Energy_Zone_E_SE + Q_Heating_Abx_E_SE,  !- Program Line 2
    Set Heating_Energy_Zone_E_SE = Heating_Energy_Zone_E_SE + Q_Heating_Hepta_E_SE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_SE,  !- Name
    Set Cooling_Energy_Zone_E_SE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_E_SE = Cooling_Energy_Zone_E_SE + Q_Cooling_Abx_E_SE,  !- Program Line 2
    Set Cooling_Energy_Zone_E_SE = Cooling_Energy_Zone_E_SE + Q_Cooling_Hepta_E_SE;  !- <none>

! ====================================================================================================
! ===     AIRBOX E_SE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 3 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = E_SE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_E_SE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_E_SE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_E_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_E_SE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_E_SE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_E_SE,  !- Name
    Schedule_Availability_Abx_E_SE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_E_SE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_E_SE,  !- Name
    Schedule_Availability_Abx_E_SE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.078374997,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.053349994,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_E_SE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_E_SE_FanAvail,    !- Name
    Schedule_Availability_Abx_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_E_SE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_E_SE_Fan,        !- Name
    FanVariableVolume_Abx_E_SE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_E_SE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_E_SE_Fan = 0,!- Program Line 2
    IF (Is_Abx_E_SE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_E_SE > 0.1),  !- <none>
    Set MFR_Abx_E_SE_Fan =    0.078374997 * rho_Abx_E_SE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_SE_Fan =    0.053349994 * rho_Abx_E_SE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_SE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_E_SE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_E_SE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_E_SE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_E_SE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_E_SE_SupplyAir = t_Abx_E_SE_WaterSupply - t_Abx_E_SE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_E_SE_SupplyAir = 0.794871807 * TempSP_Abx_E_SE_SupplyAir,  !- <none>
    Set TempSP_Abx_E_SE_SupplyAir = t_Abx_E_SE_OutdoorAir + TempSP_Abx_E_SE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_E_SE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_E_SE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    124.080001831,           !- U-Factor Times Area Value {W/K}
    0.11244018E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    2820,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SE,  !- Name
    0.11244018E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_E_SE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_E_SE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.11244018E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_E_SE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.80741636E-04,          !- Design Water Flow Rate {m3/s}
    0.083333336,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SE,  !- Name
    0.12111246E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_E_SE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_E_SE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.12111246E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_SE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_E_SE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_E_SE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_E_SE, !- Name
    AirBranch_Abx_E_SE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_E_SE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_E_SE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_E_SE,!- Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_E_SE,  !- Name
    ControllerList_Abx_E_SE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_E_SE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_E_SE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_E_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_OutdoorInlet,  !- Actuator Node Name
    0.053349994,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.078374997,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_SE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_E_SE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_E_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_E_SE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_E_SE,  !- Name
    Schedule_Availability_Abx_E_SE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SE_Inlet,  !- Air Inlet Node Name
    0.078374997,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.053349994;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_E_SE,        !- Name
    ControllerList_Abx_E_SE_Coils,  !- Controller List Name
    AvailabilityList_Abx_E_SE,  !- Availability Manager List Name
    0.078374997,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_E_SE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_E_SE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_E_SE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_E_SE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_E_SE,      !- Name
    0.078374997,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_E_SE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_E_SE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_E_SE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_E_SE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_E_SE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_E_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_SE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_E_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_SE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_E_SE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_E_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_SE_Outlet,  !- Outlet Node Name
    AirNode_E_SE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_E_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_SE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_E_SE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_SE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_SE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_E_SE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_E_SE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_E_SE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_E_SE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_E_SE,    !- Name
    AirNode_OutdoorAirMixer_Abx_E_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_E_SE,   !- Name
    AirNode_WaterCoolingCoil_Abx_E_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_E_SE,        !- Name
    AirNode_FanVariableVolume_Abx_E_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_E_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(HWater) {K},!- Name
    dT_HW_Abx_E_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(CWater) {K},!- Name
    dT_CW_Abx_E_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_E_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_E_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_E_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_E_SE_TempDiff,  !- Name
    Set dT_HW_Abx_E_SE  = 0, !- Program Line 1
    Set dT_CW_Abx_E_SE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_E_SE = 0,  !- <none>
    Set dT_HWA_Abx_E_SE  = 0,!- <none>
    Set dT_CWA_Abx_E_SE = 0, !- <none>
    IF (MFR_Air_Abx_E_SE > 0),  !- <none>
    Set t_AvgAir_Abx_E_SE = t_AirNodeOut_Abx_E_SE + t_AirNodeIn_Abx_E_SE,  !- <none>
    Set t_AvgAir_Abx_E_SE = t_AvgAir_Abx_E_SE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_E_SE = t_NodeIn_AbxHC_E_SE - t_NodeOut_AbxHC_E_SE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_E_SE = t_NodeOut_AbxCC_E_SE - t_NodeIn_AbxCC_E_SE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_E_SE <> 0),!- <none>
    IF (dT_HW_Abx_E_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_E_SE = t_NodeOut_AbxHC_E_SE + t_NodeIn_AbxHC_E_SE,  !- <none>
    Set dT_HWA_Abx_E_SE = dT_HWA_Abx_E_SE / 2,  !- <none>
    Set dT_HWA_Abx_E_SE = dT_HWA_Abx_E_SE - t_AvgAir_Abx_E_SE,  !- <none>
    Set dT_HW_Abx_E_SE_Num = dT_HW_Abx_E_SE_Num + 1,  !- <none>
    Set dT_HW_Abx_E_SE_Sum = dT_HW_Abx_E_SE_Sum + dT_HW_Abx_E_SE,  !- <none>
    Set dT_HW_Abx_E_SE_Avg = dT_HW_Abx_E_SE_Sum / dT_HW_Abx_E_SE_Num,  !- <none>
    Set dT_HWA_Abx_E_SE_Num = dT_HWA_Abx_E_SE_Num + 1,  !- <none>
    Set dT_HWA_Abx_E_SE_Sum = dT_HWA_Abx_E_SE_Sum + dT_HWA_Abx_E_SE,  !- <none>
    Set dT_HWA_Abx_E_SE_Avg = dT_HWA_Abx_E_SE_Sum / dT_HWA_Abx_E_SE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_E_SE <> 0),  !- <none>
    IF (dT_CW_Abx_E_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_E_SE = t_NodeIn_AbxCC_E_SE + t_NodeOut_AbxCC_E_SE,  !- <none>
    Set dT_CWA_Abx_E_SE = dT_CWA_Abx_E_SE / 2,  !- <none>
    Set dT_CWA_Abx_E_SE = dT_CWA_Abx_E_SE - t_AvgAir_Abx_E_SE,  !- <none>
    Set dT_CW_Abx_E_SE_Num = dT_CW_Abx_E_SE_Num + 1,  !- <none>
    Set dT_CW_Abx_E_SE_Sum = dT_CW_Abx_E_SE_Sum + dT_CW_Abx_E_SE,  !- <none>
    Set dT_CW_Abx_E_SE_Avg = dT_CW_Abx_E_SE_Sum / dT_CW_Abx_E_SE_Num,  !- <none>
    Set dT_CWA_Abx_E_SE_Num = dT_CWA_Abx_E_SE_Num + 1,  !- <none>
    Set dT_CWA_Abx_E_SE_Sum = dT_CWA_Abx_E_SE_Sum + dT_CWA_Abx_E_SE,  !- <none>
    Set dT_CWA_Abx_E_SE_Avg = dT_CWA_Abx_E_SE_Sum / dT_CWA_Abx_E_SE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_E_SE,      !- Name
    WaterHeatingCoil_Abx_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_E_SE,      !- Name
    WaterCoolingCoil_Abx_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_E_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_E_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_E_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_E_SE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_E_SE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_E_SE_Num  = 0,  !- <none>
    Set dT_CW_Abx_E_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_E_SE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_E_SE_Num = 0,  !- <none>
    Set dT_HWA_Abx_E_SE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_E_SE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_E_SE_Num = 0,  !- <none>
    Set dT_CWA_Abx_E_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_E_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_E_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_E_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_E_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL E_SE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling E_SE.1 Hepta, 0.33, Ceiling E_SE.2 Hepta, 0.67 { }, HEPTAPANELTOTALCOOLINGPOWER = 999 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1923 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_SE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_E_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_E_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_E_SE,  !- Name
    Ceiling E_SE.1 Hepta,    !- Surface 1 Name
    0.33,                    !- Flow Fraction for Surface 1
    Ceiling E_SE.2 Hepta,    !- Surface 2 Name
    0.67;                    !- Flow Fraction for Surface 2

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_E_SE,               !- Zone Name
    LowTempRadiantSurfaceGroup_E_SE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11501196E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_E_SE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.59748807E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_E_SE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Name
    0.11501196E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE,  !- Name
    0.59748807E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_E_SE,     !- Name
    AirNode_ZoneNode_E_SE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_E_SE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_E_SE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_E_SE,          !- Name
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_E_SE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_SE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_E_SE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_SE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_E_SE < t_Sp_Heating_Hepta_E_SE + 0.07 ),  !- <none>
    Set MFR_Hepta_E_SE =   0.115011960,  !- <none>
    ELSEIF (t_AirNode_Zone_E_SE > t_Sp_Cooling_Hepta_E_SE - 0.07 ),  !- <none>
    Set MFR_Hepta_E_SE =   0.059748802,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_E_SE,     !- Name
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_E_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_E_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_E_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(Water) {K},  !- Name
    dT_W_Hepta_E_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_E_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_E_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_E_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_E_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_E_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_E_SE_TempDiff,!- Name
    Set dT_W_Hepta_E_SE  = 0,!- Program Line 1
    Set dT_HW_Hepta_E_SE = 0,!- Program Line 2
    Set dT_CW_Hepta_E_SE = 0,!- <none>
    Set dT_WA_Hepta_E_SE  = 0,  !- <none>
    Set dT_HWA_Hepta_E_SE = 0,  !- <none>
    Set dT_CWA_Hepta_E_SE = 0,  !- <none>
    Set dT_W_Hepta_E_SE    = (t_NodeIn_Hepta_E_SE - t_NodeOut_Hepta_E_SE),  !- <none>
    Set dT_WA_Hepta_E_SE = (t_NodeIn_Hepta_E_SE + t_NodeOut_Hepta_E_SE) / 2,  !- <none>
    Set dT_WA_Hepta_E_SE = dT_WA_Hepta_E_SE - t_AirNode_Zone_E_SE,  !- <none>
    IF (dT_W_Hepta_E_SE > 0),!- <none>
    Set dT_HW_Hepta_E_SE    = dT_W_Hepta_E_SE,  !- <none>
    Set dT_HWA_Hepta_E_SE = dT_WA_Hepta_E_SE,  !- <none>
    Set dT_HW_Hepta_E_SE_Num = dT_HW_Hepta_E_SE_Num + 1,  !- <none>
    Set dT_HW_Hepta_E_SE_Sum = dT_HW_Hepta_E_SE_Sum + dT_HW_Hepta_E_SE,  !- <none>
    Set dT_HW_Hepta_E_SE_Avg = dT_HW_Hepta_E_SE_Sum / dT_HW_Hepta_E_SE_Num,  !- <none>
    Set dT_HWA_Hepta_E_SE_Num = dT_HWA_Hepta_E_SE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_E_SE_Sum = dT_HWA_Hepta_E_SE_Sum + dT_HWA_Hepta_E_SE,  !- <none>
    Set dT_HWA_Hepta_E_SE_Avg = dT_HWA_Hepta_E_SE_Sum / dT_HWA_Hepta_E_SE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_E_SE < 0),  !- <none>
    Set dT_CW_Hepta_E_SE    = 0.0 - dT_W_Hepta_E_SE,  !- <none>
    Set dT_CWA_Hepta_E_SE = 0.0 - dT_WA_Hepta_E_SE,  !- <none>
    Set dT_CW_Hepta_E_SE_Num = dT_CW_Hepta_E_SE_Num + 1,  !- <none>
    Set dT_CW_Hepta_E_SE_Sum = dT_CW_Hepta_E_SE_Sum + dT_CW_Hepta_E_SE,  !- <none>
    Set dT_CW_Hepta_E_SE_Avg = dT_CW_Hepta_E_SE_Sum / dT_CW_Hepta_E_SE_Num,  !- <none>
    Set dT_CWA_Hepta_E_SE_Num = dT_CWA_Hepta_E_SE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_E_SE_Sum = dT_CWA_Hepta_E_SE_Sum + dT_CWA_Hepta_E_SE,  !- <none>
    Set dT_CWA_Hepta_E_SE_Avg = dT_CWA_Hepta_E_SE_Sum / dT_CWA_Hepta_E_SE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_E_SE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_E_SE, !- Name
    Run InitConvCoeff_Sf_Zone_E_SE,  !- Program Line 1
    IF (dT_W_Hepta_E_SE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_E_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_SE = (6.12 + (0.18 * (dT_HWA_Hepta_E_SE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_SE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_E_SE < 0),  !- <none>
    IF (dT_CWA_Hepta_E_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_SE = 6.12 + (2.76 * (dT_CWA_Hepta_E_SE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_SE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_E_SE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_SE_1  = Null,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_E_SE_2  = Null;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_E_SE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_SE_1  = ConvCoeffToSet_Hepta_E_SE,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_E_SE_2  = ConvCoeffToSet_Hepta_E_SE;  !- Program Line 2

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_E_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_E_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_E_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_E_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_E_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_E_SE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_E_SE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_E_SE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_E_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_E_SE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_E_SE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_E_SE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_E_SE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_E_SE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_E_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_E_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_E_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_E_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_E_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_E_SW
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_SW { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_SW,  !- Name
    Zone_E_SW,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_SW,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_SW;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_SW,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_SW,  !- Name
    Schedule_TemperatureMinimum_Zone_E_SW,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_SW;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_SW,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_SW,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_SW,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_E_SW,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_E_SW,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3;                       !- Zone Equipment 3 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_E_SW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SW_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_E_SW,               !- Zone Name
    ZoneHvacEquipmentList_E_SW,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_E_SW,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_SW,   !- Zone Air Node Name
    AirNode_E_SW_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_SW =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_SW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_SW Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_SW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_SW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_SW Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_SW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_SW,  !- Name
    Set Heating_Energy_Zone_E_SW = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_SW = Heating_Energy_Zone_E_SW + Q_Heating_Abx_E_SW,  !- Program Line 2
    Set Heating_Energy_Zone_E_SW = Heating_Energy_Zone_E_SW + Q_Heating_Hepta_E_SW,  !- <none>
    Set Heating_Energy_Zone_E_SW = Heating_Energy_Zone_E_SW + Q_Heating_WaterConvective_E_SW;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_SW,  !- Name
    Set Cooling_Energy_Zone_E_SW = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_E_SW = Cooling_Energy_Zone_E_SW + Q_Cooling_Abx_E_SW,  !- Program Line 2
    Set Cooling_Energy_Zone_E_SW = Cooling_Energy_Zone_E_SW + Q_Cooling_Hepta_E_SW;  !- <none>

! ====================================================================================================
! ===     AIRBOX E_SW
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 3 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = E_SW { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_E_SW,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_E_SW,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_E_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_E_SW,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_E_SW;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_E_SW,  !- Name
    Schedule_Availability_Abx_E_SW;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_E_SW,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_E_SW,  !- Name
    Schedule_Availability_Abx_E_SW,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.078374997,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.053349994,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_E_SW,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_E_SW_FanAvail,    !- Name
    Schedule_Availability_Abx_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_E_SW_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_E_SW_Fan,        !- Name
    FanVariableVolume_Abx_E_SW,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_E_SW,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_E_SW_Fan = 0,!- Program Line 2
    IF (Is_Abx_E_SW_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_E_SW > 0.1),  !- <none>
    Set MFR_Abx_E_SW_Fan =    0.078374997 * rho_Abx_E_SW_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_SW_Fan =    0.053349994 * rho_Abx_E_SW_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_SW_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_E_SW_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_E_SW_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_E_SW_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_E_SW,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_E_SW_SupplyAir = t_Abx_E_SW_WaterSupply - t_Abx_E_SW_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_E_SW_SupplyAir = 0.794871807 * TempSP_Abx_E_SW_SupplyAir,  !- <none>
    Set TempSP_Abx_E_SW_SupplyAir = t_Abx_E_SW_OutdoorAir + TempSP_Abx_E_SW_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_E_SW_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_E_SW,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    124.080001831,           !- U-Factor Times Area Value {W/K}
    0.11244018E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    2820,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_E_SW,  !- Name
    0.11244018E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_E_SW,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_E_SW,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.11244018E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_E_SW,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.80741636E-04,          !- Design Water Flow Rate {m3/s}
    0.083333336,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_E_SW,  !- Name
    0.12111246E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_E_SW,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_E_SW,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.12111246E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_SW_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_E_SW,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_E_SW;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_E_SW, !- Name
    AirBranch_Abx_E_SW;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_E_SW,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_E_SW;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_E_SW,!- Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_E_SW,  !- Name
    ControllerList_Abx_E_SW_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_E_SW,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_E_SW;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_E_SW,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_OutdoorInlet,  !- Actuator Node Name
    0.053349994,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.078374997,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_SW_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_E_SW;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_E_SW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SW_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_E_SW;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_E_SW,  !- Name
    Schedule_Availability_Abx_E_SW,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SW_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SW_Inlet,  !- Air Inlet Node Name
    0.078374997,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.053349994;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_E_SW,        !- Name
    ControllerList_Abx_E_SW_Coils,  !- Controller List Name
    AvailabilityList_Abx_E_SW,  !- Availability Manager List Name
    0.078374997,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_E_SW, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_E_SW_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_E_SW_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_E_SW_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_E_SW,      !- Name
    0.078374997,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_E_SW,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_E_SW_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_E_SW,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_E_SW,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_E_SW,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_E_SW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_SW_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_SW_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_E_SW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_SW_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_E_SW;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_E_SW,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_SW_Outlet,  !- Outlet Node Name
    AirNode_E_SW_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_E_SW,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_SW_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_E_SW;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_SW,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_SW_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_SW;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_E_SW,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_E_SW,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_E_SW,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_E_SW,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_E_SW,    !- Name
    AirNode_OutdoorAirMixer_Abx_E_SW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_E_SW,   !- Name
    AirNode_WaterCoolingCoil_Abx_E_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_E_SW,        !- Name
    AirNode_FanVariableVolume_Abx_E_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_E_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(HWater) {K},!- Name
    dT_HW_Abx_E_SW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(CWater) {K},!- Name
    dT_CW_Abx_E_SW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_E_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_E_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_E_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_E_SW_TempDiff,  !- Name
    Set dT_HW_Abx_E_SW  = 0, !- Program Line 1
    Set dT_CW_Abx_E_SW = 0,  !- Program Line 2
    Set t_AvgAir_Abx_E_SW = 0,  !- <none>
    Set dT_HWA_Abx_E_SW  = 0,!- <none>
    Set dT_CWA_Abx_E_SW = 0, !- <none>
    IF (MFR_Air_Abx_E_SW > 0),  !- <none>
    Set t_AvgAir_Abx_E_SW = t_AirNodeOut_Abx_E_SW + t_AirNodeIn_Abx_E_SW,  !- <none>
    Set t_AvgAir_Abx_E_SW = t_AvgAir_Abx_E_SW / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_E_SW = t_NodeIn_AbxHC_E_SW - t_NodeOut_AbxHC_E_SW,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_E_SW = t_NodeOut_AbxCC_E_SW - t_NodeIn_AbxCC_E_SW,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_E_SW <> 0),!- <none>
    IF (dT_HW_Abx_E_SW < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_E_SW = t_NodeOut_AbxHC_E_SW + t_NodeIn_AbxHC_E_SW,  !- <none>
    Set dT_HWA_Abx_E_SW = dT_HWA_Abx_E_SW / 2,  !- <none>
    Set dT_HWA_Abx_E_SW = dT_HWA_Abx_E_SW - t_AvgAir_Abx_E_SW,  !- <none>
    Set dT_HW_Abx_E_SW_Num = dT_HW_Abx_E_SW_Num + 1,  !- <none>
    Set dT_HW_Abx_E_SW_Sum = dT_HW_Abx_E_SW_Sum + dT_HW_Abx_E_SW,  !- <none>
    Set dT_HW_Abx_E_SW_Avg = dT_HW_Abx_E_SW_Sum / dT_HW_Abx_E_SW_Num,  !- <none>
    Set dT_HWA_Abx_E_SW_Num = dT_HWA_Abx_E_SW_Num + 1,  !- <none>
    Set dT_HWA_Abx_E_SW_Sum = dT_HWA_Abx_E_SW_Sum + dT_HWA_Abx_E_SW,  !- <none>
    Set dT_HWA_Abx_E_SW_Avg = dT_HWA_Abx_E_SW_Sum / dT_HWA_Abx_E_SW_Num,  !- <none>
    ELSEIF (dT_CW_Abx_E_SW <> 0),  !- <none>
    IF (dT_CW_Abx_E_SW < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_E_SW = t_NodeIn_AbxCC_E_SW + t_NodeOut_AbxCC_E_SW,  !- <none>
    Set dT_CWA_Abx_E_SW = dT_CWA_Abx_E_SW / 2,  !- <none>
    Set dT_CWA_Abx_E_SW = dT_CWA_Abx_E_SW - t_AvgAir_Abx_E_SW,  !- <none>
    Set dT_CW_Abx_E_SW_Num = dT_CW_Abx_E_SW_Num + 1,  !- <none>
    Set dT_CW_Abx_E_SW_Sum = dT_CW_Abx_E_SW_Sum + dT_CW_Abx_E_SW,  !- <none>
    Set dT_CW_Abx_E_SW_Avg = dT_CW_Abx_E_SW_Sum / dT_CW_Abx_E_SW_Num,  !- <none>
    Set dT_CWA_Abx_E_SW_Num = dT_CWA_Abx_E_SW_Num + 1,  !- <none>
    Set dT_CWA_Abx_E_SW_Sum = dT_CWA_Abx_E_SW_Sum + dT_CWA_Abx_E_SW,  !- <none>
    Set dT_CWA_Abx_E_SW_Avg = dT_CWA_Abx_E_SW_Sum / dT_CWA_Abx_E_SW_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_E_SW,      !- Name
    WaterHeatingCoil_Abx_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_E_SW,      !- Name
    WaterCoolingCoil_Abx_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_E_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_E_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_E_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_E_SW_Avg  = 0,  !- <none>
    Set dT_CW_Abx_E_SW_Sum  = 0,  !- <none>
    Set dT_CW_Abx_E_SW_Num  = 0,  !- <none>
    Set dT_CW_Abx_E_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_E_SW_Sum = 0,  !- <none>
    Set dT_HWA_Abx_E_SW_Num = 0,  !- <none>
    Set dT_HWA_Abx_E_SW_Avg = 0,  !- <none>
    Set dT_CWA_Abx_E_SW_Sum = 0,  !- <none>
    Set dT_CWA_Abx_E_SW_Num = 0,  !- <none>
    Set dT_CWA_Abx_E_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_SW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_E_SW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_SW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_E_SW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_E_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_SW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_E_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL E_SW
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling E_SW Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 999 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1923 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_SW { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_E_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_E_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_E_SW,  !- Name
    Ceiling E_SW Hepta,      !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_E_SW,               !- Zone Name
    LowTempRadiantSurfaceGroup_E_SW,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11501196E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_E_SW,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.59748807E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_E_SW,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Name
    0.11501196E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW,  !- Name
    0.59748807E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_E_SW,     !- Name
    AirNode_ZoneNode_E_SW,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_E_SW, !- Name
    Schedule_TemperatureSp_Heating_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_E_SW, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_E_SW,          !- Name
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_E_SW,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_SW = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_E_SW,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_SW = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_E_SW < t_Sp_Heating_Hepta_E_SW + 0.07 ),  !- <none>
    Set MFR_Hepta_E_SW =   0.115011960,  !- <none>
    ELSEIF (t_AirNode_Zone_E_SW > t_Sp_Cooling_Hepta_E_SW - 0.07 ),  !- <none>
    Set MFR_Hepta_E_SW =   0.059748802,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_E_SW,     !- Name
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_E_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_E_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_E_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(Water) {K},  !- Name
    dT_W_Hepta_E_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(HWater) {K},  !- Name
    dT_HW_Hepta_E_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(CWater) {K},  !- Name
    dT_CW_Hepta_E_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_E_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_E_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_E_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_E_SW_TempDiff,!- Name
    Set dT_W_Hepta_E_SW  = 0,!- Program Line 1
    Set dT_HW_Hepta_E_SW = 0,!- Program Line 2
    Set dT_CW_Hepta_E_SW = 0,!- <none>
    Set dT_WA_Hepta_E_SW  = 0,  !- <none>
    Set dT_HWA_Hepta_E_SW = 0,  !- <none>
    Set dT_CWA_Hepta_E_SW = 0,  !- <none>
    Set dT_W_Hepta_E_SW    = (t_NodeIn_Hepta_E_SW - t_NodeOut_Hepta_E_SW),  !- <none>
    Set dT_WA_Hepta_E_SW = (t_NodeIn_Hepta_E_SW + t_NodeOut_Hepta_E_SW) / 2,  !- <none>
    Set dT_WA_Hepta_E_SW = dT_WA_Hepta_E_SW - t_AirNode_Zone_E_SW,  !- <none>
    IF (dT_W_Hepta_E_SW > 0),!- <none>
    Set dT_HW_Hepta_E_SW    = dT_W_Hepta_E_SW,  !- <none>
    Set dT_HWA_Hepta_E_SW = dT_WA_Hepta_E_SW,  !- <none>
    Set dT_HW_Hepta_E_SW_Num = dT_HW_Hepta_E_SW_Num + 1,  !- <none>
    Set dT_HW_Hepta_E_SW_Sum = dT_HW_Hepta_E_SW_Sum + dT_HW_Hepta_E_SW,  !- <none>
    Set dT_HW_Hepta_E_SW_Avg = dT_HW_Hepta_E_SW_Sum / dT_HW_Hepta_E_SW_Num,  !- <none>
    Set dT_HWA_Hepta_E_SW_Num = dT_HWA_Hepta_E_SW_Num + 1,  !- <none>
    Set dT_HWA_Hepta_E_SW_Sum = dT_HWA_Hepta_E_SW_Sum + dT_HWA_Hepta_E_SW,  !- <none>
    Set dT_HWA_Hepta_E_SW_Avg = dT_HWA_Hepta_E_SW_Sum / dT_HWA_Hepta_E_SW_Num,  !- <none>
    ELSEIF (dT_W_Hepta_E_SW < 0),  !- <none>
    Set dT_CW_Hepta_E_SW    = 0.0 - dT_W_Hepta_E_SW,  !- <none>
    Set dT_CWA_Hepta_E_SW = 0.0 - dT_WA_Hepta_E_SW,  !- <none>
    Set dT_CW_Hepta_E_SW_Num = dT_CW_Hepta_E_SW_Num + 1,  !- <none>
    Set dT_CW_Hepta_E_SW_Sum = dT_CW_Hepta_E_SW_Sum + dT_CW_Hepta_E_SW,  !- <none>
    Set dT_CW_Hepta_E_SW_Avg = dT_CW_Hepta_E_SW_Sum / dT_CW_Hepta_E_SW_Num,  !- <none>
    Set dT_CWA_Hepta_E_SW_Num = dT_CWA_Hepta_E_SW_Num + 1,  !- <none>
    Set dT_CWA_Hepta_E_SW_Sum = dT_CWA_Hepta_E_SW_Sum + dT_CWA_Hepta_E_SW,  !- <none>
    Set dT_CWA_Hepta_E_SW_Avg = dT_CWA_Hepta_E_SW_Sum / dT_CWA_Hepta_E_SW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_E_SW;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_E_SW, !- Name
    Run InitConvCoeff_Sf_Zone_E_SW,  !- Program Line 1
    IF (dT_W_Hepta_E_SW > 0),!- Program Line 2
    IF (dT_HWA_Hepta_E_SW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_SW = (6.12 + (0.18 * (dT_HWA_Hepta_E_SW^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_SW,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_E_SW < 0),  !- <none>
    IF (dT_CWA_Hepta_E_SW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_SW = 6.12 + (2.76 * (dT_CWA_Hepta_E_SW^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_SW,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_E_SW,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_SW  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_E_SW,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_SW  = ConvCoeffToSet_Hepta_E_SW;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_E_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_E_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_E_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_E_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_E_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_E_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_E_SW_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_E_SW_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_E_SW_Num  = 0,  !- <none>
    Set dT_CW_Hepta_E_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_E_SW_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_E_SW_Num = 0,  !- <none>
    Set dT_HWA_Hepta_E_SW_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_E_SW_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_E_SW_Num = 0,  !- <none>
    Set dT_CWA_Hepta_E_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_E_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_E_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_SW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_E_SW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_SW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_SW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_E_SW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR E_SW
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 636 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_SW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_E_SW,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_E_SW_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_E_SW_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    50.880001068,            !- U-Factor Times Area Value {W/K}
    0.50717706E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_E_SW,  !- Name
    0.50717706E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_E_SW,    !- Component 1 Name
    Node_HwDemand_WaterConvective_E_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_E_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_E_SW,  !- Name
    WaterConvective_E_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_E_SW,      !- Name
    WaterConvective_E_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_E_SW,     !- Name
    WaterConvective_E_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_E_SW,   !- Name
    WaterConvective_E_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_E_SW,  !- Name
    WaterConvective_E_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_E_SW;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_SW: dT(HWater) {K},  !- Name
    dT_HW_Conv_E_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_E_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_E_SW: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_E_SW,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_E_SW_TempDiff, !- Name
    Set dT_HW_Conv_E_SW    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_E_SW = 0,  !- Program Line 2
    Set dT_HWA_Conv_E_SW   = 0,  !- <none>
    Set dT_HW_Conv_E_SW    = t_NodeIn_Conv_E_SW - t_NodeOut_Conv_E_SW,  !- <none>
    IF (dT_HW_Conv_E_SW > 0),!- <none>
    Set t_AvgAir_Conv_E_SW = t_AirNodeOut_Conv_E_SW + t_AirNodeIn_Conv_E_SW,  !- <none>
    Set t_AvgAir_Conv_E_SW = t_AvgAir_Conv_E_SW / 2,  !- <none>
    Set dT_HWA_Conv_E_SW = t_NodeOut_Conv_E_SW + t_NodeIn_Conv_E_SW,  !- <none>
    Set dT_HWA_Conv_E_SW = dT_HWA_Conv_E_SW / 2,  !- <none>
    Set dT_HWA_Conv_E_SW = dT_HWA_Conv_E_SW - t_AvgAir_Conv_E_SW,  !- <none>
    Set dT_HW_Conv_E_SW_Num = dT_HW_Conv_E_SW_Num + 1,  !- <none>
    Set dT_HW_Conv_E_SW_Sum = dT_HW_Conv_E_SW_Sum + dT_HW_Conv_E_SW,  !- <none>
    Set dT_HW_Conv_E_SW_Avg = dT_HW_Conv_E_SW_Sum / dT_HW_Conv_E_SW_Num,  !- <none>
    Set dT_HWA_Conv_E_SW_Num = dT_HWA_Conv_E_SW_Num + 1,  !- <none>
    Set dT_HWA_Conv_E_SW_Sum = dT_HWA_Conv_E_SW_Sum + dT_HWA_Conv_E_SW,  !- <none>
    Set dT_HWA_Conv_E_SW_Avg = dT_HWA_Conv_E_SW_Sum / dT_HWA_Conv_E_SW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_E_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_E_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_E_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_E_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_E_SW_Sum = 0,  !- <none>
    Set dT_HWA_Conv_E_SW_Num = 0,  !- <none>
    Set dT_HWA_Conv_E_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_E_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_E_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_E_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_E_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_E_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_E_W
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = E_W { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_E_W,  !- Name
    Zone_E_W,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_E_W,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_E_W;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_E_W,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_E_W,  !- Name
    Schedule_TemperatureMinimum_Zone_E_W,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_E_W;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_E_W,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_E_W,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_E_W,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_E_W,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_E_W,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_E_W,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_W_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_E_W,                !- Zone Name
    ZoneHvacEquipmentList_E_W,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_E_W,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_E_W,    !- Zone Air Node Name
    AirNode_E_W_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE E_W =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_E_W; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_W Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_E_W, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_E_W; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_E_W Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_E_W, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_E_W,  !- Name
    Set Heating_Energy_Zone_E_W = 0,  !- Program Line 1
    Set Heating_Energy_Zone_E_W = Heating_Energy_Zone_E_W + Q_Heating_Abx_E_W,  !- Program Line 2
    Set Heating_Energy_Zone_E_W = Heating_Energy_Zone_E_W + Q_Heating_Hepta_E_W;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_E_W,  !- Name
    Set Cooling_Energy_Zone_E_W = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_E_W = Cooling_Energy_Zone_E_W + Q_Cooling_Abx_E_W,  !- Program Line 2
    Set Cooling_Energy_Zone_E_W = Cooling_Energy_Zone_E_W + Q_Cooling_Hepta_E_W;  !- <none>

! ====================================================================================================
! ===     AIRBOX E_W
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = E_W { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_E_W,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_E_W,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_E_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_E_W,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_E_W;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_E_W,  !- Name
    Schedule_Availability_Abx_E_W;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_E_W,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_E_W,  !- Name
    Schedule_Availability_Abx_E_W,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_E_W_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_E_W,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_E_W_FanAvail,     !- Name
    Schedule_Availability_Abx_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_E_W_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_E_W_Fan,         !- Name
    FanVariableVolume_Abx_E_W,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_E_W,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_E_W_Fan = 0, !- Program Line 2
    IF (Is_Abx_E_W_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_E_W > 0.1),  !- <none>
    Set MFR_Abx_E_W_Fan =    0.104500003 * rho_Abx_E_W_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_W_Fan =    0.071133330 * rho_Abx_E_W_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_E_W_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_E_W_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_E_W_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_E_W_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_E_W,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_E_W_SupplyAir = t_Abx_E_W_WaterSupply - t_Abx_E_W_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_E_W_SupplyAir = 0.794871807 * TempSP_Abx_E_W_SupplyAir,  !- <none>
    Set TempSP_Abx_E_W_SupplyAir = t_Abx_E_W_OutdoorAir + TempSP_Abx_E_W_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_E_W_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_E_W,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_W_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_E_W,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_E_W,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_E_W,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_E_W,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_W_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_W_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_E_W,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_E_W,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_E_W,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_W_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_E_W,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_E_W;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_E_W,  !- Name
    AirBranch_Abx_E_W;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_E_W,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_E_W; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_E_W, !- Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_E_W,!- Name
    ControllerList_Abx_E_W_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_E_W,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_E_W;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_E_W,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_E_W_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_E_W;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_E_W,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_E_W_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_E_W;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_E_W,  !- Name
    Schedule_Availability_Abx_E_W,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_E_W_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_W_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_E_W,         !- Name
    ControllerList_Abx_E_W_Coils,  !- Controller List Name
    AvailabilityList_Abx_E_W,!- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_E_W,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_E_W_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_E_W_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_E_W_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_E_W,       !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_E_W,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_E_W_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_E_W,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_E_W_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_E_W,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_E_W_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_E_W_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_E_W,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_E_W_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_E_W,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_W_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_E_W_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_E_W,  !- Name
    AirNode_AirLoopSupplyPath_Abx_E_W_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_E_W;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_E_W,!- Name
    AirNode_AirLoopReturnPath_Abx_E_W_Outlet,  !- Outlet Node Name
    AirNode_E_W_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_E_W,  !- Name
    AirNode_AirLoopReturnPath_Abx_E_W_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_E_W;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_W,  !- Name
    AirNode_OutdoorAirMixer_Abx_E_W_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_E_W;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_E_W,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_E_W,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_E_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_E_W,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_E_W,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_E_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_E_W,     !- Name
    AirNode_OutdoorAirMixer_Abx_E_W_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_E_W,    !- Name
    AirNode_WaterCoolingCoil_Abx_E_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_E_W,         !- Name
    AirNode_FanVariableVolume_Abx_E_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_W;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_W;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_E_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(HWater) {K}, !- Name
    dT_HW_Abx_E_W,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(CWater) {K}, !- Name
    dT_CW_Abx_E_W,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_E_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_E_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_E_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_E_W_TempDiff,   !- Name
    Set dT_HW_Abx_E_W  = 0,  !- Program Line 1
    Set dT_CW_Abx_E_W = 0,   !- Program Line 2
    Set t_AvgAir_Abx_E_W = 0,!- <none>
    Set dT_HWA_Abx_E_W  = 0, !- <none>
    Set dT_CWA_Abx_E_W = 0,  !- <none>
    IF (MFR_Air_Abx_E_W > 0),!- <none>
    Set t_AvgAir_Abx_E_W = t_AirNodeOut_Abx_E_W + t_AirNodeIn_Abx_E_W,  !- <none>
    Set t_AvgAir_Abx_E_W = t_AvgAir_Abx_E_W / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_E_W = t_NodeIn_AbxHC_E_W - t_NodeOut_AbxHC_E_W,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_E_W = t_NodeOut_AbxCC_E_W - t_NodeIn_AbxCC_E_W,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_E_W <> 0), !- <none>
    IF (dT_HW_Abx_E_W < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_E_W = t_NodeOut_AbxHC_E_W + t_NodeIn_AbxHC_E_W,  !- <none>
    Set dT_HWA_Abx_E_W = dT_HWA_Abx_E_W / 2,  !- <none>
    Set dT_HWA_Abx_E_W = dT_HWA_Abx_E_W - t_AvgAir_Abx_E_W,  !- <none>
    Set dT_HW_Abx_E_W_Num = dT_HW_Abx_E_W_Num + 1,  !- <none>
    Set dT_HW_Abx_E_W_Sum = dT_HW_Abx_E_W_Sum + dT_HW_Abx_E_W,  !- <none>
    Set dT_HW_Abx_E_W_Avg = dT_HW_Abx_E_W_Sum / dT_HW_Abx_E_W_Num,  !- <none>
    Set dT_HWA_Abx_E_W_Num = dT_HWA_Abx_E_W_Num + 1,  !- <none>
    Set dT_HWA_Abx_E_W_Sum = dT_HWA_Abx_E_W_Sum + dT_HWA_Abx_E_W,  !- <none>
    Set dT_HWA_Abx_E_W_Avg = dT_HWA_Abx_E_W_Sum / dT_HWA_Abx_E_W_Num,  !- <none>
    ELSEIF (dT_CW_Abx_E_W <> 0),  !- <none>
    IF (dT_CW_Abx_E_W < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_E_W = t_NodeIn_AbxCC_E_W + t_NodeOut_AbxCC_E_W,  !- <none>
    Set dT_CWA_Abx_E_W = dT_CWA_Abx_E_W / 2,  !- <none>
    Set dT_CWA_Abx_E_W = dT_CWA_Abx_E_W - t_AvgAir_Abx_E_W,  !- <none>
    Set dT_CW_Abx_E_W_Num = dT_CW_Abx_E_W_Num + 1,  !- <none>
    Set dT_CW_Abx_E_W_Sum = dT_CW_Abx_E_W_Sum + dT_CW_Abx_E_W,  !- <none>
    Set dT_CW_Abx_E_W_Avg = dT_CW_Abx_E_W_Sum / dT_CW_Abx_E_W_Num,  !- <none>
    Set dT_CWA_Abx_E_W_Num = dT_CWA_Abx_E_W_Num + 1,  !- <none>
    Set dT_CWA_Abx_E_W_Sum = dT_CWA_Abx_E_W_Sum + dT_CWA_Abx_E_W,  !- <none>
    Set dT_CWA_Abx_E_W_Avg = dT_CWA_Abx_E_W_Sum / dT_CWA_Abx_E_W_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_E_W,       !- Name
    WaterHeatingCoil_Abx_E_W,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_E_W,       !- Name
    WaterCoolingCoil_Abx_E_W,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_E_W_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_E_W_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_E_W_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_E_W_Avg  = 0,  !- <none>
    Set dT_CW_Abx_E_W_Sum  = 0,  !- <none>
    Set dT_CW_Abx_E_W_Num  = 0,  !- <none>
    Set dT_CW_Abx_E_W_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_E_W_Sum = 0,  !- <none>
    Set dT_HWA_Abx_E_W_Num = 0,  !- <none>
    Set dT_HWA_Abx_E_W_Avg = 0,  !- <none>
    Set dT_CWA_Abx_E_W_Sum = 0,  !- <none>
    Set dT_CWA_Abx_E_W_Num = 0,  !- <none>
    Set dT_CWA_Abx_E_W_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_W_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_W_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_E_W_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_E_W_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_W_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_W_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_E_W_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_E_W_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_W_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_W_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_E_W_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_E_W_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_W_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_W_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_E_W_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_E_W: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_E_W_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL E_W
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling E_W.1 Hepta, 0.50, Ceiling E_W.2 Hepta, 0.50 { }, HEPTAPANELTOTALCOOLINGPOWER = 1332 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 2564 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = E_W { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_E_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_E_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_E_W,  !- Name
    Ceiling E_W.1 Hepta,     !- Surface 1 Name
    0.50,                    !- Flow Fraction for Surface 1
    Ceiling E_W.2 Hepta,     !- Surface 2 Name
    0.50;                    !- Flow Fraction for Surface 2

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_E_W,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_E_W,                !- Zone Name
    LowTempRadiantSurfaceGroup_E_W,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.15334928E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_W_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_W_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_E_W,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.79665078E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_W_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_W_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_E_W,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Name
    0.15334928E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_W,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_W_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_E_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_E_W,  !- Name
    0.79665078E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_E_W,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_W_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_E_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_E_W,      !- Name
    AirNode_ZoneNode_E_W,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_E_W,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_E_W,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_E_W,           !- Name
    LowTempRadiantVarFlow_Hepta_E_W,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_E_W,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_W = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_E_W,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_E_W = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_E_W < t_Sp_Heating_Hepta_E_W + 0.07 ),  !- <none>
    Set MFR_Hepta_E_W =   0.153349280,  !- <none>
    ELSEIF (t_AirNode_Zone_E_W > t_Sp_Cooling_Hepta_E_W - 0.07 ),  !- <none>
    Set MFR_Hepta_E_W =   0.079665072,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_E_W,      !- Name
    LowTempRadiantVarFlow_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_E_W,     !- Name
    LowTempRadiantVarFlow_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_E_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_E_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(Water) {K},!- Name
    dT_W_Hepta_E_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(HWater) {K},  !- Name
    dT_HW_Hepta_E_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(CWater) {K},  !- Name
    dT_CW_Hepta_E_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_E_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_E_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_E_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_E_W_TempDiff, !- Name
    Set dT_W_Hepta_E_W  = 0, !- Program Line 1
    Set dT_HW_Hepta_E_W = 0, !- Program Line 2
    Set dT_CW_Hepta_E_W = 0, !- <none>
    Set dT_WA_Hepta_E_W  = 0,!- <none>
    Set dT_HWA_Hepta_E_W = 0,!- <none>
    Set dT_CWA_Hepta_E_W = 0,!- <none>
    Set dT_W_Hepta_E_W    = (t_NodeIn_Hepta_E_W - t_NodeOut_Hepta_E_W),  !- <none>
    Set dT_WA_Hepta_E_W = (t_NodeIn_Hepta_E_W + t_NodeOut_Hepta_E_W) / 2,  !- <none>
    Set dT_WA_Hepta_E_W = dT_WA_Hepta_E_W - t_AirNode_Zone_E_W,  !- <none>
    IF (dT_W_Hepta_E_W > 0), !- <none>
    Set dT_HW_Hepta_E_W    = dT_W_Hepta_E_W,  !- <none>
    Set dT_HWA_Hepta_E_W = dT_WA_Hepta_E_W,  !- <none>
    Set dT_HW_Hepta_E_W_Num = dT_HW_Hepta_E_W_Num + 1,  !- <none>
    Set dT_HW_Hepta_E_W_Sum = dT_HW_Hepta_E_W_Sum + dT_HW_Hepta_E_W,  !- <none>
    Set dT_HW_Hepta_E_W_Avg = dT_HW_Hepta_E_W_Sum / dT_HW_Hepta_E_W_Num,  !- <none>
    Set dT_HWA_Hepta_E_W_Num = dT_HWA_Hepta_E_W_Num + 1,  !- <none>
    Set dT_HWA_Hepta_E_W_Sum = dT_HWA_Hepta_E_W_Sum + dT_HWA_Hepta_E_W,  !- <none>
    Set dT_HWA_Hepta_E_W_Avg = dT_HWA_Hepta_E_W_Sum / dT_HWA_Hepta_E_W_Num,  !- <none>
    ELSEIF (dT_W_Hepta_E_W < 0),  !- <none>
    Set dT_CW_Hepta_E_W    = 0.0 - dT_W_Hepta_E_W,  !- <none>
    Set dT_CWA_Hepta_E_W = 0.0 - dT_WA_Hepta_E_W,  !- <none>
    Set dT_CW_Hepta_E_W_Num = dT_CW_Hepta_E_W_Num + 1,  !- <none>
    Set dT_CW_Hepta_E_W_Sum = dT_CW_Hepta_E_W_Sum + dT_CW_Hepta_E_W,  !- <none>
    Set dT_CW_Hepta_E_W_Avg = dT_CW_Hepta_E_W_Sum / dT_CW_Hepta_E_W_Num,  !- <none>
    Set dT_CWA_Hepta_E_W_Num = dT_CWA_Hepta_E_W_Num + 1,  !- <none>
    Set dT_CWA_Hepta_E_W_Sum = dT_CWA_Hepta_E_W_Sum + dT_CWA_Hepta_E_W,  !- <none>
    Set dT_CWA_Hepta_E_W_Avg = dT_CWA_Hepta_E_W_Sum / dT_CWA_Hepta_E_W_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_E_W;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_E_W,  !- Name
    Run InitConvCoeff_Sf_Zone_E_W,  !- Program Line 1
    IF (dT_W_Hepta_E_W > 0), !- Program Line 2
    IF (dT_HWA_Hepta_E_W <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_W = (6.12 + (0.18 * (dT_HWA_Hepta_E_W^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_W,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_E_W < 0),  !- <none>
    IF (dT_CWA_Hepta_E_W <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_E_W = 6.12 + (2.76 * (dT_CWA_Hepta_E_W^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_E_W,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_E_W,  !- Name
    Set ConvCoeff_Hepta_Ceiling_E_W_1  = Null,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_E_W_2  = Null;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_E_W,!- Name
    Set ConvCoeff_Hepta_Ceiling_E_W_1  = ConvCoeffToSet_Hepta_E_W,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_E_W_2  = ConvCoeffToSet_Hepta_E_W;  !- Program Line 2

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_E_W,     !- Name
    LowTempRadiantVarFlow_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_E_W,     !- Name
    LowTempRadiantVarFlow_Hepta_E_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_E_W_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_E_W_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_E_W_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_E_W_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_E_W_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_E_W_Num  = 0,  !- <none>
    Set dT_CW_Hepta_E_W_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_E_W_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_E_W_Num = 0,  !- <none>
    Set dT_HWA_Hepta_E_W_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_E_W_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_E_W_Num = 0,  !- <none>
    Set dT_CWA_Hepta_E_W_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_W_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_W_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_E_W_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_E_W_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_W_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_W_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_E_W_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_E_W_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_W_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_W_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_E_W_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_E_W_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_W_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_W_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_E_W_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_E_W: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_E_W_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_F_CORE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_CORE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_CORE,  !- Name
    Zone_F_CORE,             !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_CORE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_CORE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_CORE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_CORE,  !- Name
    Schedule_TemperatureMinimum_Zone_F_CORE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_CORE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_CORE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_CORE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_CORE,  !- Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 1 Object Type
    WaterConvective_F_CORE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1;                       !- Zone Equipment 1 Heating or No-Load Sequence

  ZoneHVAC:EquipmentConnections,
    Zone_F_CORE,             !- Zone Name
    ZoneHvacEquipmentList_F_CORE,  !- Zone Conditioning Equipment List Name
    ,                        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_CORE, !- Zone Air Node Name
    AirNode_F_CORE_Outlet;   !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_CORE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_CORE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_CORE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_CORE,  !- Name
    Set Heating_Energy_Zone_F_CORE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_CORE = Heating_Energy_Zone_F_CORE + Q_Heating_WaterConvective_F_CORE;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_CORE,  !- Name
    Set Cooling_Energy_Zone_F_CORE = 0;  !- Program Line 1

! ====================================================================================================
! ===     CONVECTOR F_CORE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 1332 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_CORE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_F_CORE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_F_CORE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_F_CORE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    106.559997559,           !- U-Factor Times Area Value {W/K}
    0.10622010E-03,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_F_CORE,  !- Name
    0.10622010E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_F_CORE,  !- Component 1 Name
    Node_HwDemand_WaterConvective_F_CORE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_F_CORE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_F_CORE,  !- Name
    WaterConvective_F_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_F_CORE,    !- Name
    WaterConvective_F_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_F_CORE,   !- Name
    WaterConvective_F_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_F_CORE, !- Name
    WaterConvective_F_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_F_CORE,!- Name
    WaterConvective_F_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_CORE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_CORE;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_F_CORE;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_CORE: dT(HWater) {K},  !- Name
    dT_HW_Conv_F_CORE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_CORE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_F_CORE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_CORE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_F_CORE,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_F_CORE_TempDiff,  !- Name
    Set dT_HW_Conv_F_CORE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_F_CORE = 0,  !- Program Line 2
    Set dT_HWA_Conv_F_CORE   = 0,  !- <none>
    Set dT_HW_Conv_F_CORE    = t_NodeIn_Conv_F_CORE - t_NodeOut_Conv_F_CORE,  !- <none>
    IF (dT_HW_Conv_F_CORE > 0),  !- <none>
    Set t_AvgAir_Conv_F_CORE = t_AirNodeOut_Conv_F_CORE + t_AirNodeIn_Conv_F_CORE,  !- <none>
    Set t_AvgAir_Conv_F_CORE = t_AvgAir_Conv_F_CORE / 2,  !- <none>
    Set dT_HWA_Conv_F_CORE = t_NodeOut_Conv_F_CORE + t_NodeIn_Conv_F_CORE,  !- <none>
    Set dT_HWA_Conv_F_CORE = dT_HWA_Conv_F_CORE / 2,  !- <none>
    Set dT_HWA_Conv_F_CORE = dT_HWA_Conv_F_CORE - t_AvgAir_Conv_F_CORE,  !- <none>
    Set dT_HW_Conv_F_CORE_Num = dT_HW_Conv_F_CORE_Num + 1,  !- <none>
    Set dT_HW_Conv_F_CORE_Sum = dT_HW_Conv_F_CORE_Sum + dT_HW_Conv_F_CORE,  !- <none>
    Set dT_HW_Conv_F_CORE_Avg = dT_HW_Conv_F_CORE_Sum / dT_HW_Conv_F_CORE_Num,  !- <none>
    Set dT_HWA_Conv_F_CORE_Num = dT_HWA_Conv_F_CORE_Num + 1,  !- <none>
    Set dT_HWA_Conv_F_CORE_Sum = dT_HWA_Conv_F_CORE_Sum + dT_HWA_Conv_F_CORE,  !- <none>
    Set dT_HWA_Conv_F_CORE_Avg = dT_HWA_Conv_F_CORE_Sum / dT_HWA_Conv_F_CORE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_F_CORE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_F_CORE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_F_CORE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_F_CORE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_F_CORE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_F_CORE_Num = 0,  !- <none>
    Set dT_HWA_Conv_F_CORE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_CORE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_CORE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_CORE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_CORE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_F_CORE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_CORE_Sum;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_CORE_Num;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_CORE_Avg;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_CORE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_F_CORE_Avg,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_F_E
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_E { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_E,  !- Name
    Zone_F_E,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_E,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_E;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_E,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_E,  !- Name
    Schedule_TemperatureMinimum_Zone_F_E,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_E;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_E,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_E,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_E,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_F_E,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_F_E,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_F_E,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_E_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_F_E,                !- Zone Name
    ZoneHvacEquipmentList_F_E,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_F_E,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_E,    !- Zone Air Node Name
    AirNode_F_E_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_E =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_E; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_E Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_E, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_E; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_E Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_E, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_E,  !- Name
    Set Heating_Energy_Zone_F_E = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_E = Heating_Energy_Zone_F_E + Q_Heating_Abx_F_E,  !- Program Line 2
    Set Heating_Energy_Zone_F_E = Heating_Energy_Zone_F_E + Q_Heating_Hepta_F_E;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_E,  !- Name
    Set Cooling_Energy_Zone_F_E = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_F_E = Cooling_Energy_Zone_F_E + Q_Cooling_Abx_F_E,  !- Program Line 2
    Set Cooling_Energy_Zone_F_E = Cooling_Energy_Zone_F_E + Q_Cooling_Hepta_F_E;  !- <none>

! ====================================================================================================
! ===     AIRBOX F_E
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 6 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = F_E { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_F_E,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_F_E,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_F_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_F_E,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_F_E;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_F_E,  !- Name
    Schedule_Availability_Abx_F_E;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_F_E,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_F_E,  !- Name
    Schedule_Availability_Abx_F_E,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.156749994,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.106699988,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_F_E_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_F_E,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_F_E_FanAvail,     !- Name
    Schedule_Availability_Abx_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_F_E_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_F_E_Fan,         !- Name
    FanVariableVolume_Abx_F_E,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_F_E,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_F_E_Fan = 0, !- Program Line 2
    IF (Is_Abx_F_E_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_F_E > 0.1),  !- <none>
    Set MFR_Abx_F_E_Fan =    0.156749994 * rho_Abx_F_E_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_E_Fan =    0.106699988 * rho_Abx_F_E_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_E_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_F_E_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_F_E_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_F_E_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_F_E,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_F_E_SupplyAir = t_Abx_F_E_WaterSupply - t_Abx_F_E_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_F_E_SupplyAir = 0.794871807 * TempSP_Abx_F_E_SupplyAir,  !- <none>
    Set TempSP_Abx_F_E_SupplyAir = t_Abx_F_E_OutdoorAir + TempSP_Abx_F_E_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_F_E_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_F_E,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    248.160003662,           !- U-Factor Times Area Value {W/K}
    0.22488036E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_E_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    5640,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_F_E,  !- Name
    0.22488036E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_F_E,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_F_E,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.22488036E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_F_E,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.16148326E-03,          !- Design Water Flow Rate {m3/s}
    0.166666672,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_E_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_E_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_F_E,  !- Name
    0.24222491E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_F_E,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_F_E,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.24222491E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_E_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_F_E,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_F_E;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_F_E,  !- Name
    AirBranch_Abx_F_E;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_F_E,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_F_E; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_F_E, !- Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_F_E,!- Name
    ControllerList_Abx_F_E_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_F_E,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_F_E;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_F_E,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_OutdoorInlet,  !- Actuator Node Name
    0.106699988,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.156749994,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_E_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_F_E;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_F_E,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_E_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_F_E;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_F_E,  !- Name
    Schedule_Availability_Abx_F_E,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_F_E_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_E_Inlet,  !- Air Inlet Node Name
    0.156749994,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.106699988;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_F_E,         !- Name
    ControllerList_Abx_F_E_Coils,  !- Controller List Name
    AvailabilityList_Abx_F_E,!- Availability Manager List Name
    0.156749994,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_F_E,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_F_E_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_F_E_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_F_E_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_F_E,       !- Name
    0.156749994,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_F_E,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_F_E_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_F_E,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_E_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_F_E,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_F_E_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_E_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_F_E,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_F_E_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_F_E,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_E_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_E_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_F_E,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_E_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_F_E;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_F_E,!- Name
    AirNode_AirLoopReturnPath_Abx_F_E_Outlet,  !- Outlet Node Name
    AirNode_F_E_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_F_E,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_E_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_F_E;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_E,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_E_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_E;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_F_E,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_F_E,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_F_E,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_F_E,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_F_E,     !- Name
    AirNode_OutdoorAirMixer_Abx_F_E_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_F_E,    !- Name
    AirNode_WaterCoolingCoil_Abx_F_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_F_E,         !- Name
    AirNode_FanVariableVolume_Abx_F_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_E;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_E;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_F_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(HWater) {K}, !- Name
    dT_HW_Abx_F_E,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(CWater) {K}, !- Name
    dT_CW_Abx_F_E,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_F_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_F_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_F_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_F_E_TempDiff,   !- Name
    Set dT_HW_Abx_F_E  = 0,  !- Program Line 1
    Set dT_CW_Abx_F_E = 0,   !- Program Line 2
    Set t_AvgAir_Abx_F_E = 0,!- <none>
    Set dT_HWA_Abx_F_E  = 0, !- <none>
    Set dT_CWA_Abx_F_E = 0,  !- <none>
    IF (MFR_Air_Abx_F_E > 0),!- <none>
    Set t_AvgAir_Abx_F_E = t_AirNodeOut_Abx_F_E + t_AirNodeIn_Abx_F_E,  !- <none>
    Set t_AvgAir_Abx_F_E = t_AvgAir_Abx_F_E / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_F_E = t_NodeIn_AbxHC_F_E - t_NodeOut_AbxHC_F_E,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_F_E = t_NodeOut_AbxCC_F_E - t_NodeIn_AbxCC_F_E,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_F_E <> 0), !- <none>
    IF (dT_HW_Abx_F_E < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_F_E = t_NodeOut_AbxHC_F_E + t_NodeIn_AbxHC_F_E,  !- <none>
    Set dT_HWA_Abx_F_E = dT_HWA_Abx_F_E / 2,  !- <none>
    Set dT_HWA_Abx_F_E = dT_HWA_Abx_F_E - t_AvgAir_Abx_F_E,  !- <none>
    Set dT_HW_Abx_F_E_Num = dT_HW_Abx_F_E_Num + 1,  !- <none>
    Set dT_HW_Abx_F_E_Sum = dT_HW_Abx_F_E_Sum + dT_HW_Abx_F_E,  !- <none>
    Set dT_HW_Abx_F_E_Avg = dT_HW_Abx_F_E_Sum / dT_HW_Abx_F_E_Num,  !- <none>
    Set dT_HWA_Abx_F_E_Num = dT_HWA_Abx_F_E_Num + 1,  !- <none>
    Set dT_HWA_Abx_F_E_Sum = dT_HWA_Abx_F_E_Sum + dT_HWA_Abx_F_E,  !- <none>
    Set dT_HWA_Abx_F_E_Avg = dT_HWA_Abx_F_E_Sum / dT_HWA_Abx_F_E_Num,  !- <none>
    ELSEIF (dT_CW_Abx_F_E <> 0),  !- <none>
    IF (dT_CW_Abx_F_E < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_F_E = t_NodeIn_AbxCC_F_E + t_NodeOut_AbxCC_F_E,  !- <none>
    Set dT_CWA_Abx_F_E = dT_CWA_Abx_F_E / 2,  !- <none>
    Set dT_CWA_Abx_F_E = dT_CWA_Abx_F_E - t_AvgAir_Abx_F_E,  !- <none>
    Set dT_CW_Abx_F_E_Num = dT_CW_Abx_F_E_Num + 1,  !- <none>
    Set dT_CW_Abx_F_E_Sum = dT_CW_Abx_F_E_Sum + dT_CW_Abx_F_E,  !- <none>
    Set dT_CW_Abx_F_E_Avg = dT_CW_Abx_F_E_Sum / dT_CW_Abx_F_E_Num,  !- <none>
    Set dT_CWA_Abx_F_E_Num = dT_CWA_Abx_F_E_Num + 1,  !- <none>
    Set dT_CWA_Abx_F_E_Sum = dT_CWA_Abx_F_E_Sum + dT_CWA_Abx_F_E,  !- <none>
    Set dT_CWA_Abx_F_E_Avg = dT_CWA_Abx_F_E_Sum / dT_CWA_Abx_F_E_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_F_E,       !- Name
    WaterHeatingCoil_Abx_F_E,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_F_E,       !- Name
    WaterCoolingCoil_Abx_F_E,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_F_E_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_F_E_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_F_E_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_F_E_Avg  = 0,  !- <none>
    Set dT_CW_Abx_F_E_Sum  = 0,  !- <none>
    Set dT_CW_Abx_F_E_Num  = 0,  !- <none>
    Set dT_CW_Abx_F_E_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_F_E_Sum = 0,  !- <none>
    Set dT_HWA_Abx_F_E_Num = 0,  !- <none>
    Set dT_HWA_Abx_F_E_Avg = 0,  !- <none>
    Set dT_CWA_Abx_F_E_Sum = 0,  !- <none>
    Set dT_CWA_Abx_F_E_Num = 0,  !- <none>
    Set dT_CWA_Abx_F_E_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_E_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_E_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_E_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_F_E_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_E_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_E_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_E_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_F_E_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_E_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_E_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_E_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_F_E_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_E_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_E_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_E_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_E: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_F_E_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL F_E
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling F_E.1 Hepta, 0.17, Ceiling F_E.2 Hepta, 0.66, Ceiling F_E.3 Hepta, 0.17 { },
! ===         HEPTAPANELTOTALCOOLINGPOWER = 2202 {W}, HEPTAPANELTOTALHEATINGPOWER = 4236 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_E { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_F_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_F_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_F_E,  !- Name
    Ceiling F_E.1 Hepta,     !- Surface 1 Name
    0.17,                    !- Flow Fraction for Surface 1
    Ceiling F_E.2 Hepta,     !- Surface 2 Name
    0.66,                    !- Flow Fraction for Surface 2
    Ceiling F_E.3 Hepta,     !- Surface 3 Name
    0.17;                    !- Flow Fraction for Surface 3

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_F_E,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_F_E,                !- Zone Name
    LowTempRadiantSurfaceGroup_F_E,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.25334925E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_E_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_E_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_F_E,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.13169856E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_E_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_E_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_F_E,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Name
    0.25334925E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_E,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_E_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_E,  !- Name
    0.13169856E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_E,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_E_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_F_E,      !- Name
    AirNode_ZoneNode_F_E,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_F_E,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_F_E,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_F_E,           !- Name
    LowTempRadiantVarFlow_Hepta_F_E,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_F_E,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_E = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_F_E,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_E = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_F_E < t_Sp_Heating_Hepta_F_E + 0.07 ),  !- <none>
    Set MFR_Hepta_F_E =   0.253349274,  !- <none>
    ELSEIF (t_AirNode_Zone_F_E > t_Sp_Cooling_Hepta_F_E - 0.07 ),  !- <none>
    Set MFR_Hepta_F_E =   0.131698564,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_F_E,      !- Name
    LowTempRadiantVarFlow_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_F_E,     !- Name
    LowTempRadiantVarFlow_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_F_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_F_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(Water) {K},!- Name
    dT_W_Hepta_F_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(HWater) {K},  !- Name
    dT_HW_Hepta_F_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(CWater) {K},  !- Name
    dT_CW_Hepta_F_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_F_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_F_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_F_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_F_E_TempDiff, !- Name
    Set dT_W_Hepta_F_E  = 0, !- Program Line 1
    Set dT_HW_Hepta_F_E = 0, !- Program Line 2
    Set dT_CW_Hepta_F_E = 0, !- <none>
    Set dT_WA_Hepta_F_E  = 0,!- <none>
    Set dT_HWA_Hepta_F_E = 0,!- <none>
    Set dT_CWA_Hepta_F_E = 0,!- <none>
    Set dT_W_Hepta_F_E    = (t_NodeIn_Hepta_F_E - t_NodeOut_Hepta_F_E),  !- <none>
    Set dT_WA_Hepta_F_E = (t_NodeIn_Hepta_F_E + t_NodeOut_Hepta_F_E) / 2,  !- <none>
    Set dT_WA_Hepta_F_E = dT_WA_Hepta_F_E - t_AirNode_Zone_F_E,  !- <none>
    IF (dT_W_Hepta_F_E > 0), !- <none>
    Set dT_HW_Hepta_F_E    = dT_W_Hepta_F_E,  !- <none>
    Set dT_HWA_Hepta_F_E = dT_WA_Hepta_F_E,  !- <none>
    Set dT_HW_Hepta_F_E_Num = dT_HW_Hepta_F_E_Num + 1,  !- <none>
    Set dT_HW_Hepta_F_E_Sum = dT_HW_Hepta_F_E_Sum + dT_HW_Hepta_F_E,  !- <none>
    Set dT_HW_Hepta_F_E_Avg = dT_HW_Hepta_F_E_Sum / dT_HW_Hepta_F_E_Num,  !- <none>
    Set dT_HWA_Hepta_F_E_Num = dT_HWA_Hepta_F_E_Num + 1,  !- <none>
    Set dT_HWA_Hepta_F_E_Sum = dT_HWA_Hepta_F_E_Sum + dT_HWA_Hepta_F_E,  !- <none>
    Set dT_HWA_Hepta_F_E_Avg = dT_HWA_Hepta_F_E_Sum / dT_HWA_Hepta_F_E_Num,  !- <none>
    ELSEIF (dT_W_Hepta_F_E < 0),  !- <none>
    Set dT_CW_Hepta_F_E    = 0.0 - dT_W_Hepta_F_E,  !- <none>
    Set dT_CWA_Hepta_F_E = 0.0 - dT_WA_Hepta_F_E,  !- <none>
    Set dT_CW_Hepta_F_E_Num = dT_CW_Hepta_F_E_Num + 1,  !- <none>
    Set dT_CW_Hepta_F_E_Sum = dT_CW_Hepta_F_E_Sum + dT_CW_Hepta_F_E,  !- <none>
    Set dT_CW_Hepta_F_E_Avg = dT_CW_Hepta_F_E_Sum / dT_CW_Hepta_F_E_Num,  !- <none>
    Set dT_CWA_Hepta_F_E_Num = dT_CWA_Hepta_F_E_Num + 1,  !- <none>
    Set dT_CWA_Hepta_F_E_Sum = dT_CWA_Hepta_F_E_Sum + dT_CWA_Hepta_F_E,  !- <none>
    Set dT_CWA_Hepta_F_E_Avg = dT_CWA_Hepta_F_E_Sum / dT_CWA_Hepta_F_E_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_F_E;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_F_E,  !- Name
    Run InitConvCoeff_Sf_Zone_F_E,  !- Program Line 1
    IF (dT_W_Hepta_F_E > 0), !- Program Line 2
    IF (dT_HWA_Hepta_F_E <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_E = (6.12 + (0.18 * (dT_HWA_Hepta_F_E^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_E,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_F_E < 0),  !- <none>
    IF (dT_CWA_Hepta_F_E <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_E = 6.12 + (2.76 * (dT_CWA_Hepta_F_E^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_E,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_F_E,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_E_1  = Null,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_E_2  = Null,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_E_3  = Null;  !- <none>

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_F_E,!- Name
    Set ConvCoeff_Hepta_Ceiling_F_E_1  = ConvCoeffToSet_Hepta_F_E,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_E_2  = ConvCoeffToSet_Hepta_F_E,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_E_3  = ConvCoeffToSet_Hepta_F_E;  !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_F_E,     !- Name
    LowTempRadiantVarFlow_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_F_E,     !- Name
    LowTempRadiantVarFlow_Hepta_F_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_F_E_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_F_E_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_F_E_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_F_E_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_F_E_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_F_E_Num  = 0,  !- <none>
    Set dT_CW_Hepta_F_E_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_F_E_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_F_E_Num = 0,  !- <none>
    Set dT_HWA_Hepta_F_E_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_F_E_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_F_E_Num = 0,  !- <none>
    Set dT_CWA_Hepta_F_E_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_E_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_E_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_E_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_F_E_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_E_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_E_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_E_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_F_E_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_E_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_E_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_E_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_F_E_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_E_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_E_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_E_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_E: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_F_E_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_F_NE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_NE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_NE,  !- Name
    Zone_F_NE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_NE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_NE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_NE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_NE,  !- Name
    Schedule_TemperatureMinimum_Zone_F_NE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_NE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_NE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_NE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_NE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_F_NE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_F_NE,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_F_NE, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_F_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_F_NE,               !- Zone Name
    ZoneHvacEquipmentList_F_NE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_F_NE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_NE,   !- Zone Air Node Name
    AirNode_F_NE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_NE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_NE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_NE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_NE,  !- Name
    Set Heating_Energy_Zone_F_NE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_NE = Heating_Energy_Zone_F_NE + Q_Heating_Abx_F_NE,  !- Program Line 2
    Set Heating_Energy_Zone_F_NE = Heating_Energy_Zone_F_NE + Q_Heating_Hepta_F_NE,  !- <none>
    Set Heating_Energy_Zone_F_NE = Heating_Energy_Zone_F_NE + Q_Heating_WaterConvective_F_NE,  !- <none>
    Set Heating_Energy_Zone_F_NE = Heating_Energy_Zone_F_NE + Q_Heating_RecircAbx_F_NE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_NE,  !- Name
    Set Cooling_Energy_Zone_F_NE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_F_NE = Cooling_Energy_Zone_F_NE + Q_Cooling_Abx_F_NE,  !- Program Line 2
    Set Cooling_Energy_Zone_F_NE = Cooling_Energy_Zone_F_NE + Q_Cooling_Hepta_F_NE;  !- <none>

! ====================================================================================================
! ===     AIRBOX F_NE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 1 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = F_NE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_F_NE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_F_NE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_F_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_F_NE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_F_NE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_F_NE,  !- Name
    Schedule_Availability_Abx_F_NE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_F_NE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_F_NE,  !- Name
    Schedule_Availability_Abx_F_NE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.026125001,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.017783334,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_F_NE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_F_NE_FanAvail,    !- Name
    Schedule_Availability_Abx_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_F_NE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_F_NE_Fan,        !- Name
    FanVariableVolume_Abx_F_NE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_F_NE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_F_NE_Fan = 0,!- Program Line 2
    IF (Is_Abx_F_NE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_F_NE > 0.1),  !- <none>
    Set MFR_Abx_F_NE_Fan =    0.026125001 * rho_Abx_F_NE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_NE_Fan =    0.017783334 * rho_Abx_F_NE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_NE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_F_NE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_F_NE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_F_NE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_F_NE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_F_NE_SupplyAir = t_Abx_F_NE_WaterSupply - t_Abx_F_NE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_F_NE_SupplyAir = 0.794871807 * TempSP_Abx_F_NE_SupplyAir,  !- <none>
    Set TempSP_Abx_F_NE_SupplyAir = t_Abx_F_NE_OutdoorAir + TempSP_Abx_F_NE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_F_NE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_F_NE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    41.360000610,            !- U-Factor Times Area Value {W/K}
    0.37480062E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    940,                     !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NE,  !- Name
    0.37480062E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_F_NE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_F_NE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.37480062E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_F_NE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.26913878E-04,          !- Design Water Flow Rate {m3/s}
    0.027777778,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NE,  !- Name
    0.40370811E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_F_NE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_F_NE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.40370811E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_NE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_F_NE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_F_NE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_F_NE, !- Name
    AirBranch_Abx_F_NE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_F_NE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_F_NE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_F_NE,!- Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_F_NE,  !- Name
    ControllerList_Abx_F_NE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_F_NE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_F_NE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_F_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_OutdoorInlet,  !- Actuator Node Name
    0.017783334,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.026125001,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_NE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_F_NE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_F_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_F_NE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_F_NE,  !- Name
    Schedule_Availability_Abx_F_NE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NE_Inlet,  !- Air Inlet Node Name
    0.026125001,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.017783334;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_F_NE,        !- Name
    ControllerList_Abx_F_NE_Coils,  !- Controller List Name
    AvailabilityList_Abx_F_NE,  !- Availability Manager List Name
    0.026125001,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_F_NE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_F_NE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_F_NE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_F_NE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_F_NE,      !- Name
    0.026125001,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_F_NE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_F_NE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_F_NE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_F_NE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_F_NE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_F_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_NE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_F_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_NE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_F_NE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_F_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_NE_Outlet,  !- Outlet Node Name
    AirNode_F_NE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_F_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_NE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_F_NE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_NE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_NE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_F_NE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_F_NE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_F_NE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_F_NE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_F_NE,    !- Name
    AirNode_OutdoorAirMixer_Abx_F_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_F_NE,   !- Name
    AirNode_WaterCoolingCoil_Abx_F_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_F_NE,        !- Name
    AirNode_FanVariableVolume_Abx_F_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_F_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(HWater) {K},!- Name
    dT_HW_Abx_F_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(CWater) {K},!- Name
    dT_CW_Abx_F_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_F_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_F_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_F_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_F_NE_TempDiff,  !- Name
    Set dT_HW_Abx_F_NE  = 0, !- Program Line 1
    Set dT_CW_Abx_F_NE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_F_NE = 0,  !- <none>
    Set dT_HWA_Abx_F_NE  = 0,!- <none>
    Set dT_CWA_Abx_F_NE = 0, !- <none>
    IF (MFR_Air_Abx_F_NE > 0),  !- <none>
    Set t_AvgAir_Abx_F_NE = t_AirNodeOut_Abx_F_NE + t_AirNodeIn_Abx_F_NE,  !- <none>
    Set t_AvgAir_Abx_F_NE = t_AvgAir_Abx_F_NE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_F_NE = t_NodeIn_AbxHC_F_NE - t_NodeOut_AbxHC_F_NE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_F_NE = t_NodeOut_AbxCC_F_NE - t_NodeIn_AbxCC_F_NE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_F_NE <> 0),!- <none>
    IF (dT_HW_Abx_F_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_F_NE = t_NodeOut_AbxHC_F_NE + t_NodeIn_AbxHC_F_NE,  !- <none>
    Set dT_HWA_Abx_F_NE = dT_HWA_Abx_F_NE / 2,  !- <none>
    Set dT_HWA_Abx_F_NE = dT_HWA_Abx_F_NE - t_AvgAir_Abx_F_NE,  !- <none>
    Set dT_HW_Abx_F_NE_Num = dT_HW_Abx_F_NE_Num + 1,  !- <none>
    Set dT_HW_Abx_F_NE_Sum = dT_HW_Abx_F_NE_Sum + dT_HW_Abx_F_NE,  !- <none>
    Set dT_HW_Abx_F_NE_Avg = dT_HW_Abx_F_NE_Sum / dT_HW_Abx_F_NE_Num,  !- <none>
    Set dT_HWA_Abx_F_NE_Num = dT_HWA_Abx_F_NE_Num + 1,  !- <none>
    Set dT_HWA_Abx_F_NE_Sum = dT_HWA_Abx_F_NE_Sum + dT_HWA_Abx_F_NE,  !- <none>
    Set dT_HWA_Abx_F_NE_Avg = dT_HWA_Abx_F_NE_Sum / dT_HWA_Abx_F_NE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_F_NE <> 0),  !- <none>
    IF (dT_CW_Abx_F_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_F_NE = t_NodeIn_AbxCC_F_NE + t_NodeOut_AbxCC_F_NE,  !- <none>
    Set dT_CWA_Abx_F_NE = dT_CWA_Abx_F_NE / 2,  !- <none>
    Set dT_CWA_Abx_F_NE = dT_CWA_Abx_F_NE - t_AvgAir_Abx_F_NE,  !- <none>
    Set dT_CW_Abx_F_NE_Num = dT_CW_Abx_F_NE_Num + 1,  !- <none>
    Set dT_CW_Abx_F_NE_Sum = dT_CW_Abx_F_NE_Sum + dT_CW_Abx_F_NE,  !- <none>
    Set dT_CW_Abx_F_NE_Avg = dT_CW_Abx_F_NE_Sum / dT_CW_Abx_F_NE_Num,  !- <none>
    Set dT_CWA_Abx_F_NE_Num = dT_CWA_Abx_F_NE_Num + 1,  !- <none>
    Set dT_CWA_Abx_F_NE_Sum = dT_CWA_Abx_F_NE_Sum + dT_CWA_Abx_F_NE,  !- <none>
    Set dT_CWA_Abx_F_NE_Avg = dT_CWA_Abx_F_NE_Sum / dT_CWA_Abx_F_NE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_F_NE,      !- Name
    WaterHeatingCoil_Abx_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_F_NE,      !- Name
    WaterCoolingCoil_Abx_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_F_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_F_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_F_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_F_NE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_F_NE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_F_NE_Num  = 0,  !- <none>
    Set dT_CW_Abx_F_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_F_NE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_F_NE_Num = 0,  !- <none>
    Set dT_HWA_Abx_F_NE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_F_NE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_F_NE_Num = 0,  !- <none>
    Set dT_CWA_Abx_F_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_F_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_F_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_F_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_F_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL F_NE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling F_NE Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 367 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 706 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_NE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_F_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_F_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_F_NE,  !- Name
    Ceiling F_NE Hepta,      !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_F_NE,               !- Zone Name
    LowTempRadiantSurfaceGroup_F_NE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.42224885E-04,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_F_NE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.21949765E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_F_NE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Name
    0.42224885E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE,  !- Name
    0.21949765E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_F_NE,     !- Name
    AirNode_ZoneNode_F_NE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_F_NE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_F_NE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_F_NE,          !- Name
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_F_NE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_NE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_F_NE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_NE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_F_NE < t_Sp_Heating_Hepta_F_NE + 0.07 ),  !- <none>
    Set MFR_Hepta_F_NE =   0.042224880,  !- <none>
    ELSEIF (t_AirNode_Zone_F_NE > t_Sp_Cooling_Hepta_F_NE - 0.07 ),  !- <none>
    Set MFR_Hepta_F_NE =   0.021949761,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_F_NE,     !- Name
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_F_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_F_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_F_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(Water) {K},  !- Name
    dT_W_Hepta_F_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_F_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_F_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_F_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_F_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_F_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_F_NE_TempDiff,!- Name
    Set dT_W_Hepta_F_NE  = 0,!- Program Line 1
    Set dT_HW_Hepta_F_NE = 0,!- Program Line 2
    Set dT_CW_Hepta_F_NE = 0,!- <none>
    Set dT_WA_Hepta_F_NE  = 0,  !- <none>
    Set dT_HWA_Hepta_F_NE = 0,  !- <none>
    Set dT_CWA_Hepta_F_NE = 0,  !- <none>
    Set dT_W_Hepta_F_NE    = (t_NodeIn_Hepta_F_NE - t_NodeOut_Hepta_F_NE),  !- <none>
    Set dT_WA_Hepta_F_NE = (t_NodeIn_Hepta_F_NE + t_NodeOut_Hepta_F_NE) / 2,  !- <none>
    Set dT_WA_Hepta_F_NE = dT_WA_Hepta_F_NE - t_AirNode_Zone_F_NE,  !- <none>
    IF (dT_W_Hepta_F_NE > 0),!- <none>
    Set dT_HW_Hepta_F_NE    = dT_W_Hepta_F_NE,  !- <none>
    Set dT_HWA_Hepta_F_NE = dT_WA_Hepta_F_NE,  !- <none>
    Set dT_HW_Hepta_F_NE_Num = dT_HW_Hepta_F_NE_Num + 1,  !- <none>
    Set dT_HW_Hepta_F_NE_Sum = dT_HW_Hepta_F_NE_Sum + dT_HW_Hepta_F_NE,  !- <none>
    Set dT_HW_Hepta_F_NE_Avg = dT_HW_Hepta_F_NE_Sum / dT_HW_Hepta_F_NE_Num,  !- <none>
    Set dT_HWA_Hepta_F_NE_Num = dT_HWA_Hepta_F_NE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_F_NE_Sum = dT_HWA_Hepta_F_NE_Sum + dT_HWA_Hepta_F_NE,  !- <none>
    Set dT_HWA_Hepta_F_NE_Avg = dT_HWA_Hepta_F_NE_Sum / dT_HWA_Hepta_F_NE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_F_NE < 0),  !- <none>
    Set dT_CW_Hepta_F_NE    = 0.0 - dT_W_Hepta_F_NE,  !- <none>
    Set dT_CWA_Hepta_F_NE = 0.0 - dT_WA_Hepta_F_NE,  !- <none>
    Set dT_CW_Hepta_F_NE_Num = dT_CW_Hepta_F_NE_Num + 1,  !- <none>
    Set dT_CW_Hepta_F_NE_Sum = dT_CW_Hepta_F_NE_Sum + dT_CW_Hepta_F_NE,  !- <none>
    Set dT_CW_Hepta_F_NE_Avg = dT_CW_Hepta_F_NE_Sum / dT_CW_Hepta_F_NE_Num,  !- <none>
    Set dT_CWA_Hepta_F_NE_Num = dT_CWA_Hepta_F_NE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_F_NE_Sum = dT_CWA_Hepta_F_NE_Sum + dT_CWA_Hepta_F_NE,  !- <none>
    Set dT_CWA_Hepta_F_NE_Avg = dT_CWA_Hepta_F_NE_Sum / dT_CWA_Hepta_F_NE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_F_NE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_F_NE, !- Name
    Run InitConvCoeff_Sf_Zone_F_NE,  !- Program Line 1
    IF (dT_W_Hepta_F_NE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_F_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_NE = (6.12 + (0.18 * (dT_HWA_Hepta_F_NE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_NE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_F_NE < 0),  !- <none>
    IF (dT_CWA_Hepta_F_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_NE = 6.12 + (2.76 * (dT_CWA_Hepta_F_NE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_NE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_F_NE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_NE  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_F_NE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_NE  = ConvCoeffToSet_Hepta_F_NE;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_F_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_F_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_F_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_F_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_F_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_F_NE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_F_NE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_F_NE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_F_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_F_NE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_F_NE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_F_NE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_F_NE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_F_NE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_F_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_F_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_F_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_F_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_F_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR F_NE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 636 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_NE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_F_NE,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_F_NE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_F_NE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    50.880001068,            !- U-Factor Times Area Value {W/K}
    0.50717706E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_F_NE,  !- Name
    0.50717706E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_F_NE,    !- Component 1 Name
    Node_HwDemand_WaterConvective_F_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_F_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_F_NE,  !- Name
    WaterConvective_F_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_F_NE,      !- Name
    WaterConvective_F_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_F_NE,     !- Name
    WaterConvective_F_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_F_NE,   !- Name
    WaterConvective_F_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_F_NE,  !- Name
    WaterConvective_F_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_F_NE;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_NE: dT(HWater) {K},  !- Name
    dT_HW_Conv_F_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_F_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_NE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_F_NE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_F_NE_TempDiff, !- Name
    Set dT_HW_Conv_F_NE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_F_NE = 0,  !- Program Line 2
    Set dT_HWA_Conv_F_NE   = 0,  !- <none>
    Set dT_HW_Conv_F_NE    = t_NodeIn_Conv_F_NE - t_NodeOut_Conv_F_NE,  !- <none>
    IF (dT_HW_Conv_F_NE > 0),!- <none>
    Set t_AvgAir_Conv_F_NE = t_AirNodeOut_Conv_F_NE + t_AirNodeIn_Conv_F_NE,  !- <none>
    Set t_AvgAir_Conv_F_NE = t_AvgAir_Conv_F_NE / 2,  !- <none>
    Set dT_HWA_Conv_F_NE = t_NodeOut_Conv_F_NE + t_NodeIn_Conv_F_NE,  !- <none>
    Set dT_HWA_Conv_F_NE = dT_HWA_Conv_F_NE / 2,  !- <none>
    Set dT_HWA_Conv_F_NE = dT_HWA_Conv_F_NE - t_AvgAir_Conv_F_NE,  !- <none>
    Set dT_HW_Conv_F_NE_Num = dT_HW_Conv_F_NE_Num + 1,  !- <none>
    Set dT_HW_Conv_F_NE_Sum = dT_HW_Conv_F_NE_Sum + dT_HW_Conv_F_NE,  !- <none>
    Set dT_HW_Conv_F_NE_Avg = dT_HW_Conv_F_NE_Sum / dT_HW_Conv_F_NE_Num,  !- <none>
    Set dT_HWA_Conv_F_NE_Num = dT_HWA_Conv_F_NE_Num + 1,  !- <none>
    Set dT_HWA_Conv_F_NE_Sum = dT_HWA_Conv_F_NE_Sum + dT_HWA_Conv_F_NE,  !- <none>
    Set dT_HWA_Conv_F_NE_Avg = dT_HWA_Conv_F_NE_Sum / dT_HWA_Conv_F_NE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_F_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_F_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_F_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_F_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_F_NE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_F_NE_Num = 0,  !- <none>
    Set dT_HWA_Conv_F_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_F_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_F_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX F_NE
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 1 {-}, ZONENAME = F_NE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_F_NE, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    465,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_F_NE,!- Name
    ElectricConvective_F_NE, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_F_NI
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_NI { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_NI,  !- Name
    Zone_F_NI,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_NI,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_NI;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_NI,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_NI,  !- Name
    Schedule_TemperatureMinimum_Zone_F_NI,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_NI;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_NI,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_NI,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_NI,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_F_NI,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 3 Object Type
    ElectricConvective_F_NI, !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3;                       !- Zone Equipment 3 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_F_NI,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NI_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_F_NI,               !- Zone Name
    ZoneHvacEquipmentList_F_NI,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_F_NI,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_NI,   !- Zone Air Node Name
    AirNode_F_NI_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_NI =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_NI;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_NI Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_NI,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_NI;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_NI Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_NI,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_NI,  !- Name
    Set Heating_Energy_Zone_F_NI = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_NI = Heating_Energy_Zone_F_NI + Q_Heating_Abx_F_NI,  !- Program Line 2
    Set Heating_Energy_Zone_F_NI = Heating_Energy_Zone_F_NI + Q_Heating_Hepta_F_NI,  !- <none>
    Set Heating_Energy_Zone_F_NI = Heating_Energy_Zone_F_NI + Q_Heating_RecircAbx_F_NI;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_NI,  !- Name
    Set Cooling_Energy_Zone_F_NI = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_F_NI = Cooling_Energy_Zone_F_NI + Q_Cooling_Abx_F_NI,  !- Program Line 2
    Set Cooling_Energy_Zone_F_NI = Cooling_Energy_Zone_F_NI + Q_Cooling_Hepta_F_NI;  !- <none>

! ====================================================================================================
! ===     AIRBOX F_NI
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 8 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = F_NI { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_F_NI,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_F_NI,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_F_NI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_F_NI,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_F_NI;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_F_NI,  !- Name
    Schedule_Availability_Abx_F_NI;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_F_NI,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_F_NI,  !- Name
    Schedule_Availability_Abx_F_NI,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.209000006,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.142266646,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_F_NI,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_F_NI_FanAvail,    !- Name
    Schedule_Availability_Abx_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_F_NI_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_F_NI_Fan,        !- Name
    FanVariableVolume_Abx_F_NI,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_F_NI,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_F_NI_Fan = 0,!- Program Line 2
    IF (Is_Abx_F_NI_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_F_NI > 0.1),  !- <none>
    Set MFR_Abx_F_NI_Fan =    0.209000006 * rho_Abx_F_NI_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_NI_Fan =    0.142266646 * rho_Abx_F_NI_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_NI_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_F_NI_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_F_NI_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_F_NI_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_F_NI,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_F_NI_SupplyAir = t_Abx_F_NI_WaterSupply - t_Abx_F_NI_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_F_NI_SupplyAir = 0.794871807 * TempSP_Abx_F_NI_SupplyAir,  !- <none>
    Set TempSP_Abx_F_NI_SupplyAir = t_Abx_F_NI_OutdoorAir + TempSP_Abx_F_NI_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_F_NI_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_F_NI,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    330.880004883,           !- U-Factor Times Area Value {W/K}
    0.29984058E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    7520,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_F_NI,  !- Name
    0.29984058E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_F_NI,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_F_NI,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.29984058E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_F_NI,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.21531101E-03,          !- Design Water Flow Rate {m3/s}
    0.222222224,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_F_NI,  !- Name
    0.32296655E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_F_NI,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_F_NI,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.32296655E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_NI_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_F_NI,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_F_NI;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_F_NI, !- Name
    AirBranch_Abx_F_NI;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_F_NI,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_F_NI;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_F_NI,!- Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_F_NI,  !- Name
    ControllerList_Abx_F_NI_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_F_NI,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_F_NI;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_F_NI,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_OutdoorInlet,  !- Actuator Node Name
    0.142266646,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.209000006,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_NI_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_F_NI;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_F_NI,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NI_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_F_NI;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_F_NI,  !- Name
    Schedule_Availability_Abx_F_NI,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NI_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NI_Inlet,  !- Air Inlet Node Name
    0.209000006,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.142266646;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_F_NI,        !- Name
    ControllerList_Abx_F_NI_Coils,  !- Controller List Name
    AvailabilityList_Abx_F_NI,  !- Availability Manager List Name
    0.209000006,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_F_NI, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_F_NI_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_F_NI_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_F_NI_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_F_NI,      !- Name
    0.209000006,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_F_NI,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_F_NI_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_F_NI,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_F_NI,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_F_NI,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_F_NI,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_NI_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_NI_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_F_NI,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_NI_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_F_NI;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_F_NI,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_NI_Outlet,  !- Outlet Node Name
    AirNode_F_NI_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_F_NI,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_NI_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_F_NI;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_NI,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_NI_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_NI;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_F_NI,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_F_NI,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_NI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_F_NI,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_F_NI,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_F_NI,    !- Name
    AirNode_OutdoorAirMixer_Abx_F_NI_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_F_NI,   !- Name
    AirNode_WaterCoolingCoil_Abx_F_NI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_F_NI,        !- Name
    AirNode_FanVariableVolume_Abx_F_NI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NI;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NI;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_F_NI;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(HWater) {K},!- Name
    dT_HW_Abx_F_NI,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(CWater) {K},!- Name
    dT_CW_Abx_F_NI,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_F_NI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_F_NI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_F_NI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_F_NI_TempDiff,  !- Name
    Set dT_HW_Abx_F_NI  = 0, !- Program Line 1
    Set dT_CW_Abx_F_NI = 0,  !- Program Line 2
    Set t_AvgAir_Abx_F_NI = 0,  !- <none>
    Set dT_HWA_Abx_F_NI  = 0,!- <none>
    Set dT_CWA_Abx_F_NI = 0, !- <none>
    IF (MFR_Air_Abx_F_NI > 0),  !- <none>
    Set t_AvgAir_Abx_F_NI = t_AirNodeOut_Abx_F_NI + t_AirNodeIn_Abx_F_NI,  !- <none>
    Set t_AvgAir_Abx_F_NI = t_AvgAir_Abx_F_NI / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_F_NI = t_NodeIn_AbxHC_F_NI - t_NodeOut_AbxHC_F_NI,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_F_NI = t_NodeOut_AbxCC_F_NI - t_NodeIn_AbxCC_F_NI,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_F_NI <> 0),!- <none>
    IF (dT_HW_Abx_F_NI < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_F_NI = t_NodeOut_AbxHC_F_NI + t_NodeIn_AbxHC_F_NI,  !- <none>
    Set dT_HWA_Abx_F_NI = dT_HWA_Abx_F_NI / 2,  !- <none>
    Set dT_HWA_Abx_F_NI = dT_HWA_Abx_F_NI - t_AvgAir_Abx_F_NI,  !- <none>
    Set dT_HW_Abx_F_NI_Num = dT_HW_Abx_F_NI_Num + 1,  !- <none>
    Set dT_HW_Abx_F_NI_Sum = dT_HW_Abx_F_NI_Sum + dT_HW_Abx_F_NI,  !- <none>
    Set dT_HW_Abx_F_NI_Avg = dT_HW_Abx_F_NI_Sum / dT_HW_Abx_F_NI_Num,  !- <none>
    Set dT_HWA_Abx_F_NI_Num = dT_HWA_Abx_F_NI_Num + 1,  !- <none>
    Set dT_HWA_Abx_F_NI_Sum = dT_HWA_Abx_F_NI_Sum + dT_HWA_Abx_F_NI,  !- <none>
    Set dT_HWA_Abx_F_NI_Avg = dT_HWA_Abx_F_NI_Sum / dT_HWA_Abx_F_NI_Num,  !- <none>
    ELSEIF (dT_CW_Abx_F_NI <> 0),  !- <none>
    IF (dT_CW_Abx_F_NI < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_F_NI = t_NodeIn_AbxCC_F_NI + t_NodeOut_AbxCC_F_NI,  !- <none>
    Set dT_CWA_Abx_F_NI = dT_CWA_Abx_F_NI / 2,  !- <none>
    Set dT_CWA_Abx_F_NI = dT_CWA_Abx_F_NI - t_AvgAir_Abx_F_NI,  !- <none>
    Set dT_CW_Abx_F_NI_Num = dT_CW_Abx_F_NI_Num + 1,  !- <none>
    Set dT_CW_Abx_F_NI_Sum = dT_CW_Abx_F_NI_Sum + dT_CW_Abx_F_NI,  !- <none>
    Set dT_CW_Abx_F_NI_Avg = dT_CW_Abx_F_NI_Sum / dT_CW_Abx_F_NI_Num,  !- <none>
    Set dT_CWA_Abx_F_NI_Num = dT_CWA_Abx_F_NI_Num + 1,  !- <none>
    Set dT_CWA_Abx_F_NI_Sum = dT_CWA_Abx_F_NI_Sum + dT_CWA_Abx_F_NI,  !- <none>
    Set dT_CWA_Abx_F_NI_Avg = dT_CWA_Abx_F_NI_Sum / dT_CWA_Abx_F_NI_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_F_NI,      !- Name
    WaterHeatingCoil_Abx_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_F_NI,      !- Name
    WaterCoolingCoil_Abx_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_F_NI_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_F_NI_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_F_NI_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_F_NI_Avg  = 0,  !- <none>
    Set dT_CW_Abx_F_NI_Sum  = 0,  !- <none>
    Set dT_CW_Abx_F_NI_Num  = 0,  !- <none>
    Set dT_CW_Abx_F_NI_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_F_NI_Sum = 0,  !- <none>
    Set dT_HWA_Abx_F_NI_Num = 0,  !- <none>
    Set dT_HWA_Abx_F_NI_Avg = 0,  !- <none>
    Set dT_CWA_Abx_F_NI_Sum = 0,  !- <none>
    Set dT_CWA_Abx_F_NI_Num = 0,  !- <none>
    Set dT_CWA_Abx_F_NI_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NI_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NI_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_NI_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_F_NI_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NI_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NI_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_NI_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_F_NI_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NI_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NI_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_NI_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_F_NI_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NI_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NI_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_NI_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_NI: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_F_NI_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL F_NI
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling F_NI.1 Hepta, 0.25, Ceiling F_NI.2 Hepta, 0.25, Ceiling F_NI.3 Hepta, 0.50 { },
! ===         HEPTAPANELTOTALCOOLINGPOWER = 3344 {W}, HEPTAPANELTOTALHEATINGPOWER = 6432 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_NI { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_F_NI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_F_NI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_F_NI,  !- Name
    Ceiling F_NI.1 Hepta,    !- Surface 1 Name
    0.25,                    !- Flow Fraction for Surface 1
    Ceiling F_NI.2 Hepta,    !- Surface 2 Name
    0.25,                    !- Flow Fraction for Surface 2
    Ceiling F_NI.3 Hepta,    !- Surface 3 Name
    0.50;                    !- Flow Fraction for Surface 3

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_F_NI,               !- Zone Name
    LowTempRadiantSurfaceGroup_F_NI,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.38468905E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_F_NI,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.20000001E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_F_NI,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Name
    0.38468905E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI,  !- Name
    0.20000001E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_NI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_F_NI,     !- Name
    AirNode_ZoneNode_F_NI,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_F_NI, !- Name
    Schedule_TemperatureSp_Heating_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_F_NI, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_F_NI,          !- Name
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_F_NI,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_NI = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_F_NI,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_NI = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_F_NI < t_Sp_Heating_Hepta_F_NI + 0.07 ),  !- <none>
    Set MFR_Hepta_F_NI =   0.384689003,  !- <none>
    ELSEIF (t_AirNode_Zone_F_NI > t_Sp_Cooling_Hepta_F_NI - 0.07 ),  !- <none>
    Set MFR_Hepta_F_NI =   0.200000003,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_F_NI,     !- Name
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_F_NI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_F_NI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_F_NI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NI;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NI;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(Water) {K},  !- Name
    dT_W_Hepta_F_NI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(HWater) {K},  !- Name
    dT_HW_Hepta_F_NI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(CWater) {K},  !- Name
    dT_CW_Hepta_F_NI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_F_NI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_F_NI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_F_NI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_F_NI_TempDiff,!- Name
    Set dT_W_Hepta_F_NI  = 0,!- Program Line 1
    Set dT_HW_Hepta_F_NI = 0,!- Program Line 2
    Set dT_CW_Hepta_F_NI = 0,!- <none>
    Set dT_WA_Hepta_F_NI  = 0,  !- <none>
    Set dT_HWA_Hepta_F_NI = 0,  !- <none>
    Set dT_CWA_Hepta_F_NI = 0,  !- <none>
    Set dT_W_Hepta_F_NI    = (t_NodeIn_Hepta_F_NI - t_NodeOut_Hepta_F_NI),  !- <none>
    Set dT_WA_Hepta_F_NI = (t_NodeIn_Hepta_F_NI + t_NodeOut_Hepta_F_NI) / 2,  !- <none>
    Set dT_WA_Hepta_F_NI = dT_WA_Hepta_F_NI - t_AirNode_Zone_F_NI,  !- <none>
    IF (dT_W_Hepta_F_NI > 0),!- <none>
    Set dT_HW_Hepta_F_NI    = dT_W_Hepta_F_NI,  !- <none>
    Set dT_HWA_Hepta_F_NI = dT_WA_Hepta_F_NI,  !- <none>
    Set dT_HW_Hepta_F_NI_Num = dT_HW_Hepta_F_NI_Num + 1,  !- <none>
    Set dT_HW_Hepta_F_NI_Sum = dT_HW_Hepta_F_NI_Sum + dT_HW_Hepta_F_NI,  !- <none>
    Set dT_HW_Hepta_F_NI_Avg = dT_HW_Hepta_F_NI_Sum / dT_HW_Hepta_F_NI_Num,  !- <none>
    Set dT_HWA_Hepta_F_NI_Num = dT_HWA_Hepta_F_NI_Num + 1,  !- <none>
    Set dT_HWA_Hepta_F_NI_Sum = dT_HWA_Hepta_F_NI_Sum + dT_HWA_Hepta_F_NI,  !- <none>
    Set dT_HWA_Hepta_F_NI_Avg = dT_HWA_Hepta_F_NI_Sum / dT_HWA_Hepta_F_NI_Num,  !- <none>
    ELSEIF (dT_W_Hepta_F_NI < 0),  !- <none>
    Set dT_CW_Hepta_F_NI    = 0.0 - dT_W_Hepta_F_NI,  !- <none>
    Set dT_CWA_Hepta_F_NI = 0.0 - dT_WA_Hepta_F_NI,  !- <none>
    Set dT_CW_Hepta_F_NI_Num = dT_CW_Hepta_F_NI_Num + 1,  !- <none>
    Set dT_CW_Hepta_F_NI_Sum = dT_CW_Hepta_F_NI_Sum + dT_CW_Hepta_F_NI,  !- <none>
    Set dT_CW_Hepta_F_NI_Avg = dT_CW_Hepta_F_NI_Sum / dT_CW_Hepta_F_NI_Num,  !- <none>
    Set dT_CWA_Hepta_F_NI_Num = dT_CWA_Hepta_F_NI_Num + 1,  !- <none>
    Set dT_CWA_Hepta_F_NI_Sum = dT_CWA_Hepta_F_NI_Sum + dT_CWA_Hepta_F_NI,  !- <none>
    Set dT_CWA_Hepta_F_NI_Avg = dT_CWA_Hepta_F_NI_Sum / dT_CWA_Hepta_F_NI_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_F_NI;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_F_NI, !- Name
    Run InitConvCoeff_Sf_Zone_F_NI,  !- Program Line 1
    IF (dT_W_Hepta_F_NI > 0),!- Program Line 2
    IF (dT_HWA_Hepta_F_NI <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_NI = (6.12 + (0.18 * (dT_HWA_Hepta_F_NI^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_NI,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_F_NI < 0),  !- <none>
    IF (dT_CWA_Hepta_F_NI <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_NI = 6.12 + (2.76 * (dT_CWA_Hepta_F_NI^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_NI,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_F_NI,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_NI_1  = Null,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_NI_2  = Null,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_NI_3  = Null;  !- <none>

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_F_NI,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_NI_1  = ConvCoeffToSet_Hepta_F_NI,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_NI_2  = ConvCoeffToSet_Hepta_F_NI,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_NI_3  = ConvCoeffToSet_Hepta_F_NI;  !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_F_NI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_F_NI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_NI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_F_NI_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_F_NI_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_F_NI_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_F_NI_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_F_NI_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_F_NI_Num  = 0,  !- <none>
    Set dT_CW_Hepta_F_NI_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_F_NI_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_F_NI_Num = 0,  !- <none>
    Set dT_HWA_Hepta_F_NI_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_F_NI_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_F_NI_Num = 0,  !- <none>
    Set dT_CWA_Hepta_F_NI_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NI_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NI_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_NI_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_F_NI_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NI_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NI_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_NI_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_F_NI_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NI_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NI_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_NI_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_F_NI_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NI_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NI_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_NI_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_NI: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_F_NI_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX F_NI
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = F_NI { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_F_NI, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_F_NI,!- Name
    ElectricConvective_F_NI, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_F_SE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_SE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_SE,  !- Name
    Zone_F_SE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_SE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_SE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_SE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_SE,  !- Name
    Schedule_TemperatureMinimum_Zone_F_SE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_SE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_SE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_SE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_SE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_F_SE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_F_SE,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_F_SE, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_F_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_F_SE,               !- Zone Name
    ZoneHvacEquipmentList_F_SE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_F_SE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_SE,   !- Zone Air Node Name
    AirNode_F_SE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_SE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_SE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_SE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_SE,  !- Name
    Set Heating_Energy_Zone_F_SE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_SE = Heating_Energy_Zone_F_SE + Q_Heating_Abx_F_SE,  !- Program Line 2
    Set Heating_Energy_Zone_F_SE = Heating_Energy_Zone_F_SE + Q_Heating_Hepta_F_SE,  !- <none>
    Set Heating_Energy_Zone_F_SE = Heating_Energy_Zone_F_SE + Q_Heating_WaterConvective_F_SE,  !- <none>
    Set Heating_Energy_Zone_F_SE = Heating_Energy_Zone_F_SE + Q_Heating_RecircAbx_F_SE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_SE,  !- Name
    Set Cooling_Energy_Zone_F_SE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_F_SE = Cooling_Energy_Zone_F_SE + Q_Cooling_Abx_F_SE,  !- Program Line 2
    Set Cooling_Energy_Zone_F_SE = Cooling_Energy_Zone_F_SE + Q_Cooling_Hepta_F_SE;  !- <none>

! ====================================================================================================
! ===     AIRBOX F_SE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 1 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = F_SE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_F_SE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_F_SE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_F_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_F_SE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_F_SE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_F_SE,  !- Name
    Schedule_Availability_Abx_F_SE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_F_SE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_F_SE,  !- Name
    Schedule_Availability_Abx_F_SE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.026125001,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.017783334,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_F_SE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_F_SE_FanAvail,    !- Name
    Schedule_Availability_Abx_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_F_SE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_F_SE_Fan,        !- Name
    FanVariableVolume_Abx_F_SE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_F_SE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_F_SE_Fan = 0,!- Program Line 2
    IF (Is_Abx_F_SE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_F_SE > 0.1),  !- <none>
    Set MFR_Abx_F_SE_Fan =    0.026125001 * rho_Abx_F_SE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_SE_Fan =    0.017783334 * rho_Abx_F_SE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_SE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_F_SE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_F_SE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_F_SE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_F_SE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_F_SE_SupplyAir = t_Abx_F_SE_WaterSupply - t_Abx_F_SE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_F_SE_SupplyAir = 0.794871807 * TempSP_Abx_F_SE_SupplyAir,  !- <none>
    Set TempSP_Abx_F_SE_SupplyAir = t_Abx_F_SE_OutdoorAir + TempSP_Abx_F_SE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_F_SE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_F_SE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    41.360000610,            !- U-Factor Times Area Value {W/K}
    0.37480062E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    940,                     !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SE,  !- Name
    0.37480062E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_F_SE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_F_SE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.37480062E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_F_SE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.26913878E-04,          !- Design Water Flow Rate {m3/s}
    0.027777778,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SE,  !- Name
    0.40370811E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_F_SE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_F_SE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.40370811E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_SE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_F_SE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_F_SE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_F_SE, !- Name
    AirBranch_Abx_F_SE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_F_SE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_F_SE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_F_SE,!- Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_F_SE,  !- Name
    ControllerList_Abx_F_SE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_F_SE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_F_SE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_F_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_OutdoorInlet,  !- Actuator Node Name
    0.017783334,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.026125001,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_SE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_F_SE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_F_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_F_SE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_F_SE,  !- Name
    Schedule_Availability_Abx_F_SE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SE_Inlet,  !- Air Inlet Node Name
    0.026125001,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.017783334;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_F_SE,        !- Name
    ControllerList_Abx_F_SE_Coils,  !- Controller List Name
    AvailabilityList_Abx_F_SE,  !- Availability Manager List Name
    0.026125001,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_F_SE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_F_SE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_F_SE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_F_SE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_F_SE,      !- Name
    0.026125001,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_F_SE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_F_SE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_F_SE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_F_SE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_F_SE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_F_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_SE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_F_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_SE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_F_SE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_F_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_SE_Outlet,  !- Outlet Node Name
    AirNode_F_SE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_F_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_SE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_F_SE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_SE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_SE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_F_SE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_F_SE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_F_SE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_F_SE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_F_SE,    !- Name
    AirNode_OutdoorAirMixer_Abx_F_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_F_SE,   !- Name
    AirNode_WaterCoolingCoil_Abx_F_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_F_SE,        !- Name
    AirNode_FanVariableVolume_Abx_F_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_F_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(HWater) {K},!- Name
    dT_HW_Abx_F_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(CWater) {K},!- Name
    dT_CW_Abx_F_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_F_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_F_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_F_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_F_SE_TempDiff,  !- Name
    Set dT_HW_Abx_F_SE  = 0, !- Program Line 1
    Set dT_CW_Abx_F_SE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_F_SE = 0,  !- <none>
    Set dT_HWA_Abx_F_SE  = 0,!- <none>
    Set dT_CWA_Abx_F_SE = 0, !- <none>
    IF (MFR_Air_Abx_F_SE > 0),  !- <none>
    Set t_AvgAir_Abx_F_SE = t_AirNodeOut_Abx_F_SE + t_AirNodeIn_Abx_F_SE,  !- <none>
    Set t_AvgAir_Abx_F_SE = t_AvgAir_Abx_F_SE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_F_SE = t_NodeIn_AbxHC_F_SE - t_NodeOut_AbxHC_F_SE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_F_SE = t_NodeOut_AbxCC_F_SE - t_NodeIn_AbxCC_F_SE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_F_SE <> 0),!- <none>
    IF (dT_HW_Abx_F_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_F_SE = t_NodeOut_AbxHC_F_SE + t_NodeIn_AbxHC_F_SE,  !- <none>
    Set dT_HWA_Abx_F_SE = dT_HWA_Abx_F_SE / 2,  !- <none>
    Set dT_HWA_Abx_F_SE = dT_HWA_Abx_F_SE - t_AvgAir_Abx_F_SE,  !- <none>
    Set dT_HW_Abx_F_SE_Num = dT_HW_Abx_F_SE_Num + 1,  !- <none>
    Set dT_HW_Abx_F_SE_Sum = dT_HW_Abx_F_SE_Sum + dT_HW_Abx_F_SE,  !- <none>
    Set dT_HW_Abx_F_SE_Avg = dT_HW_Abx_F_SE_Sum / dT_HW_Abx_F_SE_Num,  !- <none>
    Set dT_HWA_Abx_F_SE_Num = dT_HWA_Abx_F_SE_Num + 1,  !- <none>
    Set dT_HWA_Abx_F_SE_Sum = dT_HWA_Abx_F_SE_Sum + dT_HWA_Abx_F_SE,  !- <none>
    Set dT_HWA_Abx_F_SE_Avg = dT_HWA_Abx_F_SE_Sum / dT_HWA_Abx_F_SE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_F_SE <> 0),  !- <none>
    IF (dT_CW_Abx_F_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_F_SE = t_NodeIn_AbxCC_F_SE + t_NodeOut_AbxCC_F_SE,  !- <none>
    Set dT_CWA_Abx_F_SE = dT_CWA_Abx_F_SE / 2,  !- <none>
    Set dT_CWA_Abx_F_SE = dT_CWA_Abx_F_SE - t_AvgAir_Abx_F_SE,  !- <none>
    Set dT_CW_Abx_F_SE_Num = dT_CW_Abx_F_SE_Num + 1,  !- <none>
    Set dT_CW_Abx_F_SE_Sum = dT_CW_Abx_F_SE_Sum + dT_CW_Abx_F_SE,  !- <none>
    Set dT_CW_Abx_F_SE_Avg = dT_CW_Abx_F_SE_Sum / dT_CW_Abx_F_SE_Num,  !- <none>
    Set dT_CWA_Abx_F_SE_Num = dT_CWA_Abx_F_SE_Num + 1,  !- <none>
    Set dT_CWA_Abx_F_SE_Sum = dT_CWA_Abx_F_SE_Sum + dT_CWA_Abx_F_SE,  !- <none>
    Set dT_CWA_Abx_F_SE_Avg = dT_CWA_Abx_F_SE_Sum / dT_CWA_Abx_F_SE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_F_SE,      !- Name
    WaterHeatingCoil_Abx_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_F_SE,      !- Name
    WaterCoolingCoil_Abx_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_F_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_F_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_F_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_F_SE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_F_SE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_F_SE_Num  = 0,  !- <none>
    Set dT_CW_Abx_F_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_F_SE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_F_SE_Num = 0,  !- <none>
    Set dT_HWA_Abx_F_SE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_F_SE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_F_SE_Num = 0,  !- <none>
    Set dT_CWA_Abx_F_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_F_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_F_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_F_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_F_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL F_SE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling F_SE Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 367 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 706 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_SE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_F_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_F_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_F_SE,  !- Name
    Ceiling F_SE Hepta,      !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_F_SE,               !- Zone Name
    LowTempRadiantSurfaceGroup_F_SE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.42224885E-04,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_F_SE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.21949765E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_F_SE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Name
    0.42224885E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE,  !- Name
    0.21949765E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_F_SE,     !- Name
    AirNode_ZoneNode_F_SE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_F_SE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_F_SE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_F_SE,          !- Name
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_F_SE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_SE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_F_SE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_SE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_F_SE < t_Sp_Heating_Hepta_F_SE + 0.07 ),  !- <none>
    Set MFR_Hepta_F_SE =   0.042224880,  !- <none>
    ELSEIF (t_AirNode_Zone_F_SE > t_Sp_Cooling_Hepta_F_SE - 0.07 ),  !- <none>
    Set MFR_Hepta_F_SE =   0.021949761,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_F_SE,     !- Name
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_F_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_F_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_F_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(Water) {K},  !- Name
    dT_W_Hepta_F_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_F_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_F_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_F_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_F_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_F_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_F_SE_TempDiff,!- Name
    Set dT_W_Hepta_F_SE  = 0,!- Program Line 1
    Set dT_HW_Hepta_F_SE = 0,!- Program Line 2
    Set dT_CW_Hepta_F_SE = 0,!- <none>
    Set dT_WA_Hepta_F_SE  = 0,  !- <none>
    Set dT_HWA_Hepta_F_SE = 0,  !- <none>
    Set dT_CWA_Hepta_F_SE = 0,  !- <none>
    Set dT_W_Hepta_F_SE    = (t_NodeIn_Hepta_F_SE - t_NodeOut_Hepta_F_SE),  !- <none>
    Set dT_WA_Hepta_F_SE = (t_NodeIn_Hepta_F_SE + t_NodeOut_Hepta_F_SE) / 2,  !- <none>
    Set dT_WA_Hepta_F_SE = dT_WA_Hepta_F_SE - t_AirNode_Zone_F_SE,  !- <none>
    IF (dT_W_Hepta_F_SE > 0),!- <none>
    Set dT_HW_Hepta_F_SE    = dT_W_Hepta_F_SE,  !- <none>
    Set dT_HWA_Hepta_F_SE = dT_WA_Hepta_F_SE,  !- <none>
    Set dT_HW_Hepta_F_SE_Num = dT_HW_Hepta_F_SE_Num + 1,  !- <none>
    Set dT_HW_Hepta_F_SE_Sum = dT_HW_Hepta_F_SE_Sum + dT_HW_Hepta_F_SE,  !- <none>
    Set dT_HW_Hepta_F_SE_Avg = dT_HW_Hepta_F_SE_Sum / dT_HW_Hepta_F_SE_Num,  !- <none>
    Set dT_HWA_Hepta_F_SE_Num = dT_HWA_Hepta_F_SE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_F_SE_Sum = dT_HWA_Hepta_F_SE_Sum + dT_HWA_Hepta_F_SE,  !- <none>
    Set dT_HWA_Hepta_F_SE_Avg = dT_HWA_Hepta_F_SE_Sum / dT_HWA_Hepta_F_SE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_F_SE < 0),  !- <none>
    Set dT_CW_Hepta_F_SE    = 0.0 - dT_W_Hepta_F_SE,  !- <none>
    Set dT_CWA_Hepta_F_SE = 0.0 - dT_WA_Hepta_F_SE,  !- <none>
    Set dT_CW_Hepta_F_SE_Num = dT_CW_Hepta_F_SE_Num + 1,  !- <none>
    Set dT_CW_Hepta_F_SE_Sum = dT_CW_Hepta_F_SE_Sum + dT_CW_Hepta_F_SE,  !- <none>
    Set dT_CW_Hepta_F_SE_Avg = dT_CW_Hepta_F_SE_Sum / dT_CW_Hepta_F_SE_Num,  !- <none>
    Set dT_CWA_Hepta_F_SE_Num = dT_CWA_Hepta_F_SE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_F_SE_Sum = dT_CWA_Hepta_F_SE_Sum + dT_CWA_Hepta_F_SE,  !- <none>
    Set dT_CWA_Hepta_F_SE_Avg = dT_CWA_Hepta_F_SE_Sum / dT_CWA_Hepta_F_SE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_F_SE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_F_SE, !- Name
    Run InitConvCoeff_Sf_Zone_F_SE,  !- Program Line 1
    IF (dT_W_Hepta_F_SE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_F_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_SE = (6.12 + (0.18 * (dT_HWA_Hepta_F_SE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_SE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_F_SE < 0),  !- <none>
    IF (dT_CWA_Hepta_F_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_SE = 6.12 + (2.76 * (dT_CWA_Hepta_F_SE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_SE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_F_SE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_SE  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_F_SE,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_SE  = ConvCoeffToSet_Hepta_F_SE;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_F_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_F_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_F_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_F_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_F_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_F_SE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_F_SE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_F_SE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_F_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_F_SE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_F_SE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_F_SE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_F_SE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_F_SE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_F_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_F_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_F_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_F_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_F_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR F_SE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 636 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_SE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_F_SE,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_F_SE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_F_SE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    50.880001068,            !- U-Factor Times Area Value {W/K}
    0.50717706E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_F_SE,  !- Name
    0.50717706E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_F_SE,    !- Component 1 Name
    Node_HwDemand_WaterConvective_F_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_F_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_F_SE,  !- Name
    WaterConvective_F_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_F_SE,      !- Name
    WaterConvective_F_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_F_SE,     !- Name
    WaterConvective_F_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_F_SE,   !- Name
    WaterConvective_F_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_F_SE,  !- Name
    WaterConvective_F_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_F_SE;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_SE: dT(HWater) {K},  !- Name
    dT_HW_Conv_F_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_F_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_F_SE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_F_SE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_F_SE_TempDiff, !- Name
    Set dT_HW_Conv_F_SE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_F_SE = 0,  !- Program Line 2
    Set dT_HWA_Conv_F_SE   = 0,  !- <none>
    Set dT_HW_Conv_F_SE    = t_NodeIn_Conv_F_SE - t_NodeOut_Conv_F_SE,  !- <none>
    IF (dT_HW_Conv_F_SE > 0),!- <none>
    Set t_AvgAir_Conv_F_SE = t_AirNodeOut_Conv_F_SE + t_AirNodeIn_Conv_F_SE,  !- <none>
    Set t_AvgAir_Conv_F_SE = t_AvgAir_Conv_F_SE / 2,  !- <none>
    Set dT_HWA_Conv_F_SE = t_NodeOut_Conv_F_SE + t_NodeIn_Conv_F_SE,  !- <none>
    Set dT_HWA_Conv_F_SE = dT_HWA_Conv_F_SE / 2,  !- <none>
    Set dT_HWA_Conv_F_SE = dT_HWA_Conv_F_SE - t_AvgAir_Conv_F_SE,  !- <none>
    Set dT_HW_Conv_F_SE_Num = dT_HW_Conv_F_SE_Num + 1,  !- <none>
    Set dT_HW_Conv_F_SE_Sum = dT_HW_Conv_F_SE_Sum + dT_HW_Conv_F_SE,  !- <none>
    Set dT_HW_Conv_F_SE_Avg = dT_HW_Conv_F_SE_Sum / dT_HW_Conv_F_SE_Num,  !- <none>
    Set dT_HWA_Conv_F_SE_Num = dT_HWA_Conv_F_SE_Num + 1,  !- <none>
    Set dT_HWA_Conv_F_SE_Sum = dT_HWA_Conv_F_SE_Sum + dT_HWA_Conv_F_SE,  !- <none>
    Set dT_HWA_Conv_F_SE_Avg = dT_HWA_Conv_F_SE_Sum / dT_HWA_Conv_F_SE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_F_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_F_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_F_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_F_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_F_SE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_F_SE_Num = 0,  !- <none>
    Set dT_HWA_Conv_F_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_F_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_F_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_F_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_F_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_F_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX F_SE
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 1 {-}, ZONENAME = F_SE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_F_SE, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    465,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_F_SE,!- Name
    ElectricConvective_F_SE, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_F_SI
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = F_SI { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_F_SI,  !- Name
    Zone_F_SI,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_F_SI,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_F_SI;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_F_SI,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_F_SI,  !- Name
    Schedule_TemperatureMinimum_Zone_F_SI,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_F_SI;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_F_SI,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_F_SI,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_F_SI,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_F_SI,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 3 Object Type
    ElectricConvective_F_SI, !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3;                       !- Zone Equipment 3 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_F_SI,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SI_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_F_SI,               !- Zone Name
    ZoneHvacEquipmentList_F_SI,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_F_SI,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_F_SI,   !- Zone Air Node Name
    AirNode_F_SI_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE F_SI =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_F_SI;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_SI Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_F_SI,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_F_SI;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_F_SI Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_F_SI,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_F_SI,  !- Name
    Set Heating_Energy_Zone_F_SI = 0,  !- Program Line 1
    Set Heating_Energy_Zone_F_SI = Heating_Energy_Zone_F_SI + Q_Heating_Abx_F_SI,  !- Program Line 2
    Set Heating_Energy_Zone_F_SI = Heating_Energy_Zone_F_SI + Q_Heating_Hepta_F_SI,  !- <none>
    Set Heating_Energy_Zone_F_SI = Heating_Energy_Zone_F_SI + Q_Heating_RecircAbx_F_SI;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_F_SI,  !- Name
    Set Cooling_Energy_Zone_F_SI = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_F_SI = Cooling_Energy_Zone_F_SI + Q_Cooling_Abx_F_SI,  !- Program Line 2
    Set Cooling_Energy_Zone_F_SI = Cooling_Energy_Zone_F_SI + Q_Cooling_Hepta_F_SI;  !- <none>

! ====================================================================================================
! ===     AIRBOX F_SI
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 8 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = F_SI { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_F_SI,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_F_SI,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_F_SI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_F_SI,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_F_SI;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_F_SI,  !- Name
    Schedule_Availability_Abx_F_SI;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_F_SI,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_F_SI,  !- Name
    Schedule_Availability_Abx_F_SI,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.209000006,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.142266646,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_F_SI,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_F_SI_FanAvail,    !- Name
    Schedule_Availability_Abx_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_F_SI_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_F_SI_Fan,        !- Name
    FanVariableVolume_Abx_F_SI,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_F_SI,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_F_SI_Fan = 0,!- Program Line 2
    IF (Is_Abx_F_SI_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_F_SI > 0.1),  !- <none>
    Set MFR_Abx_F_SI_Fan =    0.209000006 * rho_Abx_F_SI_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_SI_Fan =    0.142266646 * rho_Abx_F_SI_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_F_SI_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_F_SI_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_F_SI_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_F_SI_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_F_SI,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_F_SI_SupplyAir = t_Abx_F_SI_WaterSupply - t_Abx_F_SI_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_F_SI_SupplyAir = 0.794871807 * TempSP_Abx_F_SI_SupplyAir,  !- <none>
    Set TempSP_Abx_F_SI_SupplyAir = t_Abx_F_SI_OutdoorAir + TempSP_Abx_F_SI_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_F_SI_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_F_SI,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    330.880004883,           !- U-Factor Times Area Value {W/K}
    0.29984058E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    7520,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_F_SI,  !- Name
    0.29984058E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_F_SI,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_F_SI,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.29984058E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_F_SI,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.21531101E-03,          !- Design Water Flow Rate {m3/s}
    0.222222224,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_F_SI,  !- Name
    0.32296655E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_F_SI,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_F_SI,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.32296655E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_SI_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_F_SI,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_F_SI;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_F_SI, !- Name
    AirBranch_Abx_F_SI;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_F_SI,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_F_SI;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_F_SI,!- Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_F_SI,  !- Name
    ControllerList_Abx_F_SI_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_F_SI,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_F_SI;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_F_SI,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_OutdoorInlet,  !- Actuator Node Name
    0.142266646,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.209000006,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_F_SI_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_F_SI;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_F_SI,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SI_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_F_SI;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_F_SI,  !- Name
    Schedule_Availability_Abx_F_SI,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SI_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SI_Inlet,  !- Air Inlet Node Name
    0.209000006,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.142266646;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_F_SI,        !- Name
    ControllerList_Abx_F_SI_Coils,  !- Controller List Name
    AvailabilityList_Abx_F_SI,  !- Availability Manager List Name
    0.209000006,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_F_SI, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_F_SI_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_F_SI_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_F_SI_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_F_SI,      !- Name
    0.209000006,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_F_SI,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_F_SI_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_F_SI,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_F_SI,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_F_SI,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_F_SI,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_SI_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_F_SI_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_F_SI,  !- Name
    AirNode_AirLoopSupplyPath_Abx_F_SI_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_F_SI;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_F_SI,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_SI_Outlet,  !- Outlet Node Name
    AirNode_F_SI_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_F_SI,  !- Name
    AirNode_AirLoopReturnPath_Abx_F_SI_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_F_SI;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_SI,  !- Name
    AirNode_OutdoorAirMixer_Abx_F_SI_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_F_SI;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_F_SI,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_F_SI,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_F_SI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_F_SI,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_F_SI,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_F_SI,    !- Name
    AirNode_OutdoorAirMixer_Abx_F_SI_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_F_SI,   !- Name
    AirNode_WaterCoolingCoil_Abx_F_SI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_F_SI,        !- Name
    AirNode_FanVariableVolume_Abx_F_SI_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SI;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SI;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_F_SI;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(HWater) {K},!- Name
    dT_HW_Abx_F_SI,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(CWater) {K},!- Name
    dT_CW_Abx_F_SI,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_F_SI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_F_SI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_F_SI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_F_SI_TempDiff,  !- Name
    Set dT_HW_Abx_F_SI  = 0, !- Program Line 1
    Set dT_CW_Abx_F_SI = 0,  !- Program Line 2
    Set t_AvgAir_Abx_F_SI = 0,  !- <none>
    Set dT_HWA_Abx_F_SI  = 0,!- <none>
    Set dT_CWA_Abx_F_SI = 0, !- <none>
    IF (MFR_Air_Abx_F_SI > 0),  !- <none>
    Set t_AvgAir_Abx_F_SI = t_AirNodeOut_Abx_F_SI + t_AirNodeIn_Abx_F_SI,  !- <none>
    Set t_AvgAir_Abx_F_SI = t_AvgAir_Abx_F_SI / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_F_SI = t_NodeIn_AbxHC_F_SI - t_NodeOut_AbxHC_F_SI,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_F_SI = t_NodeOut_AbxCC_F_SI - t_NodeIn_AbxCC_F_SI,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_F_SI <> 0),!- <none>
    IF (dT_HW_Abx_F_SI < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_F_SI = t_NodeOut_AbxHC_F_SI + t_NodeIn_AbxHC_F_SI,  !- <none>
    Set dT_HWA_Abx_F_SI = dT_HWA_Abx_F_SI / 2,  !- <none>
    Set dT_HWA_Abx_F_SI = dT_HWA_Abx_F_SI - t_AvgAir_Abx_F_SI,  !- <none>
    Set dT_HW_Abx_F_SI_Num = dT_HW_Abx_F_SI_Num + 1,  !- <none>
    Set dT_HW_Abx_F_SI_Sum = dT_HW_Abx_F_SI_Sum + dT_HW_Abx_F_SI,  !- <none>
    Set dT_HW_Abx_F_SI_Avg = dT_HW_Abx_F_SI_Sum / dT_HW_Abx_F_SI_Num,  !- <none>
    Set dT_HWA_Abx_F_SI_Num = dT_HWA_Abx_F_SI_Num + 1,  !- <none>
    Set dT_HWA_Abx_F_SI_Sum = dT_HWA_Abx_F_SI_Sum + dT_HWA_Abx_F_SI,  !- <none>
    Set dT_HWA_Abx_F_SI_Avg = dT_HWA_Abx_F_SI_Sum / dT_HWA_Abx_F_SI_Num,  !- <none>
    ELSEIF (dT_CW_Abx_F_SI <> 0),  !- <none>
    IF (dT_CW_Abx_F_SI < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_F_SI = t_NodeIn_AbxCC_F_SI + t_NodeOut_AbxCC_F_SI,  !- <none>
    Set dT_CWA_Abx_F_SI = dT_CWA_Abx_F_SI / 2,  !- <none>
    Set dT_CWA_Abx_F_SI = dT_CWA_Abx_F_SI - t_AvgAir_Abx_F_SI,  !- <none>
    Set dT_CW_Abx_F_SI_Num = dT_CW_Abx_F_SI_Num + 1,  !- <none>
    Set dT_CW_Abx_F_SI_Sum = dT_CW_Abx_F_SI_Sum + dT_CW_Abx_F_SI,  !- <none>
    Set dT_CW_Abx_F_SI_Avg = dT_CW_Abx_F_SI_Sum / dT_CW_Abx_F_SI_Num,  !- <none>
    Set dT_CWA_Abx_F_SI_Num = dT_CWA_Abx_F_SI_Num + 1,  !- <none>
    Set dT_CWA_Abx_F_SI_Sum = dT_CWA_Abx_F_SI_Sum + dT_CWA_Abx_F_SI,  !- <none>
    Set dT_CWA_Abx_F_SI_Avg = dT_CWA_Abx_F_SI_Sum / dT_CWA_Abx_F_SI_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_F_SI,      !- Name
    WaterHeatingCoil_Abx_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_F_SI,      !- Name
    WaterCoolingCoil_Abx_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_F_SI_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_F_SI_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_F_SI_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_F_SI_Avg  = 0,  !- <none>
    Set dT_CW_Abx_F_SI_Sum  = 0,  !- <none>
    Set dT_CW_Abx_F_SI_Num  = 0,  !- <none>
    Set dT_CW_Abx_F_SI_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_F_SI_Sum = 0,  !- <none>
    Set dT_HWA_Abx_F_SI_Num = 0,  !- <none>
    Set dT_HWA_Abx_F_SI_Avg = 0,  !- <none>
    Set dT_CWA_Abx_F_SI_Sum = 0,  !- <none>
    Set dT_CWA_Abx_F_SI_Num = 0,  !- <none>
    Set dT_CWA_Abx_F_SI_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SI_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SI_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_F_SI_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_F_SI_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SI_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SI_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_F_SI_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_F_SI_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SI_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SI_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_F_SI_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_F_SI_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SI_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SI_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_F_SI_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_F_SI: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_F_SI_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL F_SI
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Ceiling F_SI.1 Hepta, 0.50, Ceiling F_SI.2 Hepta, 0.25, Ceiling F_SI.3 Hepta, 0.25 { },
! ===         HEPTAPANELTOTALCOOLINGPOWER = 3344 {W}, HEPTAPANELTOTALHEATINGPOWER = 6432 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = F_SI { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_F_SI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_F_SI,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_F_SI,  !- Name
    Ceiling F_SI.1 Hepta,    !- Surface 1 Name
    0.50,                    !- Flow Fraction for Surface 1
    Ceiling F_SI.2 Hepta,    !- Surface 2 Name
    0.25,                    !- Flow Fraction for Surface 2
    Ceiling F_SI.3 Hepta,    !- Surface 3 Name
    0.25;                    !- Flow Fraction for Surface 3

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_F_SI,               !- Zone Name
    LowTempRadiantSurfaceGroup_F_SI,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.38468905E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_F_SI,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.20000001E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_F_SI,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Name
    0.38468905E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI,  !- Name
    0.20000001E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_F_SI_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_F_SI,     !- Name
    AirNode_ZoneNode_F_SI,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_F_SI, !- Name
    Schedule_TemperatureSp_Heating_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_F_SI, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_F_SI,          !- Name
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_F_SI,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_SI = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_F_SI,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_F_SI = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_F_SI < t_Sp_Heating_Hepta_F_SI + 0.07 ),  !- <none>
    Set MFR_Hepta_F_SI =   0.384689003,  !- <none>
    ELSEIF (t_AirNode_Zone_F_SI > t_Sp_Cooling_Hepta_F_SI - 0.07 ),  !- <none>
    Set MFR_Hepta_F_SI =   0.200000003,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_F_SI,     !- Name
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_F_SI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_F_SI;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_F_SI;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SI;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SI;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(Water) {K},  !- Name
    dT_W_Hepta_F_SI,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(HWater) {K},  !- Name
    dT_HW_Hepta_F_SI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(CWater) {K},  !- Name
    dT_CW_Hepta_F_SI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_F_SI,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_F_SI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_F_SI,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_F_SI_TempDiff,!- Name
    Set dT_W_Hepta_F_SI  = 0,!- Program Line 1
    Set dT_HW_Hepta_F_SI = 0,!- Program Line 2
    Set dT_CW_Hepta_F_SI = 0,!- <none>
    Set dT_WA_Hepta_F_SI  = 0,  !- <none>
    Set dT_HWA_Hepta_F_SI = 0,  !- <none>
    Set dT_CWA_Hepta_F_SI = 0,  !- <none>
    Set dT_W_Hepta_F_SI    = (t_NodeIn_Hepta_F_SI - t_NodeOut_Hepta_F_SI),  !- <none>
    Set dT_WA_Hepta_F_SI = (t_NodeIn_Hepta_F_SI + t_NodeOut_Hepta_F_SI) / 2,  !- <none>
    Set dT_WA_Hepta_F_SI = dT_WA_Hepta_F_SI - t_AirNode_Zone_F_SI,  !- <none>
    IF (dT_W_Hepta_F_SI > 0),!- <none>
    Set dT_HW_Hepta_F_SI    = dT_W_Hepta_F_SI,  !- <none>
    Set dT_HWA_Hepta_F_SI = dT_WA_Hepta_F_SI,  !- <none>
    Set dT_HW_Hepta_F_SI_Num = dT_HW_Hepta_F_SI_Num + 1,  !- <none>
    Set dT_HW_Hepta_F_SI_Sum = dT_HW_Hepta_F_SI_Sum + dT_HW_Hepta_F_SI,  !- <none>
    Set dT_HW_Hepta_F_SI_Avg = dT_HW_Hepta_F_SI_Sum / dT_HW_Hepta_F_SI_Num,  !- <none>
    Set dT_HWA_Hepta_F_SI_Num = dT_HWA_Hepta_F_SI_Num + 1,  !- <none>
    Set dT_HWA_Hepta_F_SI_Sum = dT_HWA_Hepta_F_SI_Sum + dT_HWA_Hepta_F_SI,  !- <none>
    Set dT_HWA_Hepta_F_SI_Avg = dT_HWA_Hepta_F_SI_Sum / dT_HWA_Hepta_F_SI_Num,  !- <none>
    ELSEIF (dT_W_Hepta_F_SI < 0),  !- <none>
    Set dT_CW_Hepta_F_SI    = 0.0 - dT_W_Hepta_F_SI,  !- <none>
    Set dT_CWA_Hepta_F_SI = 0.0 - dT_WA_Hepta_F_SI,  !- <none>
    Set dT_CW_Hepta_F_SI_Num = dT_CW_Hepta_F_SI_Num + 1,  !- <none>
    Set dT_CW_Hepta_F_SI_Sum = dT_CW_Hepta_F_SI_Sum + dT_CW_Hepta_F_SI,  !- <none>
    Set dT_CW_Hepta_F_SI_Avg = dT_CW_Hepta_F_SI_Sum / dT_CW_Hepta_F_SI_Num,  !- <none>
    Set dT_CWA_Hepta_F_SI_Num = dT_CWA_Hepta_F_SI_Num + 1,  !- <none>
    Set dT_CWA_Hepta_F_SI_Sum = dT_CWA_Hepta_F_SI_Sum + dT_CWA_Hepta_F_SI,  !- <none>
    Set dT_CWA_Hepta_F_SI_Avg = dT_CWA_Hepta_F_SI_Sum / dT_CWA_Hepta_F_SI_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_F_SI;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_F_SI, !- Name
    Run InitConvCoeff_Sf_Zone_F_SI,  !- Program Line 1
    IF (dT_W_Hepta_F_SI > 0),!- Program Line 2
    IF (dT_HWA_Hepta_F_SI <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_SI = (6.12 + (0.18 * (dT_HWA_Hepta_F_SI^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_SI,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_F_SI < 0),  !- <none>
    IF (dT_CWA_Hepta_F_SI <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_F_SI = 6.12 + (2.76 * (dT_CWA_Hepta_F_SI^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_F_SI,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_F_SI,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_SI_1  = Null,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_SI_2  = Null,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_SI_3  = Null;  !- <none>

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_F_SI,  !- Name
    Set ConvCoeff_Hepta_Ceiling_F_SI_1  = ConvCoeffToSet_Hepta_F_SI,  !- Program Line 1
    Set ConvCoeff_Hepta_Ceiling_F_SI_2  = ConvCoeffToSet_Hepta_F_SI,  !- Program Line 2
    Set ConvCoeff_Hepta_Ceiling_F_SI_3  = ConvCoeffToSet_Hepta_F_SI;  !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_F_SI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_F_SI,    !- Name
    LowTempRadiantVarFlow_Hepta_F_SI,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_F_SI_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_F_SI_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_F_SI_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_F_SI_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_F_SI_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_F_SI_Num  = 0,  !- <none>
    Set dT_CW_Hepta_F_SI_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_F_SI_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_F_SI_Num = 0,  !- <none>
    Set dT_HWA_Hepta_F_SI_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_F_SI_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_F_SI_Num = 0,  !- <none>
    Set dT_CWA_Hepta_F_SI_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SI_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SI_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_F_SI_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_F_SI_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SI_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SI_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_F_SI_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_F_SI_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SI_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SI_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_F_SI_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_F_SI_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SI_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SI_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_F_SI_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_F_SI: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_F_SI_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX F_SI
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = F_SI { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_F_SI, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_F_SI,!- Name
    ElectricConvective_F_SI, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_G_CORE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_CORE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_CORE,  !- Name
    Zone_G_CORE,             !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_CORE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_CORE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_CORE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_CORE,  !- Name
    Schedule_TemperatureMinimum_Zone_G_CORE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_CORE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_CORE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_CORE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_CORE,  !- Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 1 Object Type
    WaterConvective_G_CORE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1;                       !- Zone Equipment 1 Heating or No-Load Sequence

  ZoneHVAC:EquipmentConnections,
    Zone_G_CORE,             !- Zone Name
    ZoneHvacEquipmentList_G_CORE,  !- Zone Conditioning Equipment List Name
    ,                        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_CORE, !- Zone Air Node Name
    AirNode_G_CORE_Outlet;   !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_CORE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_CORE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_CORE;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_CORE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_CORE,  !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_CORE,  !- Name
    Set Heating_Energy_Zone_G_CORE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_CORE = Heating_Energy_Zone_G_CORE + Q_Heating_WaterConvective_G_CORE;  !- Program Line 2

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_CORE,  !- Name
    Set Cooling_Energy_Zone_G_CORE = 0;  !- Program Line 1

! ====================================================================================================
! ===     CONVECTOR G_CORE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 1332 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_CORE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_G_CORE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_G_CORE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_G_CORE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    106.559997559,           !- U-Factor Times Area Value {W/K}
    0.10622010E-03,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_G_CORE,  !- Name
    0.10622010E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_G_CORE,  !- Component 1 Name
    Node_HwDemand_WaterConvective_G_CORE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_G_CORE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_G_CORE,  !- Name
    WaterConvective_G_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_G_CORE,    !- Name
    WaterConvective_G_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_G_CORE,   !- Name
    WaterConvective_G_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_G_CORE, !- Name
    WaterConvective_G_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_G_CORE,!- Name
    WaterConvective_G_CORE,  !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_CORE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_CORE;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_G_CORE;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_CORE: dT(HWater) {K},  !- Name
    dT_HW_Conv_G_CORE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_CORE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_G_CORE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_CORE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_G_CORE,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_G_CORE_TempDiff,  !- Name
    Set dT_HW_Conv_G_CORE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_G_CORE = 0,  !- Program Line 2
    Set dT_HWA_Conv_G_CORE   = 0,  !- <none>
    Set dT_HW_Conv_G_CORE    = t_NodeIn_Conv_G_CORE - t_NodeOut_Conv_G_CORE,  !- <none>
    IF (dT_HW_Conv_G_CORE > 0),  !- <none>
    Set t_AvgAir_Conv_G_CORE = t_AirNodeOut_Conv_G_CORE + t_AirNodeIn_Conv_G_CORE,  !- <none>
    Set t_AvgAir_Conv_G_CORE = t_AvgAir_Conv_G_CORE / 2,  !- <none>
    Set dT_HWA_Conv_G_CORE = t_NodeOut_Conv_G_CORE + t_NodeIn_Conv_G_CORE,  !- <none>
    Set dT_HWA_Conv_G_CORE = dT_HWA_Conv_G_CORE / 2,  !- <none>
    Set dT_HWA_Conv_G_CORE = dT_HWA_Conv_G_CORE - t_AvgAir_Conv_G_CORE,  !- <none>
    Set dT_HW_Conv_G_CORE_Num = dT_HW_Conv_G_CORE_Num + 1,  !- <none>
    Set dT_HW_Conv_G_CORE_Sum = dT_HW_Conv_G_CORE_Sum + dT_HW_Conv_G_CORE,  !- <none>
    Set dT_HW_Conv_G_CORE_Avg = dT_HW_Conv_G_CORE_Sum / dT_HW_Conv_G_CORE_Num,  !- <none>
    Set dT_HWA_Conv_G_CORE_Num = dT_HWA_Conv_G_CORE_Num + 1,  !- <none>
    Set dT_HWA_Conv_G_CORE_Sum = dT_HWA_Conv_G_CORE_Sum + dT_HWA_Conv_G_CORE,  !- <none>
    Set dT_HWA_Conv_G_CORE_Avg = dT_HWA_Conv_G_CORE_Sum / dT_HWA_Conv_G_CORE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_G_CORE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_G_CORE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_G_CORE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_G_CORE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_G_CORE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_G_CORE_Num = 0,  !- <none>
    Set dT_HWA_Conv_G_CORE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_CORE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_CORE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_CORE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_CORE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_G_CORE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_CORE_Sum;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_CORE_Num;  !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_CORE_Avg;  !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_CORE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_G_CORE_Avg,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_G_E
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_E { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_E,  !- Name
    Zone_G_E,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_E,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_E;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_E,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_E,  !- Name
    Schedule_TemperatureMinimum_Zone_G_E,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_E;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_E,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_E,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_E,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_E,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_E,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_E,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_E_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_E,                !- Zone Name
    ZoneHvacEquipmentList_G_E,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_E,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_E,    !- Zone Air Node Name
    AirNode_G_E_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_E =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_E; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_E Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_E, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_E; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_E Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_E, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_E,  !- Name
    Set Heating_Energy_Zone_G_E = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_E = Heating_Energy_Zone_G_E + Q_Heating_Abx_G_E,  !- Program Line 2
    Set Heating_Energy_Zone_G_E = Heating_Energy_Zone_G_E + Q_Heating_Hepta_G_E;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_E,  !- Name
    Set Cooling_Energy_Zone_G_E = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_E = Cooling_Energy_Zone_G_E + Q_Cooling_Abx_G_E,  !- Program Line 2
    Set Cooling_Energy_Zone_G_E = Cooling_Energy_Zone_G_E + Q_Cooling_Hepta_G_E;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_E
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_E { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_E,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_E,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_E,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_E;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_E,  !- Name
    Schedule_Availability_Abx_G_E;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_E,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_E,  !- Name
    Schedule_Availability_Abx_G_E,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_E_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_E,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_E_FanAvail,     !- Name
    Schedule_Availability_Abx_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_E_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_E_Fan,         !- Name
    FanVariableVolume_Abx_G_E,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_E,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_E_Fan = 0, !- Program Line 2
    IF (Is_Abx_G_E_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_E > 0.1),  !- <none>
    Set MFR_Abx_G_E_Fan =    0.104500003 * rho_Abx_G_E_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_E_Fan =    0.071133330 * rho_Abx_G_E_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_E_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_E_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_E_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_E_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_E,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_E_SupplyAir = t_Abx_G_E_WaterSupply - t_Abx_G_E_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_E_SupplyAir = 0.794871807 * TempSP_Abx_G_E_SupplyAir,  !- <none>
    Set TempSP_Abx_G_E_SupplyAir = t_Abx_G_E_OutdoorAir + TempSP_Abx_G_E_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_E_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_E,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_E_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_E,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_E,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_E,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_E,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_E_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_E_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_E,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_E,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_E,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_E_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_E,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_E;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_E,  !- Name
    AirBranch_Abx_G_E;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_E,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_E; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_E, !- Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_E,!- Name
    ControllerList_Abx_G_E_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_E,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_E;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_E,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_E_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_E;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_E,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_E_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_E;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_E,  !- Name
    Schedule_Availability_Abx_G_E,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_E_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_E_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_E,         !- Name
    ControllerList_Abx_G_E_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_E,!- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_E,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_E_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_E_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_E_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_E,       !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_E,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_E_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_E,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_E_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_E,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_E_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_E_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_E,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_E_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_E,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_E_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_E_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_E,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_E_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_E;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_E,!- Name
    AirNode_AirLoopReturnPath_Abx_G_E_Outlet,  !- Outlet Node Name
    AirNode_G_E_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_E,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_E_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_E;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_E,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_E_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_E;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_E,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_E,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_E,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_E,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_E,     !- Name
    AirNode_OutdoorAirMixer_Abx_G_E_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_E,    !- Name
    AirNode_WaterCoolingCoil_Abx_G_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_E,         !- Name
    AirNode_FanVariableVolume_Abx_G_E_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_E;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_E;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(HWater) {K}, !- Name
    dT_HW_Abx_G_E,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(CWater) {K}, !- Name
    dT_CW_Abx_G_E,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_E_TempDiff,   !- Name
    Set dT_HW_Abx_G_E  = 0,  !- Program Line 1
    Set dT_CW_Abx_G_E = 0,   !- Program Line 2
    Set t_AvgAir_Abx_G_E = 0,!- <none>
    Set dT_HWA_Abx_G_E  = 0, !- <none>
    Set dT_CWA_Abx_G_E = 0,  !- <none>
    IF (MFR_Air_Abx_G_E > 0),!- <none>
    Set t_AvgAir_Abx_G_E = t_AirNodeOut_Abx_G_E + t_AirNodeIn_Abx_G_E,  !- <none>
    Set t_AvgAir_Abx_G_E = t_AvgAir_Abx_G_E / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_E = t_NodeIn_AbxHC_G_E - t_NodeOut_AbxHC_G_E,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_E = t_NodeOut_AbxCC_G_E - t_NodeIn_AbxCC_G_E,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_E <> 0), !- <none>
    IF (dT_HW_Abx_G_E < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_E = t_NodeOut_AbxHC_G_E + t_NodeIn_AbxHC_G_E,  !- <none>
    Set dT_HWA_Abx_G_E = dT_HWA_Abx_G_E / 2,  !- <none>
    Set dT_HWA_Abx_G_E = dT_HWA_Abx_G_E - t_AvgAir_Abx_G_E,  !- <none>
    Set dT_HW_Abx_G_E_Num = dT_HW_Abx_G_E_Num + 1,  !- <none>
    Set dT_HW_Abx_G_E_Sum = dT_HW_Abx_G_E_Sum + dT_HW_Abx_G_E,  !- <none>
    Set dT_HW_Abx_G_E_Avg = dT_HW_Abx_G_E_Sum / dT_HW_Abx_G_E_Num,  !- <none>
    Set dT_HWA_Abx_G_E_Num = dT_HWA_Abx_G_E_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_E_Sum = dT_HWA_Abx_G_E_Sum + dT_HWA_Abx_G_E,  !- <none>
    Set dT_HWA_Abx_G_E_Avg = dT_HWA_Abx_G_E_Sum / dT_HWA_Abx_G_E_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_E <> 0),  !- <none>
    IF (dT_CW_Abx_G_E < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_E = t_NodeIn_AbxCC_G_E + t_NodeOut_AbxCC_G_E,  !- <none>
    Set dT_CWA_Abx_G_E = dT_CWA_Abx_G_E / 2,  !- <none>
    Set dT_CWA_Abx_G_E = dT_CWA_Abx_G_E - t_AvgAir_Abx_G_E,  !- <none>
    Set dT_CW_Abx_G_E_Num = dT_CW_Abx_G_E_Num + 1,  !- <none>
    Set dT_CW_Abx_G_E_Sum = dT_CW_Abx_G_E_Sum + dT_CW_Abx_G_E,  !- <none>
    Set dT_CW_Abx_G_E_Avg = dT_CW_Abx_G_E_Sum / dT_CW_Abx_G_E_Num,  !- <none>
    Set dT_CWA_Abx_G_E_Num = dT_CWA_Abx_G_E_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_E_Sum = dT_CWA_Abx_G_E_Sum + dT_CWA_Abx_G_E,  !- <none>
    Set dT_CWA_Abx_G_E_Avg = dT_CWA_Abx_G_E_Sum / dT_CWA_Abx_G_E_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_E,       !- Name
    WaterHeatingCoil_Abx_G_E,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_E,       !- Name
    WaterCoolingCoil_Abx_G_E,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_E_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_E_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_E_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_E_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_E_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_E_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_E_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_E_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_E_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_E_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_E_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_E_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_E_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_E_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_E_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_E_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_E_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_E_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_E_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_E_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_E_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_E_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_E_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_E_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_E_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_E_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_E_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_E_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_E: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_E_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_E
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_E Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1672 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 3216 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_E { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_E,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_E,  !- Name
    Roof G_E Hepta,          !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_E,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_E,                !- Zone Name
    LowTempRadiantSurfaceGroup_G_E,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.19234451E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_E_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_E_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_E,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.10000000E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_E_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_E_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_E,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Name
    0.19234451E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_E,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_E_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_E,  !- Name
    0.10000000E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_E,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_E_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_E_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_E,      !- Name
    AirNode_ZoneNode_G_E,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_E,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_E,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_E,           !- Name
    LowTempRadiantVarFlow_Hepta_G_E,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_E,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_E = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_E,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_E = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_G_E < t_Sp_Heating_Hepta_G_E + 0.07 ),  !- <none>
    Set MFR_Hepta_G_E =   0.192344502,  !- <none>
    ELSEIF (t_AirNode_Zone_G_E > t_Sp_Cooling_Hepta_G_E - 0.07 ),  !- <none>
    Set MFR_Hepta_G_E =   0.100000001,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_E,      !- Name
    LowTempRadiantVarFlow_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_E,     !- Name
    LowTempRadiantVarFlow_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_E;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_E;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_E;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(Water) {K},!- Name
    dT_W_Hepta_G_E,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_E,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_E,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_E_TempDiff, !- Name
    Set dT_W_Hepta_G_E  = 0, !- Program Line 1
    Set dT_HW_Hepta_G_E = 0, !- Program Line 2
    Set dT_CW_Hepta_G_E = 0, !- <none>
    Set dT_WA_Hepta_G_E  = 0,!- <none>
    Set dT_HWA_Hepta_G_E = 0,!- <none>
    Set dT_CWA_Hepta_G_E = 0,!- <none>
    Set dT_W_Hepta_G_E    = (t_NodeIn_Hepta_G_E - t_NodeOut_Hepta_G_E),  !- <none>
    Set dT_WA_Hepta_G_E = (t_NodeIn_Hepta_G_E + t_NodeOut_Hepta_G_E) / 2,  !- <none>
    Set dT_WA_Hepta_G_E = dT_WA_Hepta_G_E - t_AirNode_Zone_G_E,  !- <none>
    IF (dT_W_Hepta_G_E > 0), !- <none>
    Set dT_HW_Hepta_G_E    = dT_W_Hepta_G_E,  !- <none>
    Set dT_HWA_Hepta_G_E = dT_WA_Hepta_G_E,  !- <none>
    Set dT_HW_Hepta_G_E_Num = dT_HW_Hepta_G_E_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_E_Sum = dT_HW_Hepta_G_E_Sum + dT_HW_Hepta_G_E,  !- <none>
    Set dT_HW_Hepta_G_E_Avg = dT_HW_Hepta_G_E_Sum / dT_HW_Hepta_G_E_Num,  !- <none>
    Set dT_HWA_Hepta_G_E_Num = dT_HWA_Hepta_G_E_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_E_Sum = dT_HWA_Hepta_G_E_Sum + dT_HWA_Hepta_G_E,  !- <none>
    Set dT_HWA_Hepta_G_E_Avg = dT_HWA_Hepta_G_E_Sum / dT_HWA_Hepta_G_E_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_E < 0),  !- <none>
    Set dT_CW_Hepta_G_E    = 0.0 - dT_W_Hepta_G_E,  !- <none>
    Set dT_CWA_Hepta_G_E = 0.0 - dT_WA_Hepta_G_E,  !- <none>
    Set dT_CW_Hepta_G_E_Num = dT_CW_Hepta_G_E_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_E_Sum = dT_CW_Hepta_G_E_Sum + dT_CW_Hepta_G_E,  !- <none>
    Set dT_CW_Hepta_G_E_Avg = dT_CW_Hepta_G_E_Sum / dT_CW_Hepta_G_E_Num,  !- <none>
    Set dT_CWA_Hepta_G_E_Num = dT_CWA_Hepta_G_E_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_E_Sum = dT_CWA_Hepta_G_E_Sum + dT_CWA_Hepta_G_E,  !- <none>
    Set dT_CWA_Hepta_G_E_Avg = dT_CWA_Hepta_G_E_Sum / dT_CWA_Hepta_G_E_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_E;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_E,  !- Name
    Run InitConvCoeff_Sf_Zone_G_E,  !- Program Line 1
    IF (dT_W_Hepta_G_E > 0), !- Program Line 2
    IF (dT_HWA_Hepta_G_E <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_E = (6.12 + (0.18 * (dT_HWA_Hepta_G_E^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_E,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_E < 0),  !- <none>
    IF (dT_CWA_Hepta_G_E <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_E = 6.12 + (2.76 * (dT_CWA_Hepta_G_E^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_E,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_E,  !- Name
    Set ConvCoeff_Hepta_Roof_G_E  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_E,!- Name
    Set ConvCoeff_Hepta_Roof_G_E  = ConvCoeffToSet_Hepta_G_E;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_E,     !- Name
    LowTempRadiantVarFlow_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_E,     !- Name
    LowTempRadiantVarFlow_Hepta_G_E,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_E_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_E_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_E_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_E_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_E_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_E_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_E_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_E_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_E_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_E_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_E_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_E_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_E_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_E_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_E_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_E_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_E_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_E_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_E_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_E_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_E_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_E_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_E_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_E_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_E_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_E_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_E_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_E_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_E: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_E_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_G_N
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_N { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_N,  !- Name
    Zone_G_N,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_N,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_N;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_N,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_N,  !- Name
    Schedule_TemperatureMinimum_Zone_G_N,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_N;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_N,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_N,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_N,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_N,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_N,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_N,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_N_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_N,                !- Zone Name
    ZoneHvacEquipmentList_G_N,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_N,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_N,    !- Zone Air Node Name
    AirNode_G_N_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_N =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_N; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_N Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_N, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_N; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_N Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_N, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_N,  !- Name
    Set Heating_Energy_Zone_G_N = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_N = Heating_Energy_Zone_G_N + Q_Heating_Abx_G_N,  !- Program Line 2
    Set Heating_Energy_Zone_G_N = Heating_Energy_Zone_G_N + Q_Heating_Hepta_G_N;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_N,  !- Name
    Set Cooling_Energy_Zone_G_N = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_N = Cooling_Energy_Zone_G_N + Q_Cooling_Abx_G_N,  !- Program Line 2
    Set Cooling_Energy_Zone_G_N = Cooling_Energy_Zone_G_N + Q_Cooling_Hepta_G_N;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_N
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_N { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_N,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_N,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_N,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_N,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_N;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_N,  !- Name
    Schedule_Availability_Abx_G_N;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_N,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_N,  !- Name
    Schedule_Availability_Abx_G_N,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_N_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_N,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_N_FanAvail,     !- Name
    Schedule_Availability_Abx_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_N_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_N_Fan,         !- Name
    FanVariableVolume_Abx_G_N,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_N,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_N_Fan = 0, !- Program Line 2
    IF (Is_Abx_G_N_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_N > 0.1),  !- <none>
    Set MFR_Abx_G_N_Fan =    0.104500003 * rho_Abx_G_N_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_N_Fan =    0.071133330 * rho_Abx_G_N_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_N_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_N_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_N_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_N_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_N,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_N_SupplyAir = t_Abx_G_N_WaterSupply - t_Abx_G_N_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_N_SupplyAir = 0.794871807 * TempSP_Abx_G_N_SupplyAir,  !- <none>
    Set TempSP_Abx_G_N_SupplyAir = t_Abx_G_N_OutdoorAir + TempSP_Abx_G_N_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_N_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_N,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_N_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_N,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_N,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_N,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_N,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_N_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_N_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_N,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_N,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_N,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_N_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_N,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_N;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_N,  !- Name
    AirBranch_Abx_G_N;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_N,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_N; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_N, !- Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_N,!- Name
    ControllerList_Abx_G_N_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_N,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_N;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_N,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_N_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_N;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_N,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_N_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_N;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_N,  !- Name
    Schedule_Availability_Abx_G_N,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_N_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_N_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_N,         !- Name
    ControllerList_Abx_G_N_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_N,!- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_N,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_N_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_N_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_N_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_N,       !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_N,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_N_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_N,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_N_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_N,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_N_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_N_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_N,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_N_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_N,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_N_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_N_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_N,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_N_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_N;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_N,!- Name
    AirNode_AirLoopReturnPath_Abx_G_N_Outlet,  !- Outlet Node Name
    AirNode_G_N_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_N,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_N_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_N;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_N,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_N_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_N;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_N,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_N,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_N_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_N,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_N,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_N_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_N,     !- Name
    AirNode_OutdoorAirMixer_Abx_G_N_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_N,    !- Name
    AirNode_WaterCoolingCoil_Abx_G_N_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_N,         !- Name
    AirNode_FanVariableVolume_Abx_G_N_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_N;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_N;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_N;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_N;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_N;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(HWater) {K}, !- Name
    dT_HW_Abx_G_N,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(CWater) {K}, !- Name
    dT_CW_Abx_G_N,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_N,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_N,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_N,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_N_TempDiff,   !- Name
    Set dT_HW_Abx_G_N  = 0,  !- Program Line 1
    Set dT_CW_Abx_G_N = 0,   !- Program Line 2
    Set t_AvgAir_Abx_G_N = 0,!- <none>
    Set dT_HWA_Abx_G_N  = 0, !- <none>
    Set dT_CWA_Abx_G_N = 0,  !- <none>
    IF (MFR_Air_Abx_G_N > 0),!- <none>
    Set t_AvgAir_Abx_G_N = t_AirNodeOut_Abx_G_N + t_AirNodeIn_Abx_G_N,  !- <none>
    Set t_AvgAir_Abx_G_N = t_AvgAir_Abx_G_N / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_N = t_NodeIn_AbxHC_G_N - t_NodeOut_AbxHC_G_N,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_N = t_NodeOut_AbxCC_G_N - t_NodeIn_AbxCC_G_N,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_N <> 0), !- <none>
    IF (dT_HW_Abx_G_N < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_N = t_NodeOut_AbxHC_G_N + t_NodeIn_AbxHC_G_N,  !- <none>
    Set dT_HWA_Abx_G_N = dT_HWA_Abx_G_N / 2,  !- <none>
    Set dT_HWA_Abx_G_N = dT_HWA_Abx_G_N - t_AvgAir_Abx_G_N,  !- <none>
    Set dT_HW_Abx_G_N_Num = dT_HW_Abx_G_N_Num + 1,  !- <none>
    Set dT_HW_Abx_G_N_Sum = dT_HW_Abx_G_N_Sum + dT_HW_Abx_G_N,  !- <none>
    Set dT_HW_Abx_G_N_Avg = dT_HW_Abx_G_N_Sum / dT_HW_Abx_G_N_Num,  !- <none>
    Set dT_HWA_Abx_G_N_Num = dT_HWA_Abx_G_N_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_N_Sum = dT_HWA_Abx_G_N_Sum + dT_HWA_Abx_G_N,  !- <none>
    Set dT_HWA_Abx_G_N_Avg = dT_HWA_Abx_G_N_Sum / dT_HWA_Abx_G_N_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_N <> 0),  !- <none>
    IF (dT_CW_Abx_G_N < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_N = t_NodeIn_AbxCC_G_N + t_NodeOut_AbxCC_G_N,  !- <none>
    Set dT_CWA_Abx_G_N = dT_CWA_Abx_G_N / 2,  !- <none>
    Set dT_CWA_Abx_G_N = dT_CWA_Abx_G_N - t_AvgAir_Abx_G_N,  !- <none>
    Set dT_CW_Abx_G_N_Num = dT_CW_Abx_G_N_Num + 1,  !- <none>
    Set dT_CW_Abx_G_N_Sum = dT_CW_Abx_G_N_Sum + dT_CW_Abx_G_N,  !- <none>
    Set dT_CW_Abx_G_N_Avg = dT_CW_Abx_G_N_Sum / dT_CW_Abx_G_N_Num,  !- <none>
    Set dT_CWA_Abx_G_N_Num = dT_CWA_Abx_G_N_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_N_Sum = dT_CWA_Abx_G_N_Sum + dT_CWA_Abx_G_N,  !- <none>
    Set dT_CWA_Abx_G_N_Avg = dT_CWA_Abx_G_N_Sum / dT_CWA_Abx_G_N_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_N,       !- Name
    WaterHeatingCoil_Abx_G_N,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_N,       !- Name
    WaterCoolingCoil_Abx_G_N,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_N_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_N_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_N_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_N_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_N_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_N_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_N_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_N_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_N_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_N_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_N_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_N_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_N_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_N_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_N_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_N_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_N_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_N_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_N_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_N_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_N_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_N_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_N_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_N_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_N_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_N_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_N_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_N_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_N: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_N_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_N
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_N Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 2076 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 3992 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_N { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_N,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_N,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_N,  !- Name
    Roof G_N Hepta,          !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_N,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_N,                !- Zone Name
    LowTempRadiantSurfaceGroup_G_N,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.23875597E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_N_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_N_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_N,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.12416269E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_N_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_N_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_N,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Name
    0.23875597E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_N,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_N_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_N_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_N,  !- Name
    0.12416269E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_N,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_N_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_N_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_N,      !- Name
    AirNode_ZoneNode_G_N,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_N,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_N,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_N,           !- Name
    LowTempRadiantVarFlow_Hepta_G_N,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_N,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_N = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_N,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_N = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_G_N < t_Sp_Heating_Hepta_G_N + 0.07 ),  !- <none>
    Set MFR_Hepta_G_N =   0.238755986,  !- <none>
    ELSEIF (t_AirNode_Zone_G_N > t_Sp_Cooling_Hepta_G_N - 0.07 ),  !- <none>
    Set MFR_Hepta_G_N =   0.124162681,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_N,      !- Name
    LowTempRadiantVarFlow_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_N,     !- Name
    LowTempRadiantVarFlow_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_N;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_N;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_N;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_N;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_N;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_N;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(Water) {K},!- Name
    dT_W_Hepta_G_N,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_N,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_N,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_N,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_N,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_N,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_N_TempDiff, !- Name
    Set dT_W_Hepta_G_N  = 0, !- Program Line 1
    Set dT_HW_Hepta_G_N = 0, !- Program Line 2
    Set dT_CW_Hepta_G_N = 0, !- <none>
    Set dT_WA_Hepta_G_N  = 0,!- <none>
    Set dT_HWA_Hepta_G_N = 0,!- <none>
    Set dT_CWA_Hepta_G_N = 0,!- <none>
    Set dT_W_Hepta_G_N    = (t_NodeIn_Hepta_G_N - t_NodeOut_Hepta_G_N),  !- <none>
    Set dT_WA_Hepta_G_N = (t_NodeIn_Hepta_G_N + t_NodeOut_Hepta_G_N) / 2,  !- <none>
    Set dT_WA_Hepta_G_N = dT_WA_Hepta_G_N - t_AirNode_Zone_G_N,  !- <none>
    IF (dT_W_Hepta_G_N > 0), !- <none>
    Set dT_HW_Hepta_G_N    = dT_W_Hepta_G_N,  !- <none>
    Set dT_HWA_Hepta_G_N = dT_WA_Hepta_G_N,  !- <none>
    Set dT_HW_Hepta_G_N_Num = dT_HW_Hepta_G_N_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_N_Sum = dT_HW_Hepta_G_N_Sum + dT_HW_Hepta_G_N,  !- <none>
    Set dT_HW_Hepta_G_N_Avg = dT_HW_Hepta_G_N_Sum / dT_HW_Hepta_G_N_Num,  !- <none>
    Set dT_HWA_Hepta_G_N_Num = dT_HWA_Hepta_G_N_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_N_Sum = dT_HWA_Hepta_G_N_Sum + dT_HWA_Hepta_G_N,  !- <none>
    Set dT_HWA_Hepta_G_N_Avg = dT_HWA_Hepta_G_N_Sum / dT_HWA_Hepta_G_N_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_N < 0),  !- <none>
    Set dT_CW_Hepta_G_N    = 0.0 - dT_W_Hepta_G_N,  !- <none>
    Set dT_CWA_Hepta_G_N = 0.0 - dT_WA_Hepta_G_N,  !- <none>
    Set dT_CW_Hepta_G_N_Num = dT_CW_Hepta_G_N_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_N_Sum = dT_CW_Hepta_G_N_Sum + dT_CW_Hepta_G_N,  !- <none>
    Set dT_CW_Hepta_G_N_Avg = dT_CW_Hepta_G_N_Sum / dT_CW_Hepta_G_N_Num,  !- <none>
    Set dT_CWA_Hepta_G_N_Num = dT_CWA_Hepta_G_N_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_N_Sum = dT_CWA_Hepta_G_N_Sum + dT_CWA_Hepta_G_N,  !- <none>
    Set dT_CWA_Hepta_G_N_Avg = dT_CWA_Hepta_G_N_Sum / dT_CWA_Hepta_G_N_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_N;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_N,  !- Name
    Run InitConvCoeff_Sf_Zone_G_N,  !- Program Line 1
    IF (dT_W_Hepta_G_N > 0), !- Program Line 2
    IF (dT_HWA_Hepta_G_N <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_N = (6.12 + (0.18 * (dT_HWA_Hepta_G_N^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_N,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_N < 0),  !- <none>
    IF (dT_CWA_Hepta_G_N <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_N = 6.12 + (2.76 * (dT_CWA_Hepta_G_N^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_N,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_N,  !- Name
    Set ConvCoeff_Hepta_Roof_G_N  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_N,!- Name
    Set ConvCoeff_Hepta_Roof_G_N  = ConvCoeffToSet_Hepta_G_N;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_N,     !- Name
    LowTempRadiantVarFlow_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_N,     !- Name
    LowTempRadiantVarFlow_Hepta_G_N,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_N_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_N_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_N_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_N_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_N_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_N_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_N_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_N_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_N_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_N_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_N_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_N_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_N_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_N_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_N_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_N_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_N_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_N_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_N_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_N_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_N_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_N_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_N_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_N_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_N_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_N_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_N_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_N_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_N: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_N_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_G_NE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_NE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_NE,  !- Name
    Zone_G_NE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_NE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_NE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_NE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_NE,  !- Name
    Schedule_TemperatureMinimum_Zone_G_NE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_NE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_NE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_NE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_NE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_NE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_G_NE,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_G_NE, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_NE,               !- Zone Name
    ZoneHvacEquipmentList_G_NE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_NE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_NE,   !- Zone Air Node Name
    AirNode_G_NE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_NE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_NE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_NE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_NE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_NE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_NE,  !- Name
    Set Heating_Energy_Zone_G_NE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_NE = Heating_Energy_Zone_G_NE + Q_Heating_Abx_G_NE,  !- Program Line 2
    Set Heating_Energy_Zone_G_NE = Heating_Energy_Zone_G_NE + Q_Heating_Hepta_G_NE,  !- <none>
    Set Heating_Energy_Zone_G_NE = Heating_Energy_Zone_G_NE + Q_Heating_WaterConvective_G_NE,  !- <none>
    Set Heating_Energy_Zone_G_NE = Heating_Energy_Zone_G_NE + Q_Heating_RecircAbx_G_NE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_NE,  !- Name
    Set Cooling_Energy_Zone_G_NE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_NE = Cooling_Energy_Zone_G_NE + Q_Cooling_Abx_G_NE,  !- Program Line 2
    Set Cooling_Energy_Zone_G_NE = Cooling_Energy_Zone_G_NE + Q_Cooling_Hepta_G_NE;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_NE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 2 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_NE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_NE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_NE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_NE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_NE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_NE,  !- Name
    Schedule_Availability_Abx_G_NE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_NE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_NE,  !- Name
    Schedule_Availability_Abx_G_NE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.052250002,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.035566665,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_NE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_NE_FanAvail,    !- Name
    Schedule_Availability_Abx_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_NE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_NE_Fan,        !- Name
    FanVariableVolume_Abx_G_NE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_NE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_NE_Fan = 0,!- Program Line 2
    IF (Is_Abx_G_NE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_NE > 0.1),  !- <none>
    Set MFR_Abx_G_NE_Fan =    0.052250002 * rho_Abx_G_NE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_NE_Fan =    0.035566665 * rho_Abx_G_NE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_NE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_NE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_NE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_NE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_NE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_NE_SupplyAir = t_Abx_G_NE_WaterSupply - t_Abx_G_NE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_NE_SupplyAir = 0.794871807 * TempSP_Abx_G_NE_SupplyAir,  !- <none>
    Set TempSP_Abx_G_NE_SupplyAir = t_Abx_G_NE_OutdoorAir + TempSP_Abx_G_NE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_NE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_NE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    82.720001221,            !- U-Factor Times Area Value {W/K}
    0.74960124E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    1880,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NE,  !- Name
    0.74960124E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_NE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_NE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.74960124E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_NE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.53827753E-04,          !- Design Water Flow Rate {m3/s}
    0.055555556,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NE,  !- Name
    0.80741615E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_NE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_NE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.80741615E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_NE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_NE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_NE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_NE, !- Name
    AirBranch_Abx_G_NE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_NE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_NE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_NE,!- Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_NE,  !- Name
    ControllerList_Abx_G_NE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_NE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_NE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_OutdoorInlet,  !- Actuator Node Name
    0.035566665,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.052250002,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_NE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_NE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_NE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_NE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_NE,  !- Name
    Schedule_Availability_Abx_G_NE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NE_Inlet,  !- Air Inlet Node Name
    0.052250002,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.035566665;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_NE,        !- Name
    ControllerList_Abx_G_NE_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_NE,  !- Availability Manager List Name
    0.052250002,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_NE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_NE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_NE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_NE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_NE,      !- Name
    0.052250002,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_NE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_NE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_NE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_NE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_NE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_NE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_NE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_NE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_NE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_NE_Outlet,  !- Outlet Node Name
    AirNode_G_NE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_NE,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_NE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_NE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_NE,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_NE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_NE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_NE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_NE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_NE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_NE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_NE,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_NE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_NE,   !- Name
    AirNode_WaterCoolingCoil_Abx_G_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_NE,        !- Name
    AirNode_FanVariableVolume_Abx_G_NE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(HWater) {K},!- Name
    dT_HW_Abx_G_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(CWater) {K},!- Name
    dT_CW_Abx_G_NE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_NE_TempDiff,  !- Name
    Set dT_HW_Abx_G_NE  = 0, !- Program Line 1
    Set dT_CW_Abx_G_NE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_G_NE = 0,  !- <none>
    Set dT_HWA_Abx_G_NE  = 0,!- <none>
    Set dT_CWA_Abx_G_NE = 0, !- <none>
    IF (MFR_Air_Abx_G_NE > 0),  !- <none>
    Set t_AvgAir_Abx_G_NE = t_AirNodeOut_Abx_G_NE + t_AirNodeIn_Abx_G_NE,  !- <none>
    Set t_AvgAir_Abx_G_NE = t_AvgAir_Abx_G_NE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_NE = t_NodeIn_AbxHC_G_NE - t_NodeOut_AbxHC_G_NE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_NE = t_NodeOut_AbxCC_G_NE - t_NodeIn_AbxCC_G_NE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_NE <> 0),!- <none>
    IF (dT_HW_Abx_G_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_NE = t_NodeOut_AbxHC_G_NE + t_NodeIn_AbxHC_G_NE,  !- <none>
    Set dT_HWA_Abx_G_NE = dT_HWA_Abx_G_NE / 2,  !- <none>
    Set dT_HWA_Abx_G_NE = dT_HWA_Abx_G_NE - t_AvgAir_Abx_G_NE,  !- <none>
    Set dT_HW_Abx_G_NE_Num = dT_HW_Abx_G_NE_Num + 1,  !- <none>
    Set dT_HW_Abx_G_NE_Sum = dT_HW_Abx_G_NE_Sum + dT_HW_Abx_G_NE,  !- <none>
    Set dT_HW_Abx_G_NE_Avg = dT_HW_Abx_G_NE_Sum / dT_HW_Abx_G_NE_Num,  !- <none>
    Set dT_HWA_Abx_G_NE_Num = dT_HWA_Abx_G_NE_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_NE_Sum = dT_HWA_Abx_G_NE_Sum + dT_HWA_Abx_G_NE,  !- <none>
    Set dT_HWA_Abx_G_NE_Avg = dT_HWA_Abx_G_NE_Sum / dT_HWA_Abx_G_NE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_NE <> 0),  !- <none>
    IF (dT_CW_Abx_G_NE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_NE = t_NodeIn_AbxCC_G_NE + t_NodeOut_AbxCC_G_NE,  !- <none>
    Set dT_CWA_Abx_G_NE = dT_CWA_Abx_G_NE / 2,  !- <none>
    Set dT_CWA_Abx_G_NE = dT_CWA_Abx_G_NE - t_AvgAir_Abx_G_NE,  !- <none>
    Set dT_CW_Abx_G_NE_Num = dT_CW_Abx_G_NE_Num + 1,  !- <none>
    Set dT_CW_Abx_G_NE_Sum = dT_CW_Abx_G_NE_Sum + dT_CW_Abx_G_NE,  !- <none>
    Set dT_CW_Abx_G_NE_Avg = dT_CW_Abx_G_NE_Sum / dT_CW_Abx_G_NE_Num,  !- <none>
    Set dT_CWA_Abx_G_NE_Num = dT_CWA_Abx_G_NE_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_NE_Sum = dT_CWA_Abx_G_NE_Sum + dT_CWA_Abx_G_NE,  !- <none>
    Set dT_CWA_Abx_G_NE_Avg = dT_CWA_Abx_G_NE_Sum / dT_CWA_Abx_G_NE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_NE,      !- Name
    WaterHeatingCoil_Abx_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_NE,      !- Name
    WaterCoolingCoil_Abx_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_NE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_NE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_NE_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_NE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_NE_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_NE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_NE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_NE_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_NE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_NE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_NE Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1038 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1996 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_NE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_NE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_NE,  !- Name
    Roof G_NE Hepta,         !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_NE,               !- Zone Name
    LowTempRadiantSurfaceGroup_G_NE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11937799E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_NE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.62081344E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_NE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Name
    0.11937799E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE,  !- Name
    0.62081344E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_NE,     !- Name
    AirNode_ZoneNode_G_NE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_NE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_NE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_NE,          !- Name
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_NE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_NE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_NE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_NE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_G_NE < t_Sp_Heating_Hepta_G_NE + 0.07 ),  !- <none>
    Set MFR_Hepta_G_NE =   0.119377993,  !- <none>
    ELSEIF (t_AirNode_Zone_G_NE > t_Sp_Cooling_Hepta_G_NE - 0.07 ),  !- <none>
    Set MFR_Hepta_G_NE =   0.062081341,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_NE,     !- Name
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(Water) {K},  !- Name
    dT_W_Hepta_G_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_NE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_NE_TempDiff,!- Name
    Set dT_W_Hepta_G_NE  = 0,!- Program Line 1
    Set dT_HW_Hepta_G_NE = 0,!- Program Line 2
    Set dT_CW_Hepta_G_NE = 0,!- <none>
    Set dT_WA_Hepta_G_NE  = 0,  !- <none>
    Set dT_HWA_Hepta_G_NE = 0,  !- <none>
    Set dT_CWA_Hepta_G_NE = 0,  !- <none>
    Set dT_W_Hepta_G_NE    = (t_NodeIn_Hepta_G_NE - t_NodeOut_Hepta_G_NE),  !- <none>
    Set dT_WA_Hepta_G_NE = (t_NodeIn_Hepta_G_NE + t_NodeOut_Hepta_G_NE) / 2,  !- <none>
    Set dT_WA_Hepta_G_NE = dT_WA_Hepta_G_NE - t_AirNode_Zone_G_NE,  !- <none>
    IF (dT_W_Hepta_G_NE > 0),!- <none>
    Set dT_HW_Hepta_G_NE    = dT_W_Hepta_G_NE,  !- <none>
    Set dT_HWA_Hepta_G_NE = dT_WA_Hepta_G_NE,  !- <none>
    Set dT_HW_Hepta_G_NE_Num = dT_HW_Hepta_G_NE_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_NE_Sum = dT_HW_Hepta_G_NE_Sum + dT_HW_Hepta_G_NE,  !- <none>
    Set dT_HW_Hepta_G_NE_Avg = dT_HW_Hepta_G_NE_Sum / dT_HW_Hepta_G_NE_Num,  !- <none>
    Set dT_HWA_Hepta_G_NE_Num = dT_HWA_Hepta_G_NE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_NE_Sum = dT_HWA_Hepta_G_NE_Sum + dT_HWA_Hepta_G_NE,  !- <none>
    Set dT_HWA_Hepta_G_NE_Avg = dT_HWA_Hepta_G_NE_Sum / dT_HWA_Hepta_G_NE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_NE < 0),  !- <none>
    Set dT_CW_Hepta_G_NE    = 0.0 - dT_W_Hepta_G_NE,  !- <none>
    Set dT_CWA_Hepta_G_NE = 0.0 - dT_WA_Hepta_G_NE,  !- <none>
    Set dT_CW_Hepta_G_NE_Num = dT_CW_Hepta_G_NE_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_NE_Sum = dT_CW_Hepta_G_NE_Sum + dT_CW_Hepta_G_NE,  !- <none>
    Set dT_CW_Hepta_G_NE_Avg = dT_CW_Hepta_G_NE_Sum / dT_CW_Hepta_G_NE_Num,  !- <none>
    Set dT_CWA_Hepta_G_NE_Num = dT_CWA_Hepta_G_NE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_NE_Sum = dT_CWA_Hepta_G_NE_Sum + dT_CWA_Hepta_G_NE,  !- <none>
    Set dT_CWA_Hepta_G_NE_Avg = dT_CWA_Hepta_G_NE_Sum / dT_CWA_Hepta_G_NE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_NE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_NE, !- Name
    Run InitConvCoeff_Sf_Zone_G_NE,  !- Program Line 1
    IF (dT_W_Hepta_G_NE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_G_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_NE = (6.12 + (0.18 * (dT_HWA_Hepta_G_NE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_NE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_NE < 0),  !- <none>
    IF (dT_CWA_Hepta_G_NE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_NE = 6.12 + (2.76 * (dT_CWA_Hepta_G_NE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_NE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_NE,  !- Name
    Set ConvCoeff_Hepta_Roof_G_NE  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_NE,  !- Name
    Set ConvCoeff_Hepta_Roof_G_NE  = ConvCoeffToSet_Hepta_G_NE;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_NE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_NE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_NE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_NE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_NE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_NE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_NE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_NE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_NE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_NE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR G_NE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 300 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_NE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_G_NE,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_G_NE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_G_NE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    24,                      !- U-Factor Times Area Value {W/K}
    0.23923447E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_G_NE,  !- Name
    0.23923447E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_G_NE,    !- Component 1 Name
    Node_HwDemand_WaterConvective_G_NE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_G_NE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_G_NE,  !- Name
    WaterConvective_G_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_G_NE,      !- Name
    WaterConvective_G_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_G_NE,     !- Name
    WaterConvective_G_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_G_NE,   !- Name
    WaterConvective_G_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_G_NE,  !- Name
    WaterConvective_G_NE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_G_NE;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NE: dT(HWater) {K},  !- Name
    dT_HW_Conv_G_NE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_NE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_G_NE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_NE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_G_NE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_G_NE_TempDiff, !- Name
    Set dT_HW_Conv_G_NE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_G_NE = 0,  !- Program Line 2
    Set dT_HWA_Conv_G_NE   = 0,  !- <none>
    Set dT_HW_Conv_G_NE    = t_NodeIn_Conv_G_NE - t_NodeOut_Conv_G_NE,  !- <none>
    IF (dT_HW_Conv_G_NE > 0),!- <none>
    Set t_AvgAir_Conv_G_NE = t_AirNodeOut_Conv_G_NE + t_AirNodeIn_Conv_G_NE,  !- <none>
    Set t_AvgAir_Conv_G_NE = t_AvgAir_Conv_G_NE / 2,  !- <none>
    Set dT_HWA_Conv_G_NE = t_NodeOut_Conv_G_NE + t_NodeIn_Conv_G_NE,  !- <none>
    Set dT_HWA_Conv_G_NE = dT_HWA_Conv_G_NE / 2,  !- <none>
    Set dT_HWA_Conv_G_NE = dT_HWA_Conv_G_NE - t_AvgAir_Conv_G_NE,  !- <none>
    Set dT_HW_Conv_G_NE_Num = dT_HW_Conv_G_NE_Num + 1,  !- <none>
    Set dT_HW_Conv_G_NE_Sum = dT_HW_Conv_G_NE_Sum + dT_HW_Conv_G_NE,  !- <none>
    Set dT_HW_Conv_G_NE_Avg = dT_HW_Conv_G_NE_Sum / dT_HW_Conv_G_NE_Num,  !- <none>
    Set dT_HWA_Conv_G_NE_Num = dT_HWA_Conv_G_NE_Num + 1,  !- <none>
    Set dT_HWA_Conv_G_NE_Sum = dT_HWA_Conv_G_NE_Sum + dT_HWA_Conv_G_NE,  !- <none>
    Set dT_HWA_Conv_G_NE_Avg = dT_HWA_Conv_G_NE_Sum / dT_HWA_Conv_G_NE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_G_NE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_G_NE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_G_NE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_G_NE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_G_NE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_G_NE_Num = 0,  !- <none>
    Set dT_HWA_Conv_G_NE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_G_NE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_G_NE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX G_NE
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = G_NE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_G_NE, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_G_NE,!- Name
    ElectricConvective_G_NE, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_G_NW
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_NW { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_NW,  !- Name
    Zone_G_NW,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_NW,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_NW;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_NW,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_NW,  !- Name
    Schedule_TemperatureMinimum_Zone_G_NW,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_NW;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_NW,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_NW,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_NW,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_NW,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_G_NW,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_G_NW, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_NW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NW_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_NW,               !- Zone Name
    ZoneHvacEquipmentList_G_NW,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_NW,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_NW,   !- Zone Air Node Name
    AirNode_G_NW_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_NW =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_NW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_NW Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_NW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_NW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_NW Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_NW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_NW,  !- Name
    Set Heating_Energy_Zone_G_NW = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_NW = Heating_Energy_Zone_G_NW + Q_Heating_Abx_G_NW,  !- Program Line 2
    Set Heating_Energy_Zone_G_NW = Heating_Energy_Zone_G_NW + Q_Heating_Hepta_G_NW,  !- <none>
    Set Heating_Energy_Zone_G_NW = Heating_Energy_Zone_G_NW + Q_Heating_WaterConvective_G_NW,  !- <none>
    Set Heating_Energy_Zone_G_NW = Heating_Energy_Zone_G_NW + Q_Heating_RecircAbx_G_NW;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_NW,  !- Name
    Set Cooling_Energy_Zone_G_NW = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_NW = Cooling_Energy_Zone_G_NW + Q_Cooling_Abx_G_NW,  !- Program Line 2
    Set Cooling_Energy_Zone_G_NW = Cooling_Energy_Zone_G_NW + Q_Cooling_Hepta_G_NW;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_NW
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 2 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_NW { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_NW,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_NW,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_NW,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_NW;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_NW,  !- Name
    Schedule_Availability_Abx_G_NW;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_NW,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_NW,  !- Name
    Schedule_Availability_Abx_G_NW,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.052250002,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.035566665,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_NW,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_NW_FanAvail,    !- Name
    Schedule_Availability_Abx_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_NW_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_NW_Fan,        !- Name
    FanVariableVolume_Abx_G_NW,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_NW,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_NW_Fan = 0,!- Program Line 2
    IF (Is_Abx_G_NW_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_NW > 0.1),  !- <none>
    Set MFR_Abx_G_NW_Fan =    0.052250002 * rho_Abx_G_NW_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_NW_Fan =    0.035566665 * rho_Abx_G_NW_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_NW_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_NW_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_NW_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_NW_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_NW,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_NW_SupplyAir = t_Abx_G_NW_WaterSupply - t_Abx_G_NW_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_NW_SupplyAir = 0.794871807 * TempSP_Abx_G_NW_SupplyAir,  !- <none>
    Set TempSP_Abx_G_NW_SupplyAir = t_Abx_G_NW_OutdoorAir + TempSP_Abx_G_NW_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_NW_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_NW,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    82.720001221,            !- U-Factor Times Area Value {W/K}
    0.74960124E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    1880,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_NW,  !- Name
    0.74960124E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_NW,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_NW,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.74960124E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_NW,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.53827753E-04,          !- Design Water Flow Rate {m3/s}
    0.055555556,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_NW,  !- Name
    0.80741615E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_NW,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_NW,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.80741615E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_NW_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_NW,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_NW;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_NW, !- Name
    AirBranch_Abx_G_NW;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_NW,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_NW;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_NW,!- Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_NW,  !- Name
    ControllerList_Abx_G_NW_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_NW,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_NW;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_NW,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_OutdoorInlet,  !- Actuator Node Name
    0.035566665,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.052250002,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_NW_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_NW;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_NW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NW_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_NW;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_NW,  !- Name
    Schedule_Availability_Abx_G_NW,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NW_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NW_Inlet,  !- Air Inlet Node Name
    0.052250002,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.035566665;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_NW,        !- Name
    ControllerList_Abx_G_NW_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_NW,  !- Availability Manager List Name
    0.052250002,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_NW, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_NW_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_NW_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_NW_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_NW,      !- Name
    0.052250002,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_NW,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_NW_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_NW,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_NW,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_NW,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_NW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_NW_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_NW_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_NW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_NW_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_NW;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_NW,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_NW_Outlet,  !- Outlet Node Name
    AirNode_G_NW_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_NW,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_NW_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_NW;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_NW,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_NW_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_NW;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_NW,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_NW,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_NW,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_NW,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_NW,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_NW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_NW,   !- Name
    AirNode_WaterCoolingCoil_Abx_G_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_NW,        !- Name
    AirNode_FanVariableVolume_Abx_G_NW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(HWater) {K},!- Name
    dT_HW_Abx_G_NW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(CWater) {K},!- Name
    dT_CW_Abx_G_NW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_NW_TempDiff,  !- Name
    Set dT_HW_Abx_G_NW  = 0, !- Program Line 1
    Set dT_CW_Abx_G_NW = 0,  !- Program Line 2
    Set t_AvgAir_Abx_G_NW = 0,  !- <none>
    Set dT_HWA_Abx_G_NW  = 0,!- <none>
    Set dT_CWA_Abx_G_NW = 0, !- <none>
    IF (MFR_Air_Abx_G_NW > 0),  !- <none>
    Set t_AvgAir_Abx_G_NW = t_AirNodeOut_Abx_G_NW + t_AirNodeIn_Abx_G_NW,  !- <none>
    Set t_AvgAir_Abx_G_NW = t_AvgAir_Abx_G_NW / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_NW = t_NodeIn_AbxHC_G_NW - t_NodeOut_AbxHC_G_NW,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_NW = t_NodeOut_AbxCC_G_NW - t_NodeIn_AbxCC_G_NW,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_NW <> 0),!- <none>
    IF (dT_HW_Abx_G_NW < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_NW = t_NodeOut_AbxHC_G_NW + t_NodeIn_AbxHC_G_NW,  !- <none>
    Set dT_HWA_Abx_G_NW = dT_HWA_Abx_G_NW / 2,  !- <none>
    Set dT_HWA_Abx_G_NW = dT_HWA_Abx_G_NW - t_AvgAir_Abx_G_NW,  !- <none>
    Set dT_HW_Abx_G_NW_Num = dT_HW_Abx_G_NW_Num + 1,  !- <none>
    Set dT_HW_Abx_G_NW_Sum = dT_HW_Abx_G_NW_Sum + dT_HW_Abx_G_NW,  !- <none>
    Set dT_HW_Abx_G_NW_Avg = dT_HW_Abx_G_NW_Sum / dT_HW_Abx_G_NW_Num,  !- <none>
    Set dT_HWA_Abx_G_NW_Num = dT_HWA_Abx_G_NW_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_NW_Sum = dT_HWA_Abx_G_NW_Sum + dT_HWA_Abx_G_NW,  !- <none>
    Set dT_HWA_Abx_G_NW_Avg = dT_HWA_Abx_G_NW_Sum / dT_HWA_Abx_G_NW_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_NW <> 0),  !- <none>
    IF (dT_CW_Abx_G_NW < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_NW = t_NodeIn_AbxCC_G_NW + t_NodeOut_AbxCC_G_NW,  !- <none>
    Set dT_CWA_Abx_G_NW = dT_CWA_Abx_G_NW / 2,  !- <none>
    Set dT_CWA_Abx_G_NW = dT_CWA_Abx_G_NW - t_AvgAir_Abx_G_NW,  !- <none>
    Set dT_CW_Abx_G_NW_Num = dT_CW_Abx_G_NW_Num + 1,  !- <none>
    Set dT_CW_Abx_G_NW_Sum = dT_CW_Abx_G_NW_Sum + dT_CW_Abx_G_NW,  !- <none>
    Set dT_CW_Abx_G_NW_Avg = dT_CW_Abx_G_NW_Sum / dT_CW_Abx_G_NW_Num,  !- <none>
    Set dT_CWA_Abx_G_NW_Num = dT_CWA_Abx_G_NW_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_NW_Sum = dT_CWA_Abx_G_NW_Sum + dT_CWA_Abx_G_NW,  !- <none>
    Set dT_CWA_Abx_G_NW_Avg = dT_CWA_Abx_G_NW_Sum / dT_CWA_Abx_G_NW_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_NW,      !- Name
    WaterHeatingCoil_Abx_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_NW,      !- Name
    WaterCoolingCoil_Abx_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_NW_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_NW_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_NW_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_NW_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_NW_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_NW_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_NW_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_NW_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_NW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_NW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_NW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_NW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_NW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_NW
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_NW Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1038 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1996 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_NW { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_NW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_NW,  !- Name
    Roof G_NW Hepta,         !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_NW,               !- Zone Name
    LowTempRadiantSurfaceGroup_G_NW,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11937799E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_NW,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.62081344E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_NW,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Name
    0.11937799E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW,  !- Name
    0.62081344E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_NW,     !- Name
    AirNode_ZoneNode_G_NW,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_NW, !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_NW, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_NW,          !- Name
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_NW,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_NW = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_NW,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_NW = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_G_NW < t_Sp_Heating_Hepta_G_NW + 0.07 ),  !- <none>
    Set MFR_Hepta_G_NW =   0.119377993,  !- <none>
    ELSEIF (t_AirNode_Zone_G_NW > t_Sp_Cooling_Hepta_G_NW - 0.07 ),  !- <none>
    Set MFR_Hepta_G_NW =   0.062081341,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_NW,     !- Name
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(Water) {K},  !- Name
    dT_W_Hepta_G_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_NW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_NW_TempDiff,!- Name
    Set dT_W_Hepta_G_NW  = 0,!- Program Line 1
    Set dT_HW_Hepta_G_NW = 0,!- Program Line 2
    Set dT_CW_Hepta_G_NW = 0,!- <none>
    Set dT_WA_Hepta_G_NW  = 0,  !- <none>
    Set dT_HWA_Hepta_G_NW = 0,  !- <none>
    Set dT_CWA_Hepta_G_NW = 0,  !- <none>
    Set dT_W_Hepta_G_NW    = (t_NodeIn_Hepta_G_NW - t_NodeOut_Hepta_G_NW),  !- <none>
    Set dT_WA_Hepta_G_NW = (t_NodeIn_Hepta_G_NW + t_NodeOut_Hepta_G_NW) / 2,  !- <none>
    Set dT_WA_Hepta_G_NW = dT_WA_Hepta_G_NW - t_AirNode_Zone_G_NW,  !- <none>
    IF (dT_W_Hepta_G_NW > 0),!- <none>
    Set dT_HW_Hepta_G_NW    = dT_W_Hepta_G_NW,  !- <none>
    Set dT_HWA_Hepta_G_NW = dT_WA_Hepta_G_NW,  !- <none>
    Set dT_HW_Hepta_G_NW_Num = dT_HW_Hepta_G_NW_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_NW_Sum = dT_HW_Hepta_G_NW_Sum + dT_HW_Hepta_G_NW,  !- <none>
    Set dT_HW_Hepta_G_NW_Avg = dT_HW_Hepta_G_NW_Sum / dT_HW_Hepta_G_NW_Num,  !- <none>
    Set dT_HWA_Hepta_G_NW_Num = dT_HWA_Hepta_G_NW_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_NW_Sum = dT_HWA_Hepta_G_NW_Sum + dT_HWA_Hepta_G_NW,  !- <none>
    Set dT_HWA_Hepta_G_NW_Avg = dT_HWA_Hepta_G_NW_Sum / dT_HWA_Hepta_G_NW_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_NW < 0),  !- <none>
    Set dT_CW_Hepta_G_NW    = 0.0 - dT_W_Hepta_G_NW,  !- <none>
    Set dT_CWA_Hepta_G_NW = 0.0 - dT_WA_Hepta_G_NW,  !- <none>
    Set dT_CW_Hepta_G_NW_Num = dT_CW_Hepta_G_NW_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_NW_Sum = dT_CW_Hepta_G_NW_Sum + dT_CW_Hepta_G_NW,  !- <none>
    Set dT_CW_Hepta_G_NW_Avg = dT_CW_Hepta_G_NW_Sum / dT_CW_Hepta_G_NW_Num,  !- <none>
    Set dT_CWA_Hepta_G_NW_Num = dT_CWA_Hepta_G_NW_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_NW_Sum = dT_CWA_Hepta_G_NW_Sum + dT_CWA_Hepta_G_NW,  !- <none>
    Set dT_CWA_Hepta_G_NW_Avg = dT_CWA_Hepta_G_NW_Sum / dT_CWA_Hepta_G_NW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_NW;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_NW, !- Name
    Run InitConvCoeff_Sf_Zone_G_NW,  !- Program Line 1
    IF (dT_W_Hepta_G_NW > 0),!- Program Line 2
    IF (dT_HWA_Hepta_G_NW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_NW = (6.12 + (0.18 * (dT_HWA_Hepta_G_NW^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_NW,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_NW < 0),  !- <none>
    IF (dT_CWA_Hepta_G_NW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_NW = 6.12 + (2.76 * (dT_CWA_Hepta_G_NW^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_NW,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_NW,  !- Name
    Set ConvCoeff_Hepta_Roof_G_NW  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_NW,  !- Name
    Set ConvCoeff_Hepta_Roof_G_NW  = ConvCoeffToSet_Hepta_G_NW;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_NW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_NW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_NW_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_NW_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_NW_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_NW_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_NW_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_NW_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_NW_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_NW_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_NW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_NW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_NW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_NW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_NW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR G_NW
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 300 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_NW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_G_NW,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_G_NW_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_G_NW_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    24,                      !- U-Factor Times Area Value {W/K}
    0.23923447E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_G_NW,  !- Name
    0.23923447E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_G_NW,    !- Component 1 Name
    Node_HwDemand_WaterConvective_G_NW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_G_NW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_G_NW,  !- Name
    WaterConvective_G_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_G_NW,      !- Name
    WaterConvective_G_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_G_NW,     !- Name
    WaterConvective_G_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_G_NW,   !- Name
    WaterConvective_G_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_G_NW,  !- Name
    WaterConvective_G_NW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_G_NW;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NW: dT(HWater) {K},  !- Name
    dT_HW_Conv_G_NW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_NW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_G_NW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_NW: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_G_NW,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_G_NW_TempDiff, !- Name
    Set dT_HW_Conv_G_NW    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_G_NW = 0,  !- Program Line 2
    Set dT_HWA_Conv_G_NW   = 0,  !- <none>
    Set dT_HW_Conv_G_NW    = t_NodeIn_Conv_G_NW - t_NodeOut_Conv_G_NW,  !- <none>
    IF (dT_HW_Conv_G_NW > 0),!- <none>
    Set t_AvgAir_Conv_G_NW = t_AirNodeOut_Conv_G_NW + t_AirNodeIn_Conv_G_NW,  !- <none>
    Set t_AvgAir_Conv_G_NW = t_AvgAir_Conv_G_NW / 2,  !- <none>
    Set dT_HWA_Conv_G_NW = t_NodeOut_Conv_G_NW + t_NodeIn_Conv_G_NW,  !- <none>
    Set dT_HWA_Conv_G_NW = dT_HWA_Conv_G_NW / 2,  !- <none>
    Set dT_HWA_Conv_G_NW = dT_HWA_Conv_G_NW - t_AvgAir_Conv_G_NW,  !- <none>
    Set dT_HW_Conv_G_NW_Num = dT_HW_Conv_G_NW_Num + 1,  !- <none>
    Set dT_HW_Conv_G_NW_Sum = dT_HW_Conv_G_NW_Sum + dT_HW_Conv_G_NW,  !- <none>
    Set dT_HW_Conv_G_NW_Avg = dT_HW_Conv_G_NW_Sum / dT_HW_Conv_G_NW_Num,  !- <none>
    Set dT_HWA_Conv_G_NW_Num = dT_HWA_Conv_G_NW_Num + 1,  !- <none>
    Set dT_HWA_Conv_G_NW_Sum = dT_HWA_Conv_G_NW_Sum + dT_HWA_Conv_G_NW,  !- <none>
    Set dT_HWA_Conv_G_NW_Avg = dT_HWA_Conv_G_NW_Sum / dT_HWA_Conv_G_NW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_G_NW_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_G_NW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_G_NW_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_G_NW_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_G_NW_Sum = 0,  !- <none>
    Set dT_HWA_Conv_G_NW_Num = 0,  !- <none>
    Set dT_HWA_Conv_G_NW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_NW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_G_NW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_NW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_NW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_G_NW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX G_NW
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = G_NW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_G_NW, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_G_NW,!- Name
    ElectricConvective_G_NW, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_G_S
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_S { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_S,  !- Name
    Zone_G_S,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_S,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_S;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_S,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_S,  !- Name
    Schedule_TemperatureMinimum_Zone_G_S,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_S;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_S,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_S,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_S,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_S,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_S,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_S,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_S_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_S,                !- Zone Name
    ZoneHvacEquipmentList_G_S,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_S,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_S,    !- Zone Air Node Name
    AirNode_G_S_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_S =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_S; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_S Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_S, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_S; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_S Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_S, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_S,  !- Name
    Set Heating_Energy_Zone_G_S = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_S = Heating_Energy_Zone_G_S + Q_Heating_Abx_G_S,  !- Program Line 2
    Set Heating_Energy_Zone_G_S = Heating_Energy_Zone_G_S + Q_Heating_Hepta_G_S;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_S,  !- Name
    Set Cooling_Energy_Zone_G_S = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_S = Cooling_Energy_Zone_G_S + Q_Cooling_Abx_G_S,  !- Program Line 2
    Set Cooling_Energy_Zone_G_S = Cooling_Energy_Zone_G_S + Q_Cooling_Hepta_G_S;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_S
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_S { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_S,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_S,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_S,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_S,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_S;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_S,  !- Name
    Schedule_Availability_Abx_G_S;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_S,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_S,  !- Name
    Schedule_Availability_Abx_G_S,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_S_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_S,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_S_FanAvail,     !- Name
    Schedule_Availability_Abx_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_S_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_S_Fan,         !- Name
    FanVariableVolume_Abx_G_S,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_S,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_S_Fan = 0, !- Program Line 2
    IF (Is_Abx_G_S_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_S > 0.1),  !- <none>
    Set MFR_Abx_G_S_Fan =    0.104500003 * rho_Abx_G_S_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_S_Fan =    0.071133330 * rho_Abx_G_S_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_S_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_S_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_S_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_S_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_S,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_S_SupplyAir = t_Abx_G_S_WaterSupply - t_Abx_G_S_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_S_SupplyAir = 0.794871807 * TempSP_Abx_G_S_SupplyAir,  !- <none>
    Set TempSP_Abx_G_S_SupplyAir = t_Abx_G_S_OutdoorAir + TempSP_Abx_G_S_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_S_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_S,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_S_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_S,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_S,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_S,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_S,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_S_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_S_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_S,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_S,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_S,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_S_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_S,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_S;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_S,  !- Name
    AirBranch_Abx_G_S;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_S,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_S; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_S, !- Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_S,!- Name
    ControllerList_Abx_G_S_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_S,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_S;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_S,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_S_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_S;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_S,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_S_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_S;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_S,  !- Name
    Schedule_Availability_Abx_G_S,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_S_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_S_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_S,         !- Name
    ControllerList_Abx_G_S_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_S,!- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_S,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_S_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_S_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_S_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_S,       !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_S,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_S_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_S,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_S_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_S,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_S_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_S_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_S,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_S_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_S,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_S_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_S_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_S,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_S_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_S;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_S,!- Name
    AirNode_AirLoopReturnPath_Abx_G_S_Outlet,  !- Outlet Node Name
    AirNode_G_S_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_S,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_S_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_S;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_S,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_S_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_S;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_S,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_S,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_S_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_S,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_S,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_S_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_S,     !- Name
    AirNode_OutdoorAirMixer_Abx_G_S_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_S,    !- Name
    AirNode_WaterCoolingCoil_Abx_G_S_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_S,         !- Name
    AirNode_FanVariableVolume_Abx_G_S_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_S;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_S;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_S;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_S;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_S;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(HWater) {K}, !- Name
    dT_HW_Abx_G_S,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(CWater) {K}, !- Name
    dT_CW_Abx_G_S,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_S,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_S,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_S,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_S_TempDiff,   !- Name
    Set dT_HW_Abx_G_S  = 0,  !- Program Line 1
    Set dT_CW_Abx_G_S = 0,   !- Program Line 2
    Set t_AvgAir_Abx_G_S = 0,!- <none>
    Set dT_HWA_Abx_G_S  = 0, !- <none>
    Set dT_CWA_Abx_G_S = 0,  !- <none>
    IF (MFR_Air_Abx_G_S > 0),!- <none>
    Set t_AvgAir_Abx_G_S = t_AirNodeOut_Abx_G_S + t_AirNodeIn_Abx_G_S,  !- <none>
    Set t_AvgAir_Abx_G_S = t_AvgAir_Abx_G_S / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_S = t_NodeIn_AbxHC_G_S - t_NodeOut_AbxHC_G_S,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_S = t_NodeOut_AbxCC_G_S - t_NodeIn_AbxCC_G_S,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_S <> 0), !- <none>
    IF (dT_HW_Abx_G_S < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_S = t_NodeOut_AbxHC_G_S + t_NodeIn_AbxHC_G_S,  !- <none>
    Set dT_HWA_Abx_G_S = dT_HWA_Abx_G_S / 2,  !- <none>
    Set dT_HWA_Abx_G_S = dT_HWA_Abx_G_S - t_AvgAir_Abx_G_S,  !- <none>
    Set dT_HW_Abx_G_S_Num = dT_HW_Abx_G_S_Num + 1,  !- <none>
    Set dT_HW_Abx_G_S_Sum = dT_HW_Abx_G_S_Sum + dT_HW_Abx_G_S,  !- <none>
    Set dT_HW_Abx_G_S_Avg = dT_HW_Abx_G_S_Sum / dT_HW_Abx_G_S_Num,  !- <none>
    Set dT_HWA_Abx_G_S_Num = dT_HWA_Abx_G_S_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_S_Sum = dT_HWA_Abx_G_S_Sum + dT_HWA_Abx_G_S,  !- <none>
    Set dT_HWA_Abx_G_S_Avg = dT_HWA_Abx_G_S_Sum / dT_HWA_Abx_G_S_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_S <> 0),  !- <none>
    IF (dT_CW_Abx_G_S < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_S = t_NodeIn_AbxCC_G_S + t_NodeOut_AbxCC_G_S,  !- <none>
    Set dT_CWA_Abx_G_S = dT_CWA_Abx_G_S / 2,  !- <none>
    Set dT_CWA_Abx_G_S = dT_CWA_Abx_G_S - t_AvgAir_Abx_G_S,  !- <none>
    Set dT_CW_Abx_G_S_Num = dT_CW_Abx_G_S_Num + 1,  !- <none>
    Set dT_CW_Abx_G_S_Sum = dT_CW_Abx_G_S_Sum + dT_CW_Abx_G_S,  !- <none>
    Set dT_CW_Abx_G_S_Avg = dT_CW_Abx_G_S_Sum / dT_CW_Abx_G_S_Num,  !- <none>
    Set dT_CWA_Abx_G_S_Num = dT_CWA_Abx_G_S_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_S_Sum = dT_CWA_Abx_G_S_Sum + dT_CWA_Abx_G_S,  !- <none>
    Set dT_CWA_Abx_G_S_Avg = dT_CWA_Abx_G_S_Sum / dT_CWA_Abx_G_S_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_S,       !- Name
    WaterHeatingCoil_Abx_G_S,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_S,       !- Name
    WaterCoolingCoil_Abx_G_S,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_S_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_S_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_S_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_S_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_S_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_S_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_S_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_S_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_S_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_S_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_S_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_S_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_S_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_S_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_S_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_S_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_S_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_S_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_S_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_S_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_S_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_S_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_S_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_S_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_S_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_S_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_S_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_S_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_S: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_S_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_S
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_S Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 2076 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 3992 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_S { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_S,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_S,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_S,  !- Name
    Roof G_S Hepta,          !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_S,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_S,                !- Zone Name
    LowTempRadiantSurfaceGroup_G_S,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.23875597E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_S_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_S_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_S,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.12416269E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_S_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_S_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_S,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Name
    0.23875597E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_S,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_S_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_S_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_S,  !- Name
    0.12416269E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_S,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_S_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_S_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_S,      !- Name
    AirNode_ZoneNode_G_S,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_S,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_S,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_S,           !- Name
    LowTempRadiantVarFlow_Hepta_G_S,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_S,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_S = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_S,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_S = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_G_S < t_Sp_Heating_Hepta_G_S + 0.07 ),  !- <none>
    Set MFR_Hepta_G_S =   0.238755986,  !- <none>
    ELSEIF (t_AirNode_Zone_G_S > t_Sp_Cooling_Hepta_G_S - 0.07 ),  !- <none>
    Set MFR_Hepta_G_S =   0.124162681,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_S,      !- Name
    LowTempRadiantVarFlow_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_S,     !- Name
    LowTempRadiantVarFlow_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_S;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_S;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_S;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_S;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_S;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_S;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(Water) {K},!- Name
    dT_W_Hepta_G_S,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_S,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_S,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_S,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_S,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_S,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_S_TempDiff, !- Name
    Set dT_W_Hepta_G_S  = 0, !- Program Line 1
    Set dT_HW_Hepta_G_S = 0, !- Program Line 2
    Set dT_CW_Hepta_G_S = 0, !- <none>
    Set dT_WA_Hepta_G_S  = 0,!- <none>
    Set dT_HWA_Hepta_G_S = 0,!- <none>
    Set dT_CWA_Hepta_G_S = 0,!- <none>
    Set dT_W_Hepta_G_S    = (t_NodeIn_Hepta_G_S - t_NodeOut_Hepta_G_S),  !- <none>
    Set dT_WA_Hepta_G_S = (t_NodeIn_Hepta_G_S + t_NodeOut_Hepta_G_S) / 2,  !- <none>
    Set dT_WA_Hepta_G_S = dT_WA_Hepta_G_S - t_AirNode_Zone_G_S,  !- <none>
    IF (dT_W_Hepta_G_S > 0), !- <none>
    Set dT_HW_Hepta_G_S    = dT_W_Hepta_G_S,  !- <none>
    Set dT_HWA_Hepta_G_S = dT_WA_Hepta_G_S,  !- <none>
    Set dT_HW_Hepta_G_S_Num = dT_HW_Hepta_G_S_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_S_Sum = dT_HW_Hepta_G_S_Sum + dT_HW_Hepta_G_S,  !- <none>
    Set dT_HW_Hepta_G_S_Avg = dT_HW_Hepta_G_S_Sum / dT_HW_Hepta_G_S_Num,  !- <none>
    Set dT_HWA_Hepta_G_S_Num = dT_HWA_Hepta_G_S_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_S_Sum = dT_HWA_Hepta_G_S_Sum + dT_HWA_Hepta_G_S,  !- <none>
    Set dT_HWA_Hepta_G_S_Avg = dT_HWA_Hepta_G_S_Sum / dT_HWA_Hepta_G_S_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_S < 0),  !- <none>
    Set dT_CW_Hepta_G_S    = 0.0 - dT_W_Hepta_G_S,  !- <none>
    Set dT_CWA_Hepta_G_S = 0.0 - dT_WA_Hepta_G_S,  !- <none>
    Set dT_CW_Hepta_G_S_Num = dT_CW_Hepta_G_S_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_S_Sum = dT_CW_Hepta_G_S_Sum + dT_CW_Hepta_G_S,  !- <none>
    Set dT_CW_Hepta_G_S_Avg = dT_CW_Hepta_G_S_Sum / dT_CW_Hepta_G_S_Num,  !- <none>
    Set dT_CWA_Hepta_G_S_Num = dT_CWA_Hepta_G_S_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_S_Sum = dT_CWA_Hepta_G_S_Sum + dT_CWA_Hepta_G_S,  !- <none>
    Set dT_CWA_Hepta_G_S_Avg = dT_CWA_Hepta_G_S_Sum / dT_CWA_Hepta_G_S_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_S;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_S,  !- Name
    Run InitConvCoeff_Sf_Zone_G_S,  !- Program Line 1
    IF (dT_W_Hepta_G_S > 0), !- Program Line 2
    IF (dT_HWA_Hepta_G_S <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_S = (6.12 + (0.18 * (dT_HWA_Hepta_G_S^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_S,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_S < 0),  !- <none>
    IF (dT_CWA_Hepta_G_S <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_S = 6.12 + (2.76 * (dT_CWA_Hepta_G_S^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_S,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_S,  !- Name
    Set ConvCoeff_Hepta_Roof_G_S  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_S,!- Name
    Set ConvCoeff_Hepta_Roof_G_S  = ConvCoeffToSet_Hepta_G_S;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_S,     !- Name
    LowTempRadiantVarFlow_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_S,     !- Name
    LowTempRadiantVarFlow_Hepta_G_S,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_S_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_S_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_S_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_S_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_S_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_S_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_S_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_S_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_S_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_S_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_S_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_S_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_S_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_S_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_S_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_S_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_S_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_S_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_S_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_S_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_S_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_S_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_S_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_S_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_S_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_S_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_S_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_S_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_S: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_S_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     GENERAL Zone_G_SE
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_SE { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_SE,  !- Name
    Zone_G_SE,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_SE,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_SE;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_SE,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_SE,  !- Name
    Schedule_TemperatureMinimum_Zone_G_SE,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_SE;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_SE,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_SE,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_SE,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_SE,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_G_SE,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_G_SE, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SE_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_SE,               !- Zone Name
    ZoneHvacEquipmentList_G_SE,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_SE,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_SE,   !- Zone Air Node Name
    AirNode_G_SE_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_SE =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_SE Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_SE;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_SE Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_SE,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_SE,  !- Name
    Set Heating_Energy_Zone_G_SE = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_SE = Heating_Energy_Zone_G_SE + Q_Heating_Abx_G_SE,  !- Program Line 2
    Set Heating_Energy_Zone_G_SE = Heating_Energy_Zone_G_SE + Q_Heating_Hepta_G_SE,  !- <none>
    Set Heating_Energy_Zone_G_SE = Heating_Energy_Zone_G_SE + Q_Heating_WaterConvective_G_SE,  !- <none>
    Set Heating_Energy_Zone_G_SE = Heating_Energy_Zone_G_SE + Q_Heating_RecircAbx_G_SE;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_SE,  !- Name
    Set Cooling_Energy_Zone_G_SE = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_SE = Cooling_Energy_Zone_G_SE + Q_Cooling_Abx_G_SE,  !- Program Line 2
    Set Cooling_Energy_Zone_G_SE = Cooling_Energy_Zone_G_SE + Q_Cooling_Hepta_G_SE;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_SE
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 2 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_SE { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_SE,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_SE,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_SE,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_SE;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_SE,  !- Name
    Schedule_Availability_Abx_G_SE;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_SE,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_SE,  !- Name
    Schedule_Availability_Abx_G_SE,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.052250002,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.035566665,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_SE,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_SE_FanAvail,    !- Name
    Schedule_Availability_Abx_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_SE_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_SE_Fan,        !- Name
    FanVariableVolume_Abx_G_SE,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_SE,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_SE_Fan = 0,!- Program Line 2
    IF (Is_Abx_G_SE_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_SE > 0.1),  !- <none>
    Set MFR_Abx_G_SE_Fan =    0.052250002 * rho_Abx_G_SE_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_SE_Fan =    0.035566665 * rho_Abx_G_SE_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_SE_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_SE_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_SE_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_SE_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_SE,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_SE_SupplyAir = t_Abx_G_SE_WaterSupply - t_Abx_G_SE_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_SE_SupplyAir = 0.794871807 * TempSP_Abx_G_SE_SupplyAir,  !- <none>
    Set TempSP_Abx_G_SE_SupplyAir = t_Abx_G_SE_OutdoorAir + TempSP_Abx_G_SE_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_SE_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_SE,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    82.720001221,            !- U-Factor Times Area Value {W/K}
    0.74960124E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    1880,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SE,  !- Name
    0.74960124E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_SE,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_SE,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.74960124E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_SE,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.53827753E-04,          !- Design Water Flow Rate {m3/s}
    0.055555556,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SE,  !- Name
    0.80741615E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_SE,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_SE,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.80741615E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_SE_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_SE,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_SE;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_SE, !- Name
    AirBranch_Abx_G_SE;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_SE,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_SE;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_SE,!- Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_SE,  !- Name
    ControllerList_Abx_G_SE_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_SE,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_SE;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_OutdoorInlet,  !- Actuator Node Name
    0.035566665,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.052250002,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_SE_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_SE;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_SE,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SE_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_SE;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_SE,  !- Name
    Schedule_Availability_Abx_G_SE,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SE_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SE_Inlet,  !- Air Inlet Node Name
    0.052250002,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.035566665;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_SE,        !- Name
    ControllerList_Abx_G_SE_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_SE,  !- Availability Manager List Name
    0.052250002,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_SE, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_SE_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_SE_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_SE_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_SE,      !- Name
    0.052250002,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_SE,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_SE_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_SE,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_SE,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_SE,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_SE_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SE_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_SE,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_SE_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_SE;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_SE_Outlet,  !- Outlet Node Name
    AirNode_G_SE_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_SE,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_SE_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_SE;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_SE,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_SE_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_SE;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_SE,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_SE,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_SE,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_SE,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_SE,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_SE_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_SE,   !- Name
    AirNode_WaterCoolingCoil_Abx_G_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_SE,        !- Name
    AirNode_FanVariableVolume_Abx_G_SE_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SE;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(HWater) {K},!- Name
    dT_HW_Abx_G_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(CWater) {K},!- Name
    dT_CW_Abx_G_SE,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_SE_TempDiff,  !- Name
    Set dT_HW_Abx_G_SE  = 0, !- Program Line 1
    Set dT_CW_Abx_G_SE = 0,  !- Program Line 2
    Set t_AvgAir_Abx_G_SE = 0,  !- <none>
    Set dT_HWA_Abx_G_SE  = 0,!- <none>
    Set dT_CWA_Abx_G_SE = 0, !- <none>
    IF (MFR_Air_Abx_G_SE > 0),  !- <none>
    Set t_AvgAir_Abx_G_SE = t_AirNodeOut_Abx_G_SE + t_AirNodeIn_Abx_G_SE,  !- <none>
    Set t_AvgAir_Abx_G_SE = t_AvgAir_Abx_G_SE / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_SE = t_NodeIn_AbxHC_G_SE - t_NodeOut_AbxHC_G_SE,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_SE = t_NodeOut_AbxCC_G_SE - t_NodeIn_AbxCC_G_SE,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_SE <> 0),!- <none>
    IF (dT_HW_Abx_G_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_SE = t_NodeOut_AbxHC_G_SE + t_NodeIn_AbxHC_G_SE,  !- <none>
    Set dT_HWA_Abx_G_SE = dT_HWA_Abx_G_SE / 2,  !- <none>
    Set dT_HWA_Abx_G_SE = dT_HWA_Abx_G_SE - t_AvgAir_Abx_G_SE,  !- <none>
    Set dT_HW_Abx_G_SE_Num = dT_HW_Abx_G_SE_Num + 1,  !- <none>
    Set dT_HW_Abx_G_SE_Sum = dT_HW_Abx_G_SE_Sum + dT_HW_Abx_G_SE,  !- <none>
    Set dT_HW_Abx_G_SE_Avg = dT_HW_Abx_G_SE_Sum / dT_HW_Abx_G_SE_Num,  !- <none>
    Set dT_HWA_Abx_G_SE_Num = dT_HWA_Abx_G_SE_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_SE_Sum = dT_HWA_Abx_G_SE_Sum + dT_HWA_Abx_G_SE,  !- <none>
    Set dT_HWA_Abx_G_SE_Avg = dT_HWA_Abx_G_SE_Sum / dT_HWA_Abx_G_SE_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_SE <> 0),  !- <none>
    IF (dT_CW_Abx_G_SE < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_SE = t_NodeIn_AbxCC_G_SE + t_NodeOut_AbxCC_G_SE,  !- <none>
    Set dT_CWA_Abx_G_SE = dT_CWA_Abx_G_SE / 2,  !- <none>
    Set dT_CWA_Abx_G_SE = dT_CWA_Abx_G_SE - t_AvgAir_Abx_G_SE,  !- <none>
    Set dT_CW_Abx_G_SE_Num = dT_CW_Abx_G_SE_Num + 1,  !- <none>
    Set dT_CW_Abx_G_SE_Sum = dT_CW_Abx_G_SE_Sum + dT_CW_Abx_G_SE,  !- <none>
    Set dT_CW_Abx_G_SE_Avg = dT_CW_Abx_G_SE_Sum / dT_CW_Abx_G_SE_Num,  !- <none>
    Set dT_CWA_Abx_G_SE_Num = dT_CWA_Abx_G_SE_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_SE_Sum = dT_CWA_Abx_G_SE_Sum + dT_CWA_Abx_G_SE,  !- <none>
    Set dT_CWA_Abx_G_SE_Avg = dT_CWA_Abx_G_SE_Sum / dT_CWA_Abx_G_SE_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_SE,      !- Name
    WaterHeatingCoil_Abx_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_SE,      !- Name
    WaterCoolingCoil_Abx_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_SE_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_SE_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_SE_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_SE_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_SE_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_SE_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_SE_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_SE_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SE_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SE_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SE_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_SE_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_SE
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_SE Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1038 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1996 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_SE { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_SE,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_SE,  !- Name
    Roof G_SE Hepta,         !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_SE,               !- Zone Name
    LowTempRadiantSurfaceGroup_G_SE,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11937799E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_SE,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.62081344E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_SE,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Name
    0.11937799E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE,  !- Name
    0.62081344E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_SE,     !- Name
    AirNode_ZoneNode_G_SE,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_SE, !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_SE, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_SE,          !- Name
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_SE,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_SE = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_SE,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_SE = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_G_SE < t_Sp_Heating_Hepta_G_SE + 0.07 ),  !- <none>
    Set MFR_Hepta_G_SE =   0.119377993,  !- <none>
    ELSEIF (t_AirNode_Zone_G_SE > t_Sp_Cooling_Hepta_G_SE - 0.07 ),  !- <none>
    Set MFR_Hepta_G_SE =   0.062081341,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_SE,     !- Name
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SE;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(Water) {K},  !- Name
    dT_W_Hepta_G_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_SE,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_SE_TempDiff,!- Name
    Set dT_W_Hepta_G_SE  = 0,!- Program Line 1
    Set dT_HW_Hepta_G_SE = 0,!- Program Line 2
    Set dT_CW_Hepta_G_SE = 0,!- <none>
    Set dT_WA_Hepta_G_SE  = 0,  !- <none>
    Set dT_HWA_Hepta_G_SE = 0,  !- <none>
    Set dT_CWA_Hepta_G_SE = 0,  !- <none>
    Set dT_W_Hepta_G_SE    = (t_NodeIn_Hepta_G_SE - t_NodeOut_Hepta_G_SE),  !- <none>
    Set dT_WA_Hepta_G_SE = (t_NodeIn_Hepta_G_SE + t_NodeOut_Hepta_G_SE) / 2,  !- <none>
    Set dT_WA_Hepta_G_SE = dT_WA_Hepta_G_SE - t_AirNode_Zone_G_SE,  !- <none>
    IF (dT_W_Hepta_G_SE > 0),!- <none>
    Set dT_HW_Hepta_G_SE    = dT_W_Hepta_G_SE,  !- <none>
    Set dT_HWA_Hepta_G_SE = dT_WA_Hepta_G_SE,  !- <none>
    Set dT_HW_Hepta_G_SE_Num = dT_HW_Hepta_G_SE_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_SE_Sum = dT_HW_Hepta_G_SE_Sum + dT_HW_Hepta_G_SE,  !- <none>
    Set dT_HW_Hepta_G_SE_Avg = dT_HW_Hepta_G_SE_Sum / dT_HW_Hepta_G_SE_Num,  !- <none>
    Set dT_HWA_Hepta_G_SE_Num = dT_HWA_Hepta_G_SE_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_SE_Sum = dT_HWA_Hepta_G_SE_Sum + dT_HWA_Hepta_G_SE,  !- <none>
    Set dT_HWA_Hepta_G_SE_Avg = dT_HWA_Hepta_G_SE_Sum / dT_HWA_Hepta_G_SE_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_SE < 0),  !- <none>
    Set dT_CW_Hepta_G_SE    = 0.0 - dT_W_Hepta_G_SE,  !- <none>
    Set dT_CWA_Hepta_G_SE = 0.0 - dT_WA_Hepta_G_SE,  !- <none>
    Set dT_CW_Hepta_G_SE_Num = dT_CW_Hepta_G_SE_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_SE_Sum = dT_CW_Hepta_G_SE_Sum + dT_CW_Hepta_G_SE,  !- <none>
    Set dT_CW_Hepta_G_SE_Avg = dT_CW_Hepta_G_SE_Sum / dT_CW_Hepta_G_SE_Num,  !- <none>
    Set dT_CWA_Hepta_G_SE_Num = dT_CWA_Hepta_G_SE_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_SE_Sum = dT_CWA_Hepta_G_SE_Sum + dT_CWA_Hepta_G_SE,  !- <none>
    Set dT_CWA_Hepta_G_SE_Avg = dT_CWA_Hepta_G_SE_Sum / dT_CWA_Hepta_G_SE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_SE;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_SE, !- Name
    Run InitConvCoeff_Sf_Zone_G_SE,  !- Program Line 1
    IF (dT_W_Hepta_G_SE > 0),!- Program Line 2
    IF (dT_HWA_Hepta_G_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_SE = (6.12 + (0.18 * (dT_HWA_Hepta_G_SE^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_SE,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_SE < 0),  !- <none>
    IF (dT_CWA_Hepta_G_SE <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_SE = 6.12 + (2.76 * (dT_CWA_Hepta_G_SE^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_SE,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_SE,  !- Name
    Set ConvCoeff_Hepta_Roof_G_SE  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_SE,  !- Name
    Set ConvCoeff_Hepta_Roof_G_SE  = ConvCoeffToSet_Hepta_G_SE;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_SE,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SE,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_SE_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_SE_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_SE_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_SE_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_SE_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_SE_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_SE_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_SE_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SE_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SE_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SE_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SE: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_SE_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR G_SE
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 300 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_SE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_G_SE,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_G_SE_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_G_SE_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    24,                      !- U-Factor Times Area Value {W/K}
    0.23923447E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_G_SE,  !- Name
    0.23923447E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_G_SE,    !- Component 1 Name
    Node_HwDemand_WaterConvective_G_SE_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_G_SE_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_G_SE,  !- Name
    WaterConvective_G_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_G_SE,      !- Name
    WaterConvective_G_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_G_SE,     !- Name
    WaterConvective_G_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_G_SE,   !- Name
    WaterConvective_G_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_G_SE,  !- Name
    WaterConvective_G_SE,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SE;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SE;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_G_SE;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SE: dT(HWater) {K},  !- Name
    dT_HW_Conv_G_SE,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_SE: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_G_SE,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_SE: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_G_SE,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_G_SE_TempDiff, !- Name
    Set dT_HW_Conv_G_SE    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_G_SE = 0,  !- Program Line 2
    Set dT_HWA_Conv_G_SE   = 0,  !- <none>
    Set dT_HW_Conv_G_SE    = t_NodeIn_Conv_G_SE - t_NodeOut_Conv_G_SE,  !- <none>
    IF (dT_HW_Conv_G_SE > 0),!- <none>
    Set t_AvgAir_Conv_G_SE = t_AirNodeOut_Conv_G_SE + t_AirNodeIn_Conv_G_SE,  !- <none>
    Set t_AvgAir_Conv_G_SE = t_AvgAir_Conv_G_SE / 2,  !- <none>
    Set dT_HWA_Conv_G_SE = t_NodeOut_Conv_G_SE + t_NodeIn_Conv_G_SE,  !- <none>
    Set dT_HWA_Conv_G_SE = dT_HWA_Conv_G_SE / 2,  !- <none>
    Set dT_HWA_Conv_G_SE = dT_HWA_Conv_G_SE - t_AvgAir_Conv_G_SE,  !- <none>
    Set dT_HW_Conv_G_SE_Num = dT_HW_Conv_G_SE_Num + 1,  !- <none>
    Set dT_HW_Conv_G_SE_Sum = dT_HW_Conv_G_SE_Sum + dT_HW_Conv_G_SE,  !- <none>
    Set dT_HW_Conv_G_SE_Avg = dT_HW_Conv_G_SE_Sum / dT_HW_Conv_G_SE_Num,  !- <none>
    Set dT_HWA_Conv_G_SE_Num = dT_HWA_Conv_G_SE_Num + 1,  !- <none>
    Set dT_HWA_Conv_G_SE_Sum = dT_HWA_Conv_G_SE_Sum + dT_HWA_Conv_G_SE,  !- <none>
    Set dT_HWA_Conv_G_SE_Avg = dT_HWA_Conv_G_SE_Sum / dT_HWA_Conv_G_SE_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_G_SE_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_G_SE_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_G_SE_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_G_SE_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_G_SE_Sum = 0,  !- <none>
    Set dT_HWA_Conv_G_SE_Num = 0,  !- <none>
    Set dT_HWA_Conv_G_SE_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SE_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SE_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SE_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SE: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_G_SE_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SE_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SE_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SE_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SE: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_G_SE_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX G_SE
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = G_SE { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_G_SE, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_G_SE,!- Name
    ElectricConvective_G_SE, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_G_SW
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_SW { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_SW,  !- Name
    Zone_G_SW,               !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_SW,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_SW;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_SW,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_SW,  !- Name
    Schedule_TemperatureMinimum_Zone_G_SW,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_SW;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_SW,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_SW,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_SW,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_SW,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2,                       !- Zone Equipment 2 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Water,  !- Zone Equipment 3 Object Type
    WaterConvective_G_SW,    !- Zone Equipment 3 Name
    3,                       !- Zone Equipment 3 Cooling Sequence
    3,                       !- Zone Equipment 3 Heating or No-Load Sequence
    ZoneHVAC:Baseboard:Convective:Electric,  !- Zone Equipment 4 Object Type
    ElectricConvective_G_SW, !- Zone Equipment 4 Name
    4,                       !- Zone Equipment 4 Cooling Sequence
    4;                       !- Zone Equipment 4 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_SW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SW_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_SW,               !- Zone Name
    ZoneHvacEquipmentList_G_SW,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_SW,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_SW,   !- Zone Air Node Name
    AirNode_G_SW_Outlet;     !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_SW =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_SW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_SW Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_SW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_SW;!- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_SW Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_SW,!- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_SW,  !- Name
    Set Heating_Energy_Zone_G_SW = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_SW = Heating_Energy_Zone_G_SW + Q_Heating_Abx_G_SW,  !- Program Line 2
    Set Heating_Energy_Zone_G_SW = Heating_Energy_Zone_G_SW + Q_Heating_Hepta_G_SW,  !- <none>
    Set Heating_Energy_Zone_G_SW = Heating_Energy_Zone_G_SW + Q_Heating_WaterConvective_G_SW,  !- <none>
    Set Heating_Energy_Zone_G_SW = Heating_Energy_Zone_G_SW + Q_Heating_RecircAbx_G_SW;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_SW,  !- Name
    Set Cooling_Energy_Zone_G_SW = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_SW = Cooling_Energy_Zone_G_SW + Q_Cooling_Abx_G_SW,  !- Program Line 2
    Set Cooling_Energy_Zone_G_SW = Cooling_Energy_Zone_G_SW + Q_Cooling_Hepta_G_SW;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_SW
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 2 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_SW { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_SW,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_SW,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_SW,  !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_SW;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_SW,  !- Name
    Schedule_Availability_Abx_G_SW;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_SW,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_SW,  !- Name
    Schedule_Availability_Abx_G_SW,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.052250002,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.035566665,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_SW,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_SW_FanAvail,    !- Name
    Schedule_Availability_Abx_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_SW_Fan,        !- Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_SW_Fan,        !- Name
    FanVariableVolume_Abx_G_SW,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_SW,  !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_SW_Fan = 0,!- Program Line 2
    IF (Is_Abx_G_SW_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_SW > 0.1),  !- <none>
    Set MFR_Abx_G_SW_Fan =    0.052250002 * rho_Abx_G_SW_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_SW_Fan =    0.035566665 * rho_Abx_G_SW_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_SW_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_SW_OutdoorAir,   !- Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_SW_WaterSupply,  !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_SW_SupplyAir,  !- Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_SW,     !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_SW_SupplyAir = t_Abx_G_SW_WaterSupply - t_Abx_G_SW_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_SW_SupplyAir = 0.794871807 * TempSP_Abx_G_SW_SupplyAir,  !- <none>
    Set TempSP_Abx_G_SW_SupplyAir = t_Abx_G_SW_OutdoorAir + TempSP_Abx_G_SW_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_SW_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_SW,  !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    82.720001221,            !- U-Factor Times Area Value {W/K}
    0.74960124E-04,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    1880,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_SW,  !- Name
    0.74960124E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_SW,  !- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_SW,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.74960124E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_SW,  !- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.53827753E-04,          !- Design Water Flow Rate {m3/s}
    0.055555556,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_SW,  !- Name
    0.80741615E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_SW,  !- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_SW,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.80741615E-04,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_SW_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_SW,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_SW;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_SW, !- Name
    AirBranch_Abx_G_SW;      !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_SW,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_SW;!- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_SW,!- Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_SW,  !- Name
    ControllerList_Abx_G_SW_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_SW,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_SW;  !- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_SW,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_OutdoorInlet,  !- Actuator Node Name
    0.035566665,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.052250002,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_SW_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_SW;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_SW,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SW_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_SW;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_SW,  !- Name
    Schedule_Availability_Abx_G_SW,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SW_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SW_Inlet,  !- Air Inlet Node Name
    0.052250002,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.035566665;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_SW,        !- Name
    ControllerList_Abx_G_SW_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_SW,  !- Availability Manager List Name
    0.052250002,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_SW, !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_SW_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_SW_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_SW_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_SW,      !- Name
    0.052250002,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_SW,  !- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_SW_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_SW,  !- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_SW,  !- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_SW,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_SW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_SW_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_SW_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_SW,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_SW_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_SW;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_SW,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_SW_Outlet,  !- Outlet Node Name
    AirNode_G_SW_Outlet;     !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_SW,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_SW_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_SW;  !- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_SW,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_SW_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_SW;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_SW,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_SW,    !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_SW,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_SW,    !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_SW,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_SW_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_SW,   !- Name
    AirNode_WaterCoolingCoil_Abx_G_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_SW,        !- Name
    AirNode_FanVariableVolume_Abx_G_SW_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SW;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(HWater) {K},!- Name
    dT_HW_Abx_G_SW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(CWater) {K},!- Name
    dT_CW_Abx_G_SW,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_SW_TempDiff,  !- Name
    Set dT_HW_Abx_G_SW  = 0, !- Program Line 1
    Set dT_CW_Abx_G_SW = 0,  !- Program Line 2
    Set t_AvgAir_Abx_G_SW = 0,  !- <none>
    Set dT_HWA_Abx_G_SW  = 0,!- <none>
    Set dT_CWA_Abx_G_SW = 0, !- <none>
    IF (MFR_Air_Abx_G_SW > 0),  !- <none>
    Set t_AvgAir_Abx_G_SW = t_AirNodeOut_Abx_G_SW + t_AirNodeIn_Abx_G_SW,  !- <none>
    Set t_AvgAir_Abx_G_SW = t_AvgAir_Abx_G_SW / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_SW = t_NodeIn_AbxHC_G_SW - t_NodeOut_AbxHC_G_SW,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_SW = t_NodeOut_AbxCC_G_SW - t_NodeIn_AbxCC_G_SW,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_SW <> 0),!- <none>
    IF (dT_HW_Abx_G_SW < 0), !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_SW = t_NodeOut_AbxHC_G_SW + t_NodeIn_AbxHC_G_SW,  !- <none>
    Set dT_HWA_Abx_G_SW = dT_HWA_Abx_G_SW / 2,  !- <none>
    Set dT_HWA_Abx_G_SW = dT_HWA_Abx_G_SW - t_AvgAir_Abx_G_SW,  !- <none>
    Set dT_HW_Abx_G_SW_Num = dT_HW_Abx_G_SW_Num + 1,  !- <none>
    Set dT_HW_Abx_G_SW_Sum = dT_HW_Abx_G_SW_Sum + dT_HW_Abx_G_SW,  !- <none>
    Set dT_HW_Abx_G_SW_Avg = dT_HW_Abx_G_SW_Sum / dT_HW_Abx_G_SW_Num,  !- <none>
    Set dT_HWA_Abx_G_SW_Num = dT_HWA_Abx_G_SW_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_SW_Sum = dT_HWA_Abx_G_SW_Sum + dT_HWA_Abx_G_SW,  !- <none>
    Set dT_HWA_Abx_G_SW_Avg = dT_HWA_Abx_G_SW_Sum / dT_HWA_Abx_G_SW_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_SW <> 0),  !- <none>
    IF (dT_CW_Abx_G_SW < 0), !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_SW = t_NodeIn_AbxCC_G_SW + t_NodeOut_AbxCC_G_SW,  !- <none>
    Set dT_CWA_Abx_G_SW = dT_CWA_Abx_G_SW / 2,  !- <none>
    Set dT_CWA_Abx_G_SW = dT_CWA_Abx_G_SW - t_AvgAir_Abx_G_SW,  !- <none>
    Set dT_CW_Abx_G_SW_Num = dT_CW_Abx_G_SW_Num + 1,  !- <none>
    Set dT_CW_Abx_G_SW_Sum = dT_CW_Abx_G_SW_Sum + dT_CW_Abx_G_SW,  !- <none>
    Set dT_CW_Abx_G_SW_Avg = dT_CW_Abx_G_SW_Sum / dT_CW_Abx_G_SW_Num,  !- <none>
    Set dT_CWA_Abx_G_SW_Num = dT_CWA_Abx_G_SW_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_SW_Sum = dT_CWA_Abx_G_SW_Sum + dT_CWA_Abx_G_SW,  !- <none>
    Set dT_CWA_Abx_G_SW_Avg = dT_CWA_Abx_G_SW_Sum / dT_CWA_Abx_G_SW_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_SW,      !- Name
    WaterHeatingCoil_Abx_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_SW,      !- Name
    WaterCoolingCoil_Abx_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_SW_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_SW_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_SW_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_SW_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_SW_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_SW_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_SW_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_SW_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_SW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_SW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SW_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SW_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_SW_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_SW_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_SW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_SW
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_SW Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1038 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 1996 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_SW { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_SW,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_SW,  !- Name
    Roof G_SW Hepta,         !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_SW,               !- Zone Name
    LowTempRadiantSurfaceGroup_G_SW,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.11937799E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_SW,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.62081344E-04,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_SW,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Name
    0.11937799E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW,  !- Name
    0.62081344E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_SW,     !- Name
    AirNode_ZoneNode_G_SW,   !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_SW, !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_SW, !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_SW,          !- Name
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_SW,     !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_SW = 0,  !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_SW,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_SW = 0,  !- Program Line 2
    IF     (t_AirNode_Zone_G_SW < t_Sp_Heating_Hepta_G_SW + 0.07 ),  !- <none>
    Set MFR_Hepta_G_SW =   0.119377993,  !- <none>
    ELSEIF (t_AirNode_Zone_G_SW > t_Sp_Cooling_Hepta_G_SW - 0.07 ),  !- <none>
    Set MFR_Hepta_G_SW =   0.062081341,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_SW,     !- Name
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SW;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(Water) {K},  !- Name
    dT_W_Hepta_G_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_SW,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_SW_TempDiff,!- Name
    Set dT_W_Hepta_G_SW  = 0,!- Program Line 1
    Set dT_HW_Hepta_G_SW = 0,!- Program Line 2
    Set dT_CW_Hepta_G_SW = 0,!- <none>
    Set dT_WA_Hepta_G_SW  = 0,  !- <none>
    Set dT_HWA_Hepta_G_SW = 0,  !- <none>
    Set dT_CWA_Hepta_G_SW = 0,  !- <none>
    Set dT_W_Hepta_G_SW    = (t_NodeIn_Hepta_G_SW - t_NodeOut_Hepta_G_SW),  !- <none>
    Set dT_WA_Hepta_G_SW = (t_NodeIn_Hepta_G_SW + t_NodeOut_Hepta_G_SW) / 2,  !- <none>
    Set dT_WA_Hepta_G_SW = dT_WA_Hepta_G_SW - t_AirNode_Zone_G_SW,  !- <none>
    IF (dT_W_Hepta_G_SW > 0),!- <none>
    Set dT_HW_Hepta_G_SW    = dT_W_Hepta_G_SW,  !- <none>
    Set dT_HWA_Hepta_G_SW = dT_WA_Hepta_G_SW,  !- <none>
    Set dT_HW_Hepta_G_SW_Num = dT_HW_Hepta_G_SW_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_SW_Sum = dT_HW_Hepta_G_SW_Sum + dT_HW_Hepta_G_SW,  !- <none>
    Set dT_HW_Hepta_G_SW_Avg = dT_HW_Hepta_G_SW_Sum / dT_HW_Hepta_G_SW_Num,  !- <none>
    Set dT_HWA_Hepta_G_SW_Num = dT_HWA_Hepta_G_SW_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_SW_Sum = dT_HWA_Hepta_G_SW_Sum + dT_HWA_Hepta_G_SW,  !- <none>
    Set dT_HWA_Hepta_G_SW_Avg = dT_HWA_Hepta_G_SW_Sum / dT_HWA_Hepta_G_SW_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_SW < 0),  !- <none>
    Set dT_CW_Hepta_G_SW    = 0.0 - dT_W_Hepta_G_SW,  !- <none>
    Set dT_CWA_Hepta_G_SW = 0.0 - dT_WA_Hepta_G_SW,  !- <none>
    Set dT_CW_Hepta_G_SW_Num = dT_CW_Hepta_G_SW_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_SW_Sum = dT_CW_Hepta_G_SW_Sum + dT_CW_Hepta_G_SW,  !- <none>
    Set dT_CW_Hepta_G_SW_Avg = dT_CW_Hepta_G_SW_Sum / dT_CW_Hepta_G_SW_Num,  !- <none>
    Set dT_CWA_Hepta_G_SW_Num = dT_CWA_Hepta_G_SW_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_SW_Sum = dT_CWA_Hepta_G_SW_Sum + dT_CWA_Hepta_G_SW,  !- <none>
    Set dT_CWA_Hepta_G_SW_Avg = dT_CWA_Hepta_G_SW_Sum / dT_CWA_Hepta_G_SW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_SW;  !- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_SW, !- Name
    Run InitConvCoeff_Sf_Zone_G_SW,  !- Program Line 1
    IF (dT_W_Hepta_G_SW > 0),!- Program Line 2
    IF (dT_HWA_Hepta_G_SW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_SW = (6.12 + (0.18 * (dT_HWA_Hepta_G_SW^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_SW,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_SW < 0),  !- <none>
    IF (dT_CWA_Hepta_G_SW <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_SW = 6.12 + (2.76 * (dT_CWA_Hepta_G_SW^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_SW,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_SW,  !- Name
    Set ConvCoeff_Hepta_Roof_G_SW  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_SW,  !- Name
    Set ConvCoeff_Hepta_Roof_G_SW  = ConvCoeffToSet_Hepta_G_SW;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_SW,    !- Name
    LowTempRadiantVarFlow_Hepta_G_SW,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_SW_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_SW_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_SW_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_SW_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_SW_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_SW_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_SW_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_SW_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_SW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_SW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SW_Sum;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SW_Num;   !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_SW_Avg;   !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_SW: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_SW_Avg,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     CONVECTOR G_SW
! ===
! ===     USED PARAMETER VALUES: CONVECTORTOTALHEATINGPOWER = 300 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_SW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Water,
    WaterConvective_G_SW,    !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    Node_HwDemand_WaterConvective_G_SW_Inlet,  !- Inlet Node Name
    Node_HwDemand_WaterConvective_G_SW_Outlet,  !- Outlet Node Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    24,                      !- U-Factor Times Area Value {W/K}
    0.23923447E-04,          !- Maximum Water Flow Rate {m3/s}
    0.01;                    !- Convergence Tolerance

  Branch,
    Branch_HwDemand_WaterConvective_G_SW,  !- Name
    0.23923447E-04,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:Baseboard:Convective:Water,  !- Component 1 Object Type
    WaterConvective_G_SW,    !- Component 1 Name
    Node_HwDemand_WaterConvective_G_SW_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterConvective_G_SW_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_WaterConvective_G_SW,  !- Name
    WaterConvective_G_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Conv_G_SW,      !- Name
    WaterConvective_G_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Conv_G_SW,     !- Name
    WaterConvective_G_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Water Outlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Conv_G_SW,   !- Name
    WaterConvective_G_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Conv_G_SW,  !- Name
    WaterConvective_G_SW,    !- Output:Variable or Output:Meter Index Key Name
    Baseboard Air Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SW;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SW;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Conv_G_SW;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SW: dT(HWater) {K},  !- Name
    dT_HW_Conv_G_SW,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_SW: dT(HWater_Air) {K},  !- Name
    dT_HWA_Conv_G_SW,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Conv_G_SW: Average Air Temperature {K},  !- Name
    t_AvgAir_Conv_G_SW,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water)
! AVERAGE AIR TEMPERATURE
! CALCULATE dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Conv_G_SW_TempDiff, !- Name
    Set dT_HW_Conv_G_SW    = 0,  !- Program Line 1
    Set t_AvgAir_Conv_G_SW = 0,  !- Program Line 2
    Set dT_HWA_Conv_G_SW   = 0,  !- <none>
    Set dT_HW_Conv_G_SW    = t_NodeIn_Conv_G_SW - t_NodeOut_Conv_G_SW,  !- <none>
    IF (dT_HW_Conv_G_SW > 0),!- <none>
    Set t_AvgAir_Conv_G_SW = t_AirNodeOut_Conv_G_SW + t_AirNodeIn_Conv_G_SW,  !- <none>
    Set t_AvgAir_Conv_G_SW = t_AvgAir_Conv_G_SW / 2,  !- <none>
    Set dT_HWA_Conv_G_SW = t_NodeOut_Conv_G_SW + t_NodeIn_Conv_G_SW,  !- <none>
    Set dT_HWA_Conv_G_SW = dT_HWA_Conv_G_SW / 2,  !- <none>
    Set dT_HWA_Conv_G_SW = dT_HWA_Conv_G_SW - t_AvgAir_Conv_G_SW,  !- <none>
    Set dT_HW_Conv_G_SW_Num = dT_HW_Conv_G_SW_Num + 1,  !- <none>
    Set dT_HW_Conv_G_SW_Sum = dT_HW_Conv_G_SW_Sum + dT_HW_Conv_G_SW,  !- <none>
    Set dT_HW_Conv_G_SW_Avg = dT_HW_Conv_G_SW_Sum / dT_HW_Conv_G_SW_Num,  !- <none>
    Set dT_HWA_Conv_G_SW_Num = dT_HWA_Conv_G_SW_Num + 1,  !- <none>
    Set dT_HWA_Conv_G_SW_Sum = dT_HWA_Conv_G_SW_Sum + dT_HWA_Conv_G_SW,  !- <none>
    Set dT_HWA_Conv_G_SW_Avg = dT_HWA_Conv_G_SW_Sum / dT_HWA_Conv_G_SW_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Conv_G_SW_RunPeriodAvg,  !- Name
    Set dT_HW_Conv_G_SW_Sum  = 0,  !- Program Line 1
    Set dT_HW_Conv_G_SW_Num  = 0,  !- Program Line 2
    Set dT_HW_Conv_G_SW_Avg  = 0,  !- <none>
    Set dT_HWA_Conv_G_SW_Sum = 0,  !- <none>
    Set dT_HWA_Conv_G_SW_Num = 0,  !- <none>
    Set dT_HWA_Conv_G_SW_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SW_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SW_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Conv_G_SW_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SW: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Conv_G_SW_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SW_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SW_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Conv_G_SW_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Conv_G_SW: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Conv_G_SW_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     RECIRCULATION AIRBOX G_SW
! ===
! ===     USED PARAMETER VALUES: RECIRCABXNUMBEROFUNITS = 2 {-}, ZONENAME = G_SW { },
! ====================================================================================================

  ZoneHVAC:Baseboard:Convective:Electric,
    ElectricConvective_G_SW, !- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    930,                     !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    1.0;                     !- Efficiency

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_RecircAbx_G_SW,!- Name
    ElectricConvective_G_SW, !- Output:Variable or Output:Meter Index Key Name
    Baseboard Total Heating Energy;  !- Output:Variable or Output:Meter Name

! ====================================================================================================
! ===     GENERAL Zone_G_W
! ===
! ===     USED PARAMETER VALUES: ZONEAIRTEMPERATURETHERMOSTATMAXIMUM = 26 {C}, ZONEAIRTEMPERATURETHERMOSTATMINIMUM = 20 {C}, ZONECONDITIONED = 1 {-}, ZONENAME = G_W { },
! ====================================================================================================
! ========= THERMOSTATS =========

  ZoneControl:Thermostat,
    ZoneControlThermostat_G_W,  !- Name
    Zone_G_W,                !- Zone or ZoneList Name
    Schedule_AnyNumber_ZoneControlType_G_W,  !- Control Type Schedule Name
    ThermostatSetpoint:DualSetpoint,  !- Control 1 Object Type
    ThermostatDualSetpoint_G_W;  !- Control 1 Name

  Schedule:Constant,Schedule_AnyNumber_ZoneControlType_G_W,AnyNumber,4;

  ThermostatSetpoint:DualSetpoint,
    ThermostatDualSetpoint_G_W,  !- Name
    Schedule_TemperatureMinimum_Zone_G_W,  !- Heating Setpoint Temperature Schedule Name
    Schedule_TemperatureMaximum_Zone_G_W;  !- Cooling Setpoint Temperature Schedule Name

  Schedule:Constant,Schedule_TemperatureMinimum_Zone_G_W,Temperature,20;

  Schedule:Constant,Schedule_TemperatureMaximum_Zone_G_W,Temperature,26;

! ========= EQUIPMENT LISTS / EQUIPMENT CONNECTIONS =========

  ZoneHVAC:EquipmentList,
    ZoneHvacEquipmentList_G_W,  !- Name
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    AirDistributionUnit_Abx_G_W,  !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Zone Equipment 2 Object Type
    LowTempRadiantVarFlow_Hepta_G_W,  !- Zone Equipment 2 Name
    2,                       !- Zone Equipment 2 Cooling Sequence
    2;                       !- Zone Equipment 2 Heating or No-Load Sequence

  NodeList,
    NodeList_Air_ZoneInlets_G_W,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_W_Outlet;  !- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    Zone_G_W,                !- Zone Name
    ZoneHvacEquipmentList_G_W,  !- Zone Conditioning Equipment List Name
    NodeList_Air_ZoneInlets_G_W,  !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    AirNode_ZoneNode_G_W,    !- Zone Air Node Name
    AirNode_G_W_Outlet;      !- Zone Return Air Node Name

! ========= TOTAL HEATING AND COOLING ENERGY FOR ZONE G_W =========

  EnergyManagementSystem:GlobalVariable,
    Heating_Energy_Zone_G_W; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_W Total Heating Energy {J},  !- Name
    Heating_Energy_Zone_G_W, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    Cooling_Energy_Zone_G_W; !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Zone_G_W Total Cooling Energy {J},  !- Name
    Cooling_Energy_Zone_G_W, !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:Subroutine,
    Calc_HeatingEnergy_Zone_G_W,  !- Name
    Set Heating_Energy_Zone_G_W = 0,  !- Program Line 1
    Set Heating_Energy_Zone_G_W = Heating_Energy_Zone_G_W + Q_Heating_Abx_G_W,  !- Program Line 2
    Set Heating_Energy_Zone_G_W = Heating_Energy_Zone_G_W + Q_Heating_Hepta_G_W;  !- <none>

  EnergyManagementSystem:Subroutine,
    Calc_CoolingEnergy_Zone_G_W,  !- Name
    Set Cooling_Energy_Zone_G_W = 0,  !- Program Line 1
    Set Cooling_Energy_Zone_G_W = Cooling_Energy_Zone_G_W + Q_Cooling_Abx_G_W,  !- Program Line 2
    Set Cooling_Energy_Zone_G_W = Cooling_Energy_Zone_G_W + Q_Cooling_Hepta_G_W;  !- <none>

! ====================================================================================================
! ===     AIRBOX G_W
! ===
! ===     USED PARAMETER VALUES: AIRBOXNUMBEROFUNITS = 4 {-}, CWLOOPNUMBER = 1 { }, HWLOOPNUMBER = 1 { }, ZONENAME = G_W { },
! ====================================================================================================
! ========= SETPOINTMANAGERS / AVAILABILITYMANAGERS =========

  SetpointManager:Scheduled,
    SetpointManager_TemperatureSp_AirSupply_Abx_G_W,  !- Name
    Temperature,             !- Control Variable
    Schedule_TemperatureSp_AirSupply_Abx_G_W,  !- Schedule Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet;  !- Setpoint Node or NodeList Name

  Schedule:Compact,
    Schedule_TemperatureSp_AirSupply_Abx_G_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,29,         !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,21,         !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,29;         !- Field 11

  AvailabilityManagerAssignmentList,
    AvailabilityList_Abx_G_W,!- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    AvailabilityManager_Abx_G_W;  !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    AvailabilityManager_Abx_G_W,  !- Name
    Schedule_Availability_Abx_G_W;  !- Schedule Name

  Schedule:Constant,Schedule_Availability_Abx_G_W,Availability,1;

! ========= FAN WITH EMS CONTROL =========

  Fan:VariableVolume,
    FanVariableVolume_Abx_G_W,  !- Name
    Schedule_Availability_Abx_G_W,  !- Availability Schedule Name
    1.0,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    0.104500003,             !- Maximum Flow Rate {m3/s}
    FixedFlowRate,           !- Fan Power Minimum Flow Rate Input Method
    ,                        !- Fan Power Minimum Flow Fraction
    0.071133330,             !- Fan Power Minimum Air Flow Rate {m3/s}
    1.0,                     !- Motor Efficiency
    0.0,                     !- Motor In Airstream Fraction
    0.0,                     !- Fan Power Coefficient 1
    1.0,                     !- Fan Power Coefficient 2
    0.0,                     !- Fan Power Coefficient 3
    0.0,                     !- Fan Power Coefficient 4
    0.0,                     !- Fan Power Coefficient 5
    AirNode_WaterCoolingCoil_Abx_G_W_Outlet,  !- Air Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet;  !- Air Outlet Node Name

  EnergyManagementSystem:Sensor,
    Fraction_PeopleInZone_G_W,  !- Name
    Schedule_Fraction_Office_Occupation,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Is_Abx_G_W_FanAvail,     !- Name
    Schedule_Availability_Abx_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    rho_Abx_G_W_Fan,         !- Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Current Density;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Abx_G_W_Fan,         !- Name
    FanVariableVolume_Abx_G_W,  !- Actuated Component Unique Name
    Fan,                     !- Actuated Component Type
    Fan Air Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_MFR_AirboxAbx_G_W,   !- Name
    IF (Is_Airbox_AirMFR_ControlAvail > 0),  !- Program Line 1
    Set MFR_Abx_G_W_Fan = 0, !- Program Line 2
    IF (Is_Abx_G_W_FanAvail > 0),  !- <none>
    IF (Fraction_PeopleInZone_G_W > 0.1),  !- <none>
    Set MFR_Abx_G_W_Fan =    0.104500003 * rho_Abx_G_W_Fan,  !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_W_Fan =    0.071133330 * rho_Abx_G_W_Fan,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    ELSE,                    !- <none>
    Set MFR_Abx_G_W_Fan = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= HEATING / COOLING COIL CONTROL =========

  EnergyManagementSystem:Sensor,
    t_Abx_G_W_OutdoorAir,    !- Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Abx_G_W_WaterSupply,   !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    TempSP_Abx_G_W_SupplyAir,!- Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Actuated Component Unique Name
    System Node Setpoint,    !- Actuated Component Type
    Temperature Setpoint;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Set_TempSP_Abx_G_W,      !- Name
    IF (Is_Airbox_TempSP_ControlAvail > 0),  !- Program Line 1
    Set TempSP_Abx_G_W_SupplyAir = t_Abx_G_W_WaterSupply - t_Abx_G_W_OutdoorAir,  !- Program Line 2
    Set TempSP_Abx_G_W_SupplyAir = 0.794871807 * TempSP_Abx_G_W_SupplyAir,  !- <none>
    Set TempSP_Abx_G_W_SupplyAir = t_Abx_G_W_OutdoorAir + TempSP_Abx_G_W_SupplyAir,  !- <none>
    ELSE,                    !- <none>
    Set TempSP_Abx_G_W_SupplyAir = Null,  !- <none>
    ENDIF;                   !- <none>

! ========= COILS WITH BRANCHES AND CONTROLLERS =========

  Coil:Heating:Water,
    WaterHeatingCoil_Abx_G_W,!- Name
    Schedule_Availability_HwLoop1,  !- Availability Schedule Name
    165.440002441,           !- U-Factor Times Area Value {W/K}
    0.14992023E-03,          !- Maximum Water Flow Rate {m3/s}
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Inlet,  !- Water Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Outlet,  !- Water Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Air Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_W_Outlet,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    3760,                    !- Rated Capacity {W}
    28.0,                    !- Rated Inlet Water Temperature {C}
    -11,                     !- Rated Inlet Air Temperature {C}
    22.0,                    !- Rated Outlet Water Temperature {C}
    20.0,                    !- Rated Outlet Air Temperature {C}
    0.5;                     !- Rated Ratio for Air and Water Convection

  Branch,
    Branch_HwDemand_WaterHeatingCoil_Abx_G_W,  !- Name
    0.14992023E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    WaterHeatingCoil_Abx_G_W,!- Component 1 Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Controller:WaterCoil,
    Controller_WaterHeatingCoil_Abx_G_W,  !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Sensor Node Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.14992023E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  Coil:Cooling:Water,
    WaterCoolingCoil_Abx_G_W,!- Name
    Schedule_Availability_CwLoop1,  !- Availability Schedule Name
    0.10765551E-03,          !- Design Water Flow Rate {m3/s}
    0.111111112,             !- Design Air Flow Rate {m3/s}
    18.0,                    !- Design Inlet Water Temperature {C}
    37.0,                    !- Design Inlet Air Temperature {C}
    20.0,                    !- Design Outlet Air Temperature {C}
    0.0158,                  !- Design Inlet Air Humidity Ratio {kgWater/kgDryAir}
    0.0134,                  !- Design Outlet Air Humidity Ratio {kgWater/kgDryAir}
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Inlet,  !- Water Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Outlet,  !- Water Outlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_W_Outlet,  !- Air Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_W_Outlet,  !- Air Outlet Node Name
    SimpleAnalysis,          !- Type of Analysis
    CounterFlow;             !- Heat Exchanger Configuration

!                                                         CARINA dim or operation here??

  Branch,
    Branch_CwDemand_WaterCoolingCoil_Abx_G_W,  !- Name
    0.16148327E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    Coil:Cooling:Water,      !- Component 1 Object Type
    WaterCoolingCoil_Abx_G_W,!- Component 1 Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

!                                                                                                                                                                                                     CARINA   dim or operation here??

  Controller:WaterCoil,
    Controller_WaterCoolingCoil_Abx_G_W,  !- Name
    Temperature,             !- Control Variable
    Reverse,                 !- Action
    Flow,                    !- Actuator Variable
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Sensor Node Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Inlet,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    0.16148327E-03,          !- Maximum Actuated Flow {m3/s}
    0;                       !- Minimum Actuated Flow {m3/s}

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_W_Coils,  !- Name
    Controller:WaterCoil,    !- Controller 1 Object Type
    Controller_WaterHeatingCoil_Abx_G_W,  !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    Controller_WaterCoolingCoil_Abx_G_W;  !- Controller 2 Name

! ========= BRANCHLISTS AND CONNECTORS =========

  BranchList,
    BranchList_Air_Abx_G_W,  !- Name
    AirBranch_Abx_G_W;       !- Branch 1 Name

! ========= OUTDOOR AIR SYSTEM =========

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OutdoorAirSystemEquipmentList_Abx_G_W,  !- Name
    OutdoorAir:Mixer,        !- Component 1 Object Type
    OutdoorAirMixer_Abx_G_W; !- Component 1 Name

  OutdoorAir:Mixer,
    OutdoorAirMixer_Abx_G_W, !- Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_OutdoorInlet,  !- Outdoor Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReliefOutlet,  !- Relief Air Stream Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReturnInlet;  !- Return Air Stream Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OutdoorAirSystem_Abx_G_W,!- Name
    ControllerList_Abx_G_W_OutdoorAirMixer,  !- Controller List Name
    OutdoorAirSystemEquipmentList_Abx_G_W,  !- Outdoor Air Equipment List Name
    AvailabilityList_Abx_G_W;!- Availability Manager List Name

  Controller:OutdoorAir,
    Controller_OutdoorAir_Abx_G_W,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReliefOutlet,  !- Relief Air Outlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReturnInlet,  !- Return Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Mixed Air Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_OutdoorInlet,  !- Actuator Node Name
    0.071133330,             !- Minimum Outdoor Air Flow Rate {m3/s}
    0.104500003,             !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    MinimumFlowWithBypass,   !- Economizer Control Action Type
    ,                        !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    ,                        !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Schedule_Fraction_Always1,  !- Minimum Outdoor Air Schedule Name
    Schedule_Fraction_Always1;  !- Minimum Fraction of Outdoor Air Schedule Name

  AirLoopHVAC:ControllerList,
    ControllerList_Abx_G_W_OutdoorAirMixer,  !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    Controller_OutdoorAir_Abx_G_W;  !- Controller 1 Name

! ========= AIRDISTRIBUTIONUNIT =========

  ZoneHVAC:AirDistributionUnit,
    AirDistributionUnit_Abx_G_W,  !- Name
    AirNode_AirTerminalVavNoReheat_Abx_G_W_Outlet,  !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:VAV:NoReheat,  !- Air Terminal Object Type
    AirTerminalVavNoReheat_Abx_G_W;  !- Air Terminal Name

  AirTerminal:SingleDuct:VAV:NoReheat,
    AirTerminalVavNoReheat_Abx_G_W,  !- Name
    Schedule_Availability_Abx_G_W,  !- Availability Schedule Name
    AirNode_AirTerminalVavNoReheat_Abx_G_W_Outlet,  !- Air Outlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_W_Inlet,  !- Air Inlet Node Name
    0.104500003,             !- Maximum Air Flow Rate {m3/s}
    FixedFlowRate,           !- Zone Minimum Air Flow Input Method
    ,                        !- Constant Minimum Air Flow Fraction
    0.071133330;             !- Fixed Minimum Air Flow Rate {m3/s}

! ========= AIRLOOP =========

  AirLoopHVAC,
    AirLoop_Abx_G_W,         !- Name
    ControllerList_Abx_G_W_Coils,  !- Controller List Name
    AvailabilityList_Abx_G_W,!- Availability Manager List Name
    0.104500003,             !- Design Supply Air Flow Rate {m3/s}
    BranchList_Air_Abx_G_W,  !- Branch List Name
    ,                        !- Connector List Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReturnInlet,  !- Supply Side Inlet Node Name
    AirNode_AirLoopReturnPath_Abx_G_W_Outlet,  !- Demand Side Outlet Node Name
    AirNode_AirLoopSupplyPath_Abx_G_W_Inlet,  !- Demand Side Inlet Node Names
    AirNode_FanVariableVolume_Abx_G_W_Outlet;  !- Supply Side Outlet Node Names

  Branch,
    AirBranch_Abx_G_W,       !- Name
    0.104500003,             !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OutdoorAirSystem_Abx_G_W,!- Component 1 Name
    AirNode_OutdoorAirMixer_Abx_G_W_ReturnInlet,  !- Component 1 Inlet Node Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Component 1 Outlet Node Name
    PASSIVE,                 !- Component 1 Branch Control Type
    Coil:Heating:Water,      !- Component 2 Object Type
    WaterHeatingCoil_Abx_G_W,!- Component 2 Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Component 2 Inlet Node Name
    AirNode_WaterHeatingCoil_Abx_G_W_Outlet,  !- Component 2 Outlet Node Name
    PASSIVE,                 !- Component 2 Branch Control Type
    Coil:Cooling:Water,      !- Component 3 Object Type
    WaterCoolingCoil_Abx_G_W,!- Component 3 Name
    AirNode_WaterHeatingCoil_Abx_G_W_Outlet,  !- Component 3 Inlet Node Name
    AirNode_WaterCoolingCoil_Abx_G_W_Outlet,  !- Component 3 Outlet Node Name
    PASSIVE,                 !- Component 3 Branch Control Type
    Fan:VariableVolume,      !- Component 4 Object Type
    FanVariableVolume_Abx_G_W,  !- Component 4 Name
    AirNode_WaterCoolingCoil_Abx_G_W_Outlet,  !- Component 4 Inlet Node Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Component 4 Outlet Node Name
    ACTIVE;                  !- Component 4 Branch Control Type

  AirLoopHVAC:ZoneSplitter,
    AirLoopZoneSplitter_Abx_G_W,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_W_Inlet,  !- Inlet Node Name
    AirNode_AirTerminalVavNoReheat_Abx_G_W_Inlet;  !- Outlet 1 Node Name

  AirLoopHVAC:SupplyPath,
    AirLoopSupplyPath_Abx_G_W,  !- Name
    AirNode_AirLoopSupplyPath_Abx_G_W_Inlet,  !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    AirLoopZoneSplitter_Abx_G_W;  !- Component 1 Name

  AirLoopHVAC:ZoneMixer,
    AirLoopZoneMixer_Abx_G_W,!- Name
    AirNode_AirLoopReturnPath_Abx_G_W_Outlet,  !- Outlet Node Name
    AirNode_G_W_Outlet;      !- Inlet 1 Node Name

  AirLoopHVAC:ReturnPath,
    AirLoopReturnPath_Abx_G_W,  !- Name
    AirNode_AirLoopReturnPath_Abx_G_W_Outlet,  !- Return Air Path Outlet Node Name
    AirLoopHVAC:ZoneMixer,   !- Component 1 Object Type
    AirLoopZoneMixer_Abx_G_W;!- Component 1 Name

  NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_W,  !- Name
    AirNode_OutdoorAirMixer_Abx_G_W_OutdoorInlet;  !- Node 1 Name

  OutdoorAir:NodeList,
    NodeList_Air_OutsideAirInlets_Abx_G_W;  !- Node or NodeList Name 1

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxHC_G_W,      !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxHC_G_W,     !- Name
    Node_HwDemand_WaterHeatingCoil_Abx_G_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeIn_AbxCC_G_W,      !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Inlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_AbxCC_G_W,     !- Name
    Node_CwDemand_WaterCoolingCoil_Abx_G_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeIn_Abx_G_W,     !- Name
    AirNode_OutdoorAirMixer_Abx_G_W_MixedOutlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_AirNodeOut_Abx_G_W,    !- Name
    AirNode_WaterCoolingCoil_Abx_G_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    MFR_Air_Abx_G_W,         !- Name
    AirNode_FanVariableVolume_Abx_G_W_Outlet,  !- Output:Variable or Output:Meter Index Key Name
    System Node Mass Flow Rate;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_W;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_W;           !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    t_AvgAir_Abx_G_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(HWater) {K}, !- Name
    dT_HW_Abx_G_W,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(CWater) {K}, !- Name
    dT_CW_Abx_G_W,           !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(HWater_Air) {K},  !- Name
    dT_HWA_Abx_G_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(CWater_Air) {K},  !- Name
    dT_CWA_Abx_G_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: Average Air Temperature {K},  !- Name
    t_AvgAir_Abx_G_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! AVERAGE AIR TEMPERATURE
! dT(HWater) or dT(CWater): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE
! HEATING MODE
! dT(HWater_Air)
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! dT(CWater_Air)
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Abx_G_W_TempDiff,   !- Name
    Set dT_HW_Abx_G_W  = 0,  !- Program Line 1
    Set dT_CW_Abx_G_W = 0,   !- Program Line 2
    Set t_AvgAir_Abx_G_W = 0,!- <none>
    Set dT_HWA_Abx_G_W  = 0, !- <none>
    Set dT_CWA_Abx_G_W = 0,  !- <none>
    IF (MFR_Air_Abx_G_W > 0),!- <none>
    Set t_AvgAir_Abx_G_W = t_AirNodeOut_Abx_G_W + t_AirNodeIn_Abx_G_W,  !- <none>
    Set t_AvgAir_Abx_G_W = t_AvgAir_Abx_G_W / 2,  !- <none>
    IF (Is_HeatingSeason > 0),  !- <none>
    Set dT_HW_Abx_G_W = t_NodeIn_AbxHC_G_W - t_NodeOut_AbxHC_G_W,  !- <none>
    ELSEIF (Is_CoolingSeason > 0),  !- <none>
    Set dT_CW_Abx_G_W = t_NodeOut_AbxCC_G_W - t_NodeIn_AbxCC_G_W,  !- <none>
    ENDIF,                   !- <none>
    IF (dT_HW_Abx_G_W <> 0), !- <none>
    IF (dT_HW_Abx_G_W < 0),  !- <none>
    Set err = @SevereWarnEp 3.7,  !- <none>
    ENDIF,                   !- <none>
    Set dT_HWA_Abx_G_W = t_NodeOut_AbxHC_G_W + t_NodeIn_AbxHC_G_W,  !- <none>
    Set dT_HWA_Abx_G_W = dT_HWA_Abx_G_W / 2,  !- <none>
    Set dT_HWA_Abx_G_W = dT_HWA_Abx_G_W - t_AvgAir_Abx_G_W,  !- <none>
    Set dT_HW_Abx_G_W_Num = dT_HW_Abx_G_W_Num + 1,  !- <none>
    Set dT_HW_Abx_G_W_Sum = dT_HW_Abx_G_W_Sum + dT_HW_Abx_G_W,  !- <none>
    Set dT_HW_Abx_G_W_Avg = dT_HW_Abx_G_W_Sum / dT_HW_Abx_G_W_Num,  !- <none>
    Set dT_HWA_Abx_G_W_Num = dT_HWA_Abx_G_W_Num + 1,  !- <none>
    Set dT_HWA_Abx_G_W_Sum = dT_HWA_Abx_G_W_Sum + dT_HWA_Abx_G_W,  !- <none>
    Set dT_HWA_Abx_G_W_Avg = dT_HWA_Abx_G_W_Sum / dT_HWA_Abx_G_W_Num,  !- <none>
    ELSEIF (dT_CW_Abx_G_W <> 0),  !- <none>
    IF (dT_CW_Abx_G_W < 0),  !- <none>
    Set err = @SevereWarnEp 3.8,  !- <none>
    ENDIF,                   !- <none>
    Set dT_CWA_Abx_G_W = t_NodeIn_AbxCC_G_W + t_NodeOut_AbxCC_G_W,  !- <none>
    Set dT_CWA_Abx_G_W = dT_CWA_Abx_G_W / 2,  !- <none>
    Set dT_CWA_Abx_G_W = dT_CWA_Abx_G_W - t_AvgAir_Abx_G_W,  !- <none>
    Set dT_CW_Abx_G_W_Num = dT_CW_Abx_G_W_Num + 1,  !- <none>
    Set dT_CW_Abx_G_W_Sum = dT_CW_Abx_G_W_Sum + dT_CW_Abx_G_W,  !- <none>
    Set dT_CW_Abx_G_W_Avg = dT_CW_Abx_G_W_Sum / dT_CW_Abx_G_W_Num,  !- <none>
    Set dT_CWA_Abx_G_W_Num = dT_CWA_Abx_G_W_Num + 1,  !- <none>
    Set dT_CWA_Abx_G_W_Sum = dT_CWA_Abx_G_W_Sum + dT_CWA_Abx_G_W,  !- <none>
    Set dT_CWA_Abx_G_W_Avg = dT_CWA_Abx_G_W_Sum / dT_CWA_Abx_G_W_Num,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Abx_G_W,       !- Name
    WaterHeatingCoil_Abx_G_W,!- Output:Variable or Output:Meter Index Key Name
    Heating Coil Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Abx_G_W,       !- Name
    WaterCoolingCoil_Abx_G_W,!- Output:Variable or Output:Meter Index Key Name
    Cooling Coil Total Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Abx_G_W_RunPeriodAvg,  !- Name
    Set dT_HW_Abx_G_W_Sum  = 0,  !- Program Line 1
    Set dT_HW_Abx_G_W_Num  = 0,  !- Program Line 2
    Set dT_HW_Abx_G_W_Avg  = 0,  !- <none>
    Set dT_CW_Abx_G_W_Sum  = 0,  !- <none>
    Set dT_CW_Abx_G_W_Num  = 0,  !- <none>
    Set dT_CW_Abx_G_W_Avg  = 0,  !- <none>
    Set dT_HWA_Abx_G_W_Sum = 0,  !- <none>
    Set dT_HWA_Abx_G_W_Num = 0,  !- <none>
    Set dT_HWA_Abx_G_W_Avg = 0,  !- <none>
    Set dT_CWA_Abx_G_W_Sum = 0,  !- <none>
    Set dT_CWA_Abx_G_W_Num = 0,  !- <none>
    Set dT_CWA_Abx_G_W_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_W_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_W_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Abx_G_W_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Abx_G_W_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_W_Sum;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_W_Num;       !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Abx_G_W_Avg;       !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Abx_G_W_Avg,       !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_W_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_W_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Abx_G_W_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Abx_G_W_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_W_Sum;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_W_Num;      !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Abx_G_W_Avg;      !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Abx_G_W: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Abx_G_W_Avg,      !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================================================================
! ===     HEPTAPANEL G_W
! ===
! ===     USED PARAMETER VALUES: CWLOOPNUMBER = 1 { }, HEPTAPANELRADIATINGSURFACESANDFRACTIONS = Roof G_W Hepta, 1.00 { }, HEPTAPANELTOTALCOOLINGPOWER = 1672 {W},
! ===         HEPTAPANELTOTALHEATINGPOWER = 3216 {W}, HWLOOPNUMBER = 1 { }, ZONENAME = G_W { },
! ====================================================================================================
! ========= SCHEDULES =========

  Schedule:Compact,
    Schedule_TemperatureSp_Heating_Hepta_G_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,20.500000000, !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,-50,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,20.500000000; !- Field 11

  Schedule:Compact,
    Schedule_TemperatureSp_Cooling_Hepta_G_W,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 6/30,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,100,        !- Field 3
    Through: 8/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,25.500000000, !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,100;        !- Field 11

! ========= RADIANT SURFACE GROUP AND ZONEHVAC:LOWTEMPERATURERADIANT:VARIABLEFLOW WITH THE TWO BRANCHES =========

  ZoneHVAC:LowTemperatureRadiant:SurfaceGroup,
    LowTempRadiantSurfaceGroup_G_W,  !- Name
    Roof G_W Hepta,          !- Surface 1 Name
    1.00;                    !- Flow Fraction for Surface 1

  ZoneHVAC:LowTemperatureRadiant:VariableFlow,
    LowTempRadiantVarFlow_Hepta_G_W,  !- Name
    Schedule_Availability_AlwaysOn,  !- Availability Schedule Name
    Zone_G_W,                !- Zone Name
    LowTempRadiantSurfaceGroup_G_W,  !- Surface Name or Radiant Surface Group Name
    0.012,                   !- Hydronic Tubing Inside Diameter {m}
    2,                       !- Hydronic Tubing Length {m}
    MeanAirTemperature,      !- Temperature Control Type
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    Autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    0.19234451E-03,          !- Maximum Hot Water Flow {m3/s}
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_W_Inlet,  !- Heating Water Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_W_Outlet,  !- Heating Water Outlet Node Name
    0.5,                     !- Heating Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Heating_Hepta_G_W,  !- Heating Control Temperature Schedule Name
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    Autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    0.10000000E-03,          !- Maximum Cold Water Flow {m3/s}
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_W_Inlet,  !- Cooling Water Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_W_Outlet,  !- Cooling Water Outlet Node Name
    0.5,                     !- Cooling Control Throttling Range {deltaC}
    Schedule_TemperatureSp_Cooling_Hepta_G_W,  !- Cooling Control Temperature Schedule Name
    SimpleOff,               !- Condensation Control Type
    1,                       !- Condensation Control Dewpoint Offset {C}
    OnePerSurface,           !- Number of Circuits
    106.7;                   !- Circuit Length {m}

  Branch,
    Branch_HwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Name
    0.19234451E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_W,  !- Component 1 Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_W_Inlet,  !- Component 1 Inlet Node Name
    Node_HwDemand_LowTempRadiantVarFlow_Hepta_G_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

  Branch,
    Branch_CwDemand_LowTempRadiantVarFlow_Hepta_G_W,  !- Name
    0.10000000E-03,          !- Maximum Flow Rate {m3/s}
    ,                        !- Pressure Drop Curve Name
    ZoneHVAC:LowTemperatureRadiant:VariableFlow,  !- Component 1 Object Type
    LowTempRadiantVarFlow_Hepta_G_W,  !- Component 1 Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_W_Inlet,  !- Component 1 Inlet Node Name
    Node_CwDemand_LowTempRadiantVarFlow_Hepta_G_W_Outlet,  !- Component 1 Outlet Node Name
    Active;                  !- Component 1 Branch Control Type

! ========= ON/OFF CONTROL WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_AirNode_Zone_G_W,      !- Name
    AirNode_ZoneNode_G_W,    !- Output:Variable or Output:Meter Index Key Name
    System Node Temperature; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Heating_Hepta_G_W,  !- Name
    Schedule_TemperatureSp_Heating_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_Sp_Cooling_Hepta_G_W,  !- Name
    Schedule_TemperatureSp_Cooling_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Actuator,
    MFR_Hepta_G_W,           !- Name
    LowTempRadiantVarFlow_Hepta_G_W,  !- Actuated Component Unique Name
    Hydronic Low Temp Radiant,  !- Actuated Component Type
    Water Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Subroutine,
    Init_MFR_Hepta_G_W,      !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_W = 0,   !- Program Line 2
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    Set_MFR_LowTempRadiantVarFlow_Hepta_G_W,  !- Name
    IF (Is_Heptapanel_ControlAvail > 0),  !- Program Line 1
    Set MFR_Hepta_G_W = 0,   !- Program Line 2
    IF     (t_AirNode_Zone_G_W < t_Sp_Heating_Hepta_G_W + 0.07 ),  !- <none>
    Set MFR_Hepta_G_W =   0.192344502,  !- <none>
    ELSEIF (t_AirNode_Zone_G_W > t_Sp_Cooling_Hepta_G_W - 0.07 ),  !- <none>
    Set MFR_Hepta_G_W =   0.100000001,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

! ========= ADVANCED OUTPUT (TEMPERATURE DIFFERENCES) WITH EMS =========

  EnergyManagementSystem:Sensor,
    t_NodeIn_Hepta_G_W,      !- Name
    LowTempRadiantVarFlow_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Inlet Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    t_NodeOut_Hepta_G_W,     !- Name
    LowTempRadiantVarFlow_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Outlet Temperature;  !- Output:Variable or Output:Meter Name

! dT(Water) / dT(Water_Air): TEMPERATURE DIFFERENCE WATER SUPPLY TO RETURN TEMPERATURE / AVERAGE WATER TEMPERATURE TO AIR TEMPERATURE

  EnergyManagementSystem:GlobalVariable,
    dT_W_Hepta_G_W;          !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_WA_Hepta_G_W;         !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_W;        !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(Water) {K},!- Name
    dT_W_Hepta_G_W,          !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(HWater) {K},  !- Name
    dT_HW_Hepta_G_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(CWater) {K},  !- Name
    dT_CW_Hepta_G_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(Water_Air) {K},  !- Name
    dT_WA_Hepta_G_W,         !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(HWater_Air) {K},  !- Name
    dT_HWA_Hepta_G_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(CWater_Air) {K},  !- Name
    dT_CWA_Hepta_G_W,        !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! INIT
! CALCULATE dT(Water) / dT(Water_Air)
! HEATING MODE
! RUN PERIOD AVERAGE dT(HWater)
! RUN PERIOD AVERAGE dT(HWater_Air)
! COOLING MODE
! RUN PERIOD AVERAGE dT(CWater)
! RUN PERIOD AVERAGE dT(CWater_Air)

  EnergyManagementSystem:Subroutine,
    Calc_Hepta_G_W_TempDiff, !- Name
    Set dT_W_Hepta_G_W  = 0, !- Program Line 1
    Set dT_HW_Hepta_G_W = 0, !- Program Line 2
    Set dT_CW_Hepta_G_W = 0, !- <none>
    Set dT_WA_Hepta_G_W  = 0,!- <none>
    Set dT_HWA_Hepta_G_W = 0,!- <none>
    Set dT_CWA_Hepta_G_W = 0,!- <none>
    Set dT_W_Hepta_G_W    = (t_NodeIn_Hepta_G_W - t_NodeOut_Hepta_G_W),  !- <none>
    Set dT_WA_Hepta_G_W = (t_NodeIn_Hepta_G_W + t_NodeOut_Hepta_G_W) / 2,  !- <none>
    Set dT_WA_Hepta_G_W = dT_WA_Hepta_G_W - t_AirNode_Zone_G_W,  !- <none>
    IF (dT_W_Hepta_G_W > 0), !- <none>
    Set dT_HW_Hepta_G_W    = dT_W_Hepta_G_W,  !- <none>
    Set dT_HWA_Hepta_G_W = dT_WA_Hepta_G_W,  !- <none>
    Set dT_HW_Hepta_G_W_Num = dT_HW_Hepta_G_W_Num + 1,  !- <none>
    Set dT_HW_Hepta_G_W_Sum = dT_HW_Hepta_G_W_Sum + dT_HW_Hepta_G_W,  !- <none>
    Set dT_HW_Hepta_G_W_Avg = dT_HW_Hepta_G_W_Sum / dT_HW_Hepta_G_W_Num,  !- <none>
    Set dT_HWA_Hepta_G_W_Num = dT_HWA_Hepta_G_W_Num + 1,  !- <none>
    Set dT_HWA_Hepta_G_W_Sum = dT_HWA_Hepta_G_W_Sum + dT_HWA_Hepta_G_W,  !- <none>
    Set dT_HWA_Hepta_G_W_Avg = dT_HWA_Hepta_G_W_Sum / dT_HWA_Hepta_G_W_Num,  !- <none>
    ELSEIF (dT_W_Hepta_G_W < 0),  !- <none>
    Set dT_CW_Hepta_G_W    = 0.0 - dT_W_Hepta_G_W,  !- <none>
    Set dT_CWA_Hepta_G_W = 0.0 - dT_WA_Hepta_G_W,  !- <none>
    Set dT_CW_Hepta_G_W_Num = dT_CW_Hepta_G_W_Num + 1,  !- <none>
    Set dT_CW_Hepta_G_W_Sum = dT_CW_Hepta_G_W_Sum + dT_CW_Hepta_G_W,  !- <none>
    Set dT_CW_Hepta_G_W_Avg = dT_CW_Hepta_G_W_Sum / dT_CW_Hepta_G_W_Num,  !- <none>
    Set dT_CWA_Hepta_G_W_Num = dT_CWA_Hepta_G_W_Num + 1,  !- <none>
    Set dT_CWA_Hepta_G_W_Sum = dT_CWA_Hepta_G_W_Sum + dT_CWA_Hepta_G_W,  !- <none>
    Set dT_CWA_Hepta_G_W_Avg = dT_CWA_Hepta_G_W_Sum / dT_CWA_Hepta_G_W_Num,  !- <none>
    ENDIF;                   !- <none>

! ========= SET SURFACE CONVECTION COEFFICIENTS WITH EMS =========

  EnergyManagementSystem:GlobalVariable,
    ConvCoeffToSet_Hepta_G_W;!- Erl Variable 1 Name

! INIT TO DEFAULT VALUE (AS DEFINED BY USER INPUT OR ENERGYPLUS)
! HEATING MODE
! COOLING MODE

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Hepta_G_W,  !- Name
    Run InitConvCoeff_Sf_Zone_G_W,  !- Program Line 1
    IF (dT_W_Hepta_G_W > 0), !- Program Line 2
    IF (dT_HWA_Hepta_G_W <= 0),  !- <none>
    Set err = @SevereWarnEp 1.5,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_W = (6.12 + (0.18 * (dT_HWA_Hepta_G_W^0.31))),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_W,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF (dT_W_Hepta_G_W < 0),  !- <none>
    IF (dT_CWA_Hepta_G_W <= 0),  !- <none>
    Set err = @SevereWarnEp 1.6,  !- <none>
    ELSE,                    !- <none>
    Set ConvCoeffToSet_Hepta_G_W = 6.12 + (2.76 * (dT_CWA_Hepta_G_W^0.31)),  !- <none>
    Run SetConvCoeff_Sf_Zone_G_W,  !- <none>
    ENDIF,                   !- <none>
    ENDIF;                   !- <none>

  EnergyManagementSystem:Subroutine,
    InitConvCoeff_Sf_Zone_G_W,  !- Name
    Set ConvCoeff_Hepta_Roof_G_W  = Null;  !- Program Line 1

  EnergyManagementSystem:Subroutine,
    SetConvCoeff_Sf_Zone_G_W,!- Name
    Set ConvCoeff_Hepta_Roof_G_W  = ConvCoeffToSet_Hepta_G_W;  !- Program Line 1

! ========= ZONE HEATING / COOLING ENERGY WITH EMS =========

  EnergyManagementSystem:Sensor,
    Q_Heating_Hepta_G_W,     !- Name
    LowTempRadiantVarFlow_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Heating Energy;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Q_Cooling_Hepta_G_W,     !- Name
    LowTempRadiantVarFlow_Hepta_G_W,  !- Output:Variable or Output:Meter Index Key Name
    Zone Radiant HVAC Cooling Energy;  !- Output:Variable or Output:Meter Name

! ========= RUN PERIOD AVERAGE FOR DT(WATER) AND DT(WATER_AIR) =========

  EnergyManagementSystem:Subroutine,
    Init_Hepta_G_W_RunPeriodAvg,  !- Name
    Set dT_HW_Hepta_G_W_Sum  = 0,  !- Program Line 1
    Set dT_HW_Hepta_G_W_Num  = 0,  !- Program Line 2
    Set dT_HW_Hepta_G_W_Avg  = 0,  !- <none>
    Set dT_CW_Hepta_G_W_Sum  = 0,  !- <none>
    Set dT_CW_Hepta_G_W_Num  = 0,  !- <none>
    Set dT_CW_Hepta_G_W_Avg  = 0,  !- <none>
    Set dT_HWA_Hepta_G_W_Sum = 0,  !- <none>
    Set dT_HWA_Hepta_G_W_Num = 0,  !- <none>
    Set dT_HWA_Hepta_G_W_Avg = 0,  !- <none>
    Set dT_CWA_Hepta_G_W_Sum = 0,  !- <none>
    Set dT_CWA_Hepta_G_W_Num = 0,  !- <none>
    Set dT_CWA_Hepta_G_W_Avg = 0;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_W_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_W_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HW_Hepta_G_W_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(HWater) {K} - Run Period Average,  !- Name
    dT_HW_Hepta_G_W_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_W_Sum;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_W_Num;     !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CW_Hepta_G_W_Avg;     !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(CWater) {K} - Run Period Average,  !- Name
    dT_CW_Hepta_G_W_Avg,     !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_W_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_W_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_HWA_Hepta_G_W_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(HWater_Air) {K} - Run Period Average,  !- Name
    dT_HWA_Hepta_G_W_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_W_Sum;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_W_Num;    !- Erl Variable 1 Name

  EnergyManagementSystem:GlobalVariable,
    dT_CWA_Hepta_G_W_Avg;    !- Erl Variable 1 Name

  EnergyManagementSystem:OutputVariable,
    Hepta_G_W: dT(CWater_Air) {K} - Run Period Average,  !- Name
    dT_CWA_Hepta_G_W_Avg,    !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

! ====================================================
! ========= LOW TEMP RADIANT AKA. HEPTAPANEL =========
! ====================================================
! =========================================================
! ========= DECENTRALIZED VENTILATION AKA. AIRBOX =========
! =========================================================
! ==============================
! ========= CONVECTORS =========
! ==============================
! =========================================================
! ========= TOTAL HEATING/COOLING ENERGY PER ZONE =========
! =========================================================
! CUSTOMOUTPUTVARIABLESLIST, HEATINGENERGYPERZONE,

  Output:Variable,*,Zone_D_CORE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_CORE_M Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_NE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_NW Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_SE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_SW Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_E_W Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_CORE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_E Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_NE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_NI Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_SE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_F_SI Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_CORE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_E Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_N Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_NE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_NW Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_S Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_SE Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_SW Total Heating Energy {J},TimeStep;

  Output:Variable,*,Zone_G_W Total Heating Energy {J},TimeStep;

! CUSTOMOUTPUTVARIABLESLIST, COOLINGENERGYPERZONE,

  Output:Variable,*,Zone_D_CORE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_CORE_M Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_NE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_NW Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_SE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_SW Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_E_W Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_CORE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_E Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_NE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_NI Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_SE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_F_SI Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_CORE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_E Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_N Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_NE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_NW Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_S Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_SE Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_SW Total Cooling Energy {J},TimeStep;

  Output:Variable,*,Zone_G_W Total Cooling Energy {J},TimeStep;

! CUSTOMOUTPUTVARIABLESLIST, HEATINGENERGYMONTHLYPERZONE,

  Output:Variable,*,Zone_D_CORE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_CORE_M Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_NE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_NW Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_SE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_SW Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_E_W Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_CORE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_E Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_NE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_NI Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_SE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_F_SI Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_CORE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_E Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_N Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_NE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_NW Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_S Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_SE Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_SW Total Heating Energy {J},monthly;

  Output:Variable,*,Zone_G_W Total Heating Energy {J},monthly;

! CUSTOMOUTPUTVARIABLESLIST, COOLINGENERGYMONTHLYPERZONE,

  Output:Variable,*,Zone_D_CORE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_CORE_M Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_NE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_NW Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_SE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_SW Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_E_W Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_CORE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_E Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_NE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_NI Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_SE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_F_SI Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_CORE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_E Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_N Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_NE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_NW Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_S Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_SE Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_SW Total Cooling Energy {J},monthly;

  Output:Variable,*,Zone_G_W Total Cooling Energy {J},monthly;

! ===================================================================
! ========= TOTAL HEATING/COOLING ENERGY FOR WHOLE BUILDING =========
! ===================================================================

  EnergyManagementSystem:OutputVariable,
    All Zones Total Heating Energy {J},  !- Name
    Total_Heating_Energy,    !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

  EnergyManagementSystem:OutputVariable,
    All Zones Total Cooling Energy {J},  !- Name
    Total_Cooling_Energy,    !- EMS Variable Name
    Summed,                  !- Type of Data in Variable
    SystemTimeStep,          !- Update Frequency
    ,                        !- EMS Program or Subroutine Name
    ;                        !- Units

